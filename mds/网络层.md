第 4 章 网 络层

本章讨论网络 互连 问题。 在介 绍网络 层 提供的两种服务和两个 层 面后， 就进入本章的

一

IP,

IP

核心 内 容 网 际协议

这是本 书的

个重点 内 容。 只有 深入地掌握了协议

ICMP

的 主 要 内

容， 才能 理解 互联网是 怎样工作 的。 本章还 要讨论网 际控制 报 文协议
IP

1Pv6

VPN

、 几种常用 的路

由 选择协议 、
NAT

的 主要特点 、

多 播 的概念等。 在讨论 虚拟 专用网
SDN

MPLS

和网络地 址转换

后， 最 后简单介绍多协议标签 交换

和 软件 定 义 网络

的基本概念。

本章最 重要的 内 容是：

(1) 虚拟 互 连网络和 两种服务 、 两个 层 面 的概念。

(2)  IP

MAC

(3)

地 址 与

地 址 的关系。

IP

CIDR

传统分类 的

地 址和无分类域间路 由 选择

（后 者是重点 ）。

(4) 路 由 选择协议的工作原 理。
4 . 1  网 络层的几个重要概念

4. 1 . 1   网 络层提供的两 种 服 务

“

”

“

”
在计算机网络 领域， 网络 层 应 该 向 运输 层 提供 怎样 的服务

(

面向连接

还 是

无连

接

) 曾 引 起 了 长期的 争论。 争论 焦点的实 质就是： 在计算机通信中， 可 靠 交 付 应 当 由 谁来

负 责 ？是网 络还是 端系统 ？

C

有些人 认为 应 当 借助千 电信网 的成 功经 验， 让 网 络 负 责可 靠 交 付

大 家 知道 ' /传统电

信网的 主 要 业务是 提供电话服务。 电信网使 用 昂 贵的程 控 交换机（ 其 软件也 非常复杂 ）， 用

面 向连接 的通 信 方式， 使电 信 网络能够向用 户（实 际 上 就 是电话机 ） 提供可 靠传输 的服务。

因此 他 们 认 为， 计算机网络也 应 模 仿 打电 话所使用的 面向连接 的 通信方式。 当两台计算机进

一

Q)

行通 信时， 也 应当先 建 立连接（ 但在分 组 交换中是 建立

一

条虚电路 VC(Virtual  Circuit)

) '

以 预 留 双方通信所需的

切 网络 资 源。 然后 双方 就沿着 已 建立 的 虚电 路发送分 组。 这 样的分

一

组的首部不需要 填 写完 整的目 的主机地 址， 而 只需要 填 写这 条 虚电路的编号 （

个不 大的 整

数 ）， 因 而 减 少了分 组 的 开 销。 这种 通信方式如 果 再使用可 靠传输 的 网络协议， 就 可 使 所发

送 的分 组无差错按序 到 达 终点， 当 然也不 丢 失 、 不重复。 在通信结 束后要 释放 建立 的 虚电路。

2

图4-l (a)是网络 提 供 虚 电路服务 的 示意 图。 主机 凡和 H

之间 交换的分 组 都必 须在 事先 建立

的 虚电路上传送。

一

但互 联网 的 先 驱者 却 提出

种 崭 新的网络设计 思路。 他们 认为， 电 信网 提供的 端 到 端

可 靠传输 的服务 对传 统的电话 业务 无疑是很 合 适的， 因为 那时电信网 的 终 端 （电话机 ） 非常

印 注 ： 虚 电路 表 示 这 只 是 一 条逻辑上 的 连 接 ， 分组都沿着这条逻辑连接 （ 好像 是 一 条物理连接 ） 按 照 存储 转 发 方 式 传 送 ，

而 并不是真正建立 了 一 条物理连接 。 请 注 意 ， 电路交换 的 电 话通信 是 先 建立 了 一 条 真 正 的 连接 。 因 此 分 组 交 换 的 虚连接 和 电路 交

换 的 连 接 只 是类似而 已 ， 并 不 完 全 一 样 。

• 115 •

