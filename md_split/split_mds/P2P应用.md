### 分块 1
客户端服务器端socketibindsocke七iteni
i连接建立请求connect-------=i
-－－－－－－－－-－－－－－－－－－-－一气卢
-:I二::c----------
------
------------------i◄--－－－－－－－－－－－－－－－－－－－－－－－－－-－－－－－－－recvsendclosecljse图6-30系统调用使用顺序的例子UDP服务器由千只提供无连接服务，因此不使用lis七en和accept系统调用。
6.9P2P应用我们在第1章的1.3.1节中已经简单地介绍了P2P应用的概念。现在我们将进一步讨论P2P应用的若干工作原理。
P2P应用就是指具有P2P体系结构的网络应用。所谓P2P体系结构就是在这样的网络应用中，没有（或只有极少数的）固定的服务器，而绝大多数的交互都是使用对等方式(P2P方式）进行的。
P2P应用的范围很广，例如，文件分发、实时音频或视频会议、数据库系统、网络服务支持（如P2P打车软件、P2P理财等）。限于篇幅，下面只介绍最常用的P2P文件分发的工作原理。

### 分块 2
P2P文件分发不需要使用集中式的媒体服务器，而所有的音频／视频文件都是在普通的互联网用户之间传输的。这其实是相当于有很多（有时达到上百万个）分散在各地的媒体服务器（由普通用户的计算机充当这种媒体服务器）向其他用户提供所要下载的音频／视频文件。这种P2P文件分发方式解决了集中式媒体服务器可能出现的瓶颈问题。
目前在互联网流量中，P2P工作方式下的文件分发已占据了最大的份额，比万维网应用所占的比例大得多。因此单纯从流量的角度看，P2P文件分发应当是互联网上最重要的应用。
现在P2P文件分发不仅传送音频文件MP3,而且还传送视频文件(10~1000MB,或更大）、各种软件和图像文件。
6.9.1具有集中目录服务器的P2P工作方式最早使用P2P工作方式的是Napster。这个名称来自1999年美国东北大学的新生Shawn
个叫作Napster的软件。利用这个软件就可通过互联网免费下载各种MP3Fanning所写的一•320•音乐。Napster的出现使MP3成为网络音乐事实上的标准。

### 分块 3
Napster能够搜索音乐文件，能够提供检索功能。所有音乐文件的索引信息都集中存放心在Napster目录服务器中。这个目录服务器起着索引的作用。使用者只要查找目录服务器，
就可知道应从何处下载所要的MP3文件。在2000年，Napster成为互联网上最流行的P2P
应用，并占据互联网上的通信量中相当大的比例。
这里的关键就是运行Napster的所有用户，都必须及时向Napster的目录服务器报告自
个动态数据库，己已经存有哪些音乐文件。Napster目录服务器就用这些用户信息建立起
集中存储了所有用户的音乐文件信息（即对象名和相应的IP地址）。当某个用户想下载某个
MP3文件时，就向目录服务器发出查询（这个过程仍是传统的客户－服务器方式），目录服
务器检索出结果后向用户返回存放这
文件的计剪机IP地址，千是这个用户就可以从中选
个地址下载想要得到的MP3文件（这个下载过程就是P2P方式）。可以看出，Napster
取一一一的文件传输是分散的(P2P方式），但文件的定位则是集中的（客户—服务器方式）。

### 分块 4
取一一一的文件传输是分散的(P2P方式），但文件的定位则是集中的（客户—服务器方式）。
图6-31是Napster的工作过程的示意图。假定Napster目录服务器已经建立了其用户的动态数据库。图中给出了某个用户要下载音乐文件的主要交互过程。
Napster集中式
目录服务器IB
勹一1。
'图6-31Napster的工作过程0用户X向Napster目录服务器查询（客户－服务器方式）谁有文件MP3#。
f)Napster目录服务器回答X:有三个地点有文件MP3#，即A,B和C（给出了这三个
一地点的IP地址）。千是用户X得知所需的文件MP3＃的三个下载地点。
＠用户X可以随机地选择三个地点中的任个，也可以使用PING报文寻找最方便下
个。在图6-31中，我们假定X向A发送下载文件MP3＃的请求报文。现在载的一X和A都使用P2P方式通信，互相成为对等方，X是临时的客户，而对等方A是临时的服务器。
0对等方A（现在作为服务器）把文件MP3＃发送给X。
这种集中式目录服务器的最大缺点就是可靠性差，而且会成为其性能的瓶颈（尤其是

### 分块 5
这种集中式目录服务器的最大缺点就是可靠性差，而且会成为其性能的瓶颈（尤其是
在用户数非常多的情况下）。更为严重的是这种做法侵犯了唱片公司的版权。虽然Napster
网站并没有直接非法复制任何MP3文件(Napster网站不存储任何MP3文件，因而并没有CD注：通常CD光盘中的音乐都采用wav格式，即采用标准的PCM编码。MP3则进行了压缩，把一些人耳朵不太能够听出来的部分频率分噩压缩掉了。压缩比一般在I:4到1:12之间。例如，压缩比为1:10就表明］0MB的wav格式音乐，可压缩成1MB的MP3格式，而音质的下降并不太明显。
•321•直接侵犯版权），但法院还是判决Napster属于
Napster网站就被迫关闭了。
“间接侵害版权”，因此在2000年7月底6.9.2具有全分布式结构的P2P文件共享程序一在第代P2P文件共享网站Napster关闭后，开始出现了以Gnutella为代表的第二代P2P文件共享程序。Gnutella是一种采用全分布方法定位内容的P2P文件共享应用程序。
Gnutella与Napster最大的区别就是不使用集中式的目录服务器进行查询，而是使用洪泛法

### 分块 6
Gnutella与Napster最大的区别就是不使用集中式的目录服务器进行查询，而是使用洪泛法
在大量Gnutella用户之间进行查询。为了不使查询的通信量过大，Gnutella设计了种有限一范围的洪泛查询。这样可以减少倾注到互联网的查询流量，但由千查询的范围受限，因而这也影响到查询定位的准确性。
为了更加有效地在大量用户之间使用P2P技术下载共享文件，最近几年已经开发出很多种第三代P2P共享文件程序[KUR017]，它们使用分散定位和分散传输技术。如KaZaA,
电骡eMule,比特洪流BT(BitTorrent)等。
下面对比特洪流BT的主要特点进行简单的介绍。
在P2P的文件分发应用中，2001年由BrahmCohen开发的BitTorrent（中文意思是比
个。取这个名称的原因就是BitTorrent把参与某个文件分发的)是很具代表性的一”特洪流“所有对等方的集合称为一个洪流(torrent)。为了方便，下面我们使用BitTorrent的简称BT。

### 分块 7
BT把对等方下载文件的数据单元称为文件块(chunk)，一个文件块的长度是固定不变的，例如，典型的数值是256KB。当一个新的对等方加入某个洪流时，一开始它并没有文件块。
但新的对等方逐渐地能够下载到一些文件块。而与此同时，它也为别的对等方上传－些文件块。某个对等方获得了整个的文件后，可以立即退出这个洪流（相当千自私的用户），也可继续留在这个洪流中，为其他的对等方上传文件块（相当于无私的用户）。加入或退出某个洪流可在任何时间完成（即使在某个文件还没有下载完毕时），也是完全自由的。
BT的协议相当复杂[W-BT]。下面讨论其基本机制。
一每个洪流都有一个基础设施节点，叫作追踪器(tracker)。当一个对等方加入洪流时，必须向追踪器登记（或称为注册），并周期性地通知追踪器它仍在洪流中。追踪器因而就跟踪了洪流中的对等方。一个洪流中可以拥有少到几个多到几百或几千个对等方。
一一我们用图6-32来进步说明BT的工作原理。当个新的对等方A加入洪流时，追踪
器就随机地从参与的对等方集合中选择若干个（例如，30个），并把这些对等方的IP地址

### 分块 8
器就随机地从参与的对等方集合中选择若干个（例如，30个），并把这些对等方的IP地址
告诉A。千是A就和这些对等方建立了TCP连接。我们称所有与A建立了TCP连接的对
(neighboringpeers)。在图6-32中我们在上面的覆盖网络中画出了A
等方为相邻对等方””有三个相邻对等方(B,C和D)。这些相邻对等方的数目是动态变化的，有的对等方可能不
久就离开了，但不久后又有新加入进来的对等方。请注意，实际的网络拓扑可能是非常复杂的（参见图6-32覆盖网络下面的实际网络图）。我们知道，TCP连接只是个逻辑连接，而每
一
个TCP连接可能会穿越很多的网络。因此我们在讨论问题时，可以利用实际网络上面的一个更加简洁的覆盖网络，这个覆盖网络忽略了实际网络的许多细节，使问题的讨论更加方便。在覆盖网络中，A的三个相邻对等方就看得很清楚。

### 分块 9
一一在任何时刻，每个对等方可能只拥有某文件的个文件块子集，而不同的对等方所拥有的文件块子集也不会完全相同。对等方A将通过TCP连接周期性地向其相邻对等方索取它们拥有的文件块列表。根据收到的文件块列表，A就知道了应当请求哪一个相邻对等方•322•把哪些自己缺少的文件块发送过来。
，,'｀
，，＇/\
B覆盖网络网下心实络，、、','｀，｀,
＇,
＇C。\图6-32在覆盖网络中对等方的相邻关系的示意图图6-33是对等方之间互相传送数据块的示意图。例如，A向B、C和D索取数据块，一
但B同时也向C和D传送数据块，D和C还互相传送数据块。由于P2P对等用户的数量非常多，因此，从不同的对等方获得不同的数据块，然后组装成整个的文件，一般要比仅从
个地方下载整个的文件要快很多。
图例：对等方B对等方A/＼
厂对等方D＼二二
L__J
对等方C/又一］图6-33对等方之间互相传送文件数据块一然而A必须做出两个重要决定。第，哪些文件块是首先需要向其相邻对等方请求的？
第二，在很多向A请求文件块的相邻对等方中，A应当向哪些相邻对等方发送所请求的文
件块？

### 分块 10
第二，在很多向A请求文件块的相邻对等方中，A应当向哪些相邻对等方发送所请求的文
件块？
一对千第个问题，A要使用叫作最稀有的优先(rarestfirst)的技术。我们知道，凡是A所
缺少的而正好相邻对等方已拥有的文件块，都应当去索取。可能其中的某些文件块，很多相
邻对等方都有（即文件块的副本很多），这就是
不稀有的
文件块，以后可慢慢请求。如
果A所缺少的文件块在相邻对等方中的副本很少，那就是
。因此，A首先应当
很稀有的
请求副本最少的文件块（即最稀有的）。否则，一旦拥有最稀有文件块的对等方退出了洪流，
就会影响A对所缺文件块的收集。
一““＂“对千第二个问题，BT采用了种更加机灵的算法，其基本思想就是：凡当前有以最高数据率向A传送文件块的某相邻对等方，A就优先把所请求的文件块传送给该相邻对等方。
具体来说，A持续地测量从其相邻对等方接收数据的速率，并确定速率最高的4个相邻对等

### 分块 11
具体来说，A持续地测量从其相邻对等方接收数据的速率，并确定速率最高的4个相邻对等
方。接着，A就把文件块发送给这4个相邻对等方。每隔10秒钟，A还要重新计算数据率，•323•然后可能修改这4个对等方。在BT的术语中，这4个对等方叫作已疏通的或无障碍的一(unchoked)对等方。更重要的是，每隔30秒，A要随机地找个另外的相邻对等方B,并向其发送文件块。这样，A有可能成为B的前4位上传文件块的提供者。在此情况下，B也
有可能向A发送文件块。如果B发送文件块的速率足够快，那么B也有可能进入A的前4
位上传文件块的提供者。这样做的结果是，这些对等方相互之间都能够以令人满意的速率交换文件块。
6.9.3P2P文件分发的分析一一个例子开始，来讨论P2P文件分发中的几个重要概念[KUR017]。
我们从
在图6-34中，有N台主机要从互联网上的服务器下载个大文件，其长度为Fbit。在
图中我们把这个文件也记为F。按照习惯，从互联网传送数据到主机，叫作下载(download),
而反过来传送数据，即从主机向互联网传送，则称为上传(upload)或上载。服务器的文件是

### 分块 12
而反过来传送数据，即从主机向互联网传送，则称为上传(upload)或上载。服务器的文件是
供互联网上的用户享用的，因此服务器的文件只是单方向上传到互联网。我们把服务器的上
单位是bit/s。再假定主机与互联网连接的链路的上传速率和下载速率分别为
和心单位都是bit/s。我们还假定互联网的核心部分不会产生拥塞。瓶颈只会发生在服务
u
器的接入链路，或者是某些主机的接入链路。J传速率记为
iUs,l/
l了dNJ/UN）J三三～～
d2\互联网U3JI/d3＃U4文件Fus

### 分块 13
iUs,l/
l了dNJ/UN）J三三～～
d2\互联网U3JI/d3＃U4文件Fus
畸-「服务器图6-34文件分发的例子我们先在传统的客户－服务器方式下，计算给所有主机分发完毕的最短时间Tcso从服务器端考虑，N台主机共需要从服务器得到的数据总量（比特数）是NF。如果服Us务器能够不停地以其上传速率s向各主机传送数据，一直到各主机都收到文件F,就需要舒es时间NF/u,单位是秒。由此可见，T不可能小千NF/u如果N台主机都以各自的下载速率不停地下载文件F,那么下载速率最慢的主机（设minmin一其下载速率为d)的下载文件时间(Fldm)，将是N个下载时间中最大的个。由此可见，几也不可能小千Fldsin。
m=es如果NF/u
min?:Fldin,则瓶颈在服务器端的接入链路。这时T
sNF/u
es舒=min如果Fld?:NF/u,则瓶颈在下载最慢的主机的接入链路。这时TF/do•324•由此可得出所有主机都下载完文件F的最少时间是�s=max{!ff,三｝(6-2)从以上分析可以看出，若公式(6-2)括号中的第一

### 分块 14
项大于第二项，则几就与主机数N成正比。如果主机数增大1000倍，那么文件的分发时间也要增大1000倍。
下面讨论在P2P方式下，文件全部分发完毕的最少时间Tp2p。然而在P2P方式下，文件分发所需的时间较难计算，这是因为每一台主机在接收文件的同时，还利用自己的上传能力向其他主机传送文件。文件传送所需的时间取决千主机向对等方传送文件的具体方式。但是，我们还是可以导出文件分发所需的最少时间的表达式。
在文件分发开始时，只有服务器有文件F。服务器必须把文件F的每一个比特通过接入链路传送到互联网（至少要传送一次）。因此文件分发的最少时间不可能小千Flus。和客户－服务器方式相比，在P2P方式下，服务器不需要一一遍遍地发送文件F,因为互联网上的其他主机（即对等方）可以代替服务器向其他对等方分发文件F。
在P2P方式下，下载速率最慢的主机（设其下载速率为dnun)下载文件F的时间是Fldrmn'这是N个对等方下载时间中最大的结论和客户－服务器方式是一样的。

### 分块 15
一个。可见文件分发的最少时间不可能小于Fldmin。这个整个系统中所有主机（包括服务器）的上传速率之和是UT=UsUIU2UN。因此，文件分发的最少时间也不可能小千NF/uT。
+++...+这样，我们得出在P2P方式下所有主机都下载完文件F的最少时间的下限是TP2P>max{：，t，曰(6-3)在公式(6-3)的推导过程中，我们假定每一个对等方只要收到一个比特就立即上传到互联网的其他对等方。但实际上是把收到的若干个比特组成一个数据块后再上传出去。但是当文件F很大时，我们也可以在公式(6-3)中取等号，作为文件F的最少分发时间TP2P的近似值。
有一中的最后种情况最值得我们注意。这就是对等方的数目N非常大，因此在公式(6-3)的括号
一
项的值将大千前两项的值。这样，TP2P值的下限就近似为NF/uTo一我们再假定些数据。设所有的对等方的上传速率都是U,并且Flu=l小时，所有对
等方的下载速率都不小于服务器的上传速率，因而不会对我们的计算产生影响。我们再设服
=30时，用公式(6-3)算出所有主机都下载完文件F的最少时
定小于1小时）。如果采用客户－服务器=lOu。当N

### 分块 16
定小于1小时）。如果采用客户－服务器=lOu。当N
务器的上传速率Us
间的下限是Tp2p=0.75Flu=0.75小时（这个数值
方式，则当N=30时，所有主机都下载完文件F的最少时间是Tes=NF/us=3小时。
一6.9.4在P2P对等方中搜索对象在P2P文件系统中，对等方用户的数量非常多，并且处于一种无序的状态。任何一个对等方可以随时加入进来或随时退出。在这种情况下，怎样有效地找到所需的文件，也就是怎样有效地定位对等方及其资源，乃是P2P系统中的一个十分重要的问题。
限千篇幅，我们在这里只简单介绍一下怎样利用散列函数来定位对等方。

### 分块 17
限千篇幅，我们在这里只简单介绍一下怎样利用散列函数来定位对等方。
•325•我们知道，Gnutella是一种采用全分布方法定位内容的P2P文件共享应用程序，它解决了集中式目录服务器所造成的瓶颈问题。然而Gnutella是在非结构化的覆盖网络中采用查询洪泛的方法来进行查找的，因此查找的效率较低。现在比较好的查找方法是设法构建一种分布式数据库，以进行对等方及其资源的定位。这种分布式数据库在概念上并不复杂，只要能够支持大量对等方（可能有几百万个）进行索引查找即可。存储在数据库中的信息只有两个部分：(1)要查找的资源名K（例如，电影或歌曲的名字）。资源名也可称为关键字。
(2)存放该对象的节点的IP地址N。有的IP地址还附带有端口号。
存放在数据库中的信息就是大量成对出现的（资源名K,节点的IP地址N)。在查找某资源名K时，只要在数据库中查找到匹配的资源名K,数据库就能够返回对应的节点的IP地址N。所以问题的关键就是要设法把每个资源名K存放在一个非常便千查找的地方。

### 分块 18
细心的读者可能会联想到曾在前面6.1节讨论的DNS域名系统。DNS是根据主机的域名来查找其IP地址，这和P2P的情况有相似之处。但我们知道，主机的域名是结构化的命名系统，因此域名服务器可以划分为几种不同的级别（如根服务器等）便于查找。但P2P系统则不同，其资源名是非结构化的。因此不能套用DNS的那种查找方法。
前面已经讲过，Napster在一个集中式目录服务器中构建的查找数据库虽然很简单，但性能上却有瓶颈。在P2P系统中，应怎样构建分布式的P2P数据库？让每个对等方都拥有
所有对等方IP地址的列表是不可行的。让所有成对出现的（资源名K,IP地址N)随机地分散到各对等方也是不可行的。因为这将使查找对象的次数过大，无法使用。现在广泛使用的索引和查找技术叫作分布式散列表DHT(DistributedHashTable)。DHT也可译为分布式哈希表，它是由大量对等方共同维护的散列表。基于DHT的具体算法已有不少，如Chord,
(ContentAddressableNetwork)，以及Kademilia等。下面简单介绍广泛使用的

### 分块 19
Pastry,CANChord算法，这是美国麻省理工大学千2001年提出的[STOIOl]。
分布式散列表DHT利用散列函数，把资源名K及其存放的节点IP地址N都分别映射为资源名标识符KID和节点标识符NID。如果所有的对等方都使用散列函数SHA-I（我们一在下章7.3.1节还要介绍SHA-1在网络安全方面的应用），那么通过散列得出的标识符160KID和NID都是160位二进制数字，且其数值范围在[O,2—l]之间。虽然从理论上讲，散列函数SHA-1是多对的函数，但实际上不同输入得到相同的输出的概率是极小的。此外，
通过SHA-1映射得到的标识符能够比较均匀而稀疏地分布在Chord环上。为便千讨论，我一们假定现在标识符只有5位二进制数字，也就是说，所有经散列函数得出的标识符的数值范围都在[O,31]之间。Chord把节点按标识符数值从小到大沿顺时针排列成一个环形覆盖网络（见图6-35(a)），并按照下面的规则进行映射：(1)节点标识符NID按照其标识符值映射到Chord环上对应的点，见图6-35(a)中标有NID的小圆点，如N4,N7,NlO,N20,N26和N30。

### 分块 20
一个NID,见图6-36(a)(2)资源名标识符KID则按照其标识符值映射到与其值最接近的下中标有KID的小方块。所谓“最接近的下一个“NID就是指：从KID值开始，按顺时针方向沿Chord环遇到的下一个NID。例如，K31和K2应放在N4,因为在环上从31和2按顺时针方向遇到的下一个NID是N4。同理，K8,K12,K23和K29应分别放在NlO,N20,N26和N30。如果碰巧同时出现K29和N29（这种概率极小），那么K29就应当放在N29。
请注意：在图6-35中，K31和K2都放在N4,这表示要查找存放资源K31或K2的节•326•点的IP地址，就应当到节点N4去查找。请注意，资源K31和K2并非存放在节点N4。
这就是说，每个资源由Chord环上与其标识符值最接近的下个节点提供服务。我们
下，Chord环并非实际的网络。在Chord环上相邻的节点，在地理上很可能相距非一一再强调
常远。亘：：言422
2112
918,勹.,1C1413)l'II2

### 分块 21
常远。亘：：言422
2112
918,勹.,1C1413)l'II2
J，(a)KID和NID映射在环上(b)N13加入，N26退出图6-35基于DHT的Chord环Chord环上的每一个节点都要维护两个指针变量，一个指向其后继节点，而另一个指向
一其前任节点。例如，在图6-35(a)中，NlO的后继节点是N20(NlO沿顺时针方向的下
节点），其前任节点是N7(NlO沿逆时针方向的前
个新的节点Nl3加入
进来，那么N20的前任节点就变为Nl3,因而Kl2就要从N20的位置移到Nl3,同时NlO
的后继节点就变为Nl3（见图6-35(b)）。此外，如果节点N26退出，那么K23就要移到个节点）。如果个一一N30,而N30的前任节点就变为N20,同时N20的后继节点变为N30。
在这样的Chord环上查找资源，从理论上讲，任何一个节点，只要从其后继节点一个个地遍历查找下去，
查找报文N/2个，或遍历O(N)个节点(N为环上的总节点数）。显然，这种顺序查找的方法定可以找到所查询的资源。可见要定位个资源，平均需要沿环发送一一效率很低。

### 分块 22
为了加速查找，在Chord环上可以增加些指针表(fingertable)，它又称为路由表或查
找器表。若Chord环上的标识符有m位（现在m=5)，则在节点n上的指针表可设置不超
过m个指针，指向其后继的节点。我们先看图6-36中节点N4的指针表。指针表中的第2一列是从N4可以指向的多个后继节点。本来每一个节点仅仅指向沿顺时针方向的下一个后继l节点，但现在则指向多个后继节点（在本例中就是N7,NIO和N20)。第1列的第i行是计
-l)，用来得出后继节点。例如，第4行i=4,算出(N4+i-1)=N4+8=12,
算(N4+2
而Chord环上的节点12的后继节点是N20。图中还画出了从N4到这几个后继节点的连线
（这些连线就是Chord环上的弦，Chord名字由此得出）。还有
点要注意的是，在N20的
指针表中的第5行，N20+16=36,但按照模2
点是N4。
=4,恰好节点4的后继节运算，36mod2一55假定在图6-36中的节点N4要查找K29。如果用遍历各节点的方法，则要查找5次，即N7-NIO-N20�N26�N30。但若利用指针表，则N4首先在自己的指针表中寻找在不

### 分块 23
到29且最接近29的节点，即N20,然后把定位资源K29的请求发送给N20。在N20的指针表中继续类似的寻找。结果是：最接近29的节点是N30。这就是存放资源K29的节点。
这种查找方法类似于二分查找，只用了两次查找，定位一个资源仅需O(log2N)步。
•327•N4的指针表N20的指针表2图6-36节点N4和N20的指针表在P2P网络中，对等方可能相当频繁地加入或退出系统，这就需要很好地维护这个分
布式数据库（维护各节点的指针和指针表），而这种维护的工作量可能会很大。当对等方数
量非常大时，究竟采用何种查询机制更加合理，则需要根据具体情况来确定。
一P2P技术还在不断地改进，但随着P2P文件共享程序日益广泛地使用，也产生了系一列的问题有待千解决。这些问题已迫使人们要重新思考下代互联网应如何演进。例如，一音频／视频文件的知识产权就是其中的个问题。又如，当非法盗版的、或不健康的音频／视频文件在互联网上利用P2P文件共享程序广泛传播时，要对P2P的流量进行有效的管理，在技术上还是有相当的难度。由于现在P2P文件共享程序的大量使用，已经消耗了互联网

### 分块 24
主干网上大部分的带宽。因此，怎样制定出合理的收费标准，既能够让广大网民接受，又能
使网络运营商赢利并继续加大投入，也是目前迫切需要解决的问题。
本章的重要概念一•本章所讨论的应用程序是为了解决互联网上的某类应用问题的软件，而这些应用
问题的解决又必须通过位于不同主机中的多个应用进程之间的通信和协同工作来完成。应用层协议规定了应用进程在通信时所遵循的各种规则。应用层协议是为应用程序的实现服务的。
•应用层的许多协议都是基于客户服务器方式的。客户是服务请求方，服务器是服务提供方。
一•域名系统DNS是互联网使用的命名系统，用来把便千人们使用的机器名字转换为IP地址。DNS是个联机分布式数据库系统，并采用客户服务器方式。
•域名到IP地址的解析是由分布在互联网上的许多域名服务器程序（即域名服务器）共同完成的。
一一•互联网采用层次树状结构的命名方法，任何一台连接在互联网上的主机或路由器，个唯
都有
点没有对应关系。
的层次结构的名字，即域名。域名中的点和点分十进制IP地址中的•域名服务器分为根域名服务器、顶级域名服务器、权限域名服务器和本地域名服务器。

### 分块 25
•文件传送协议FTP使用TCP可靠的运输服务。FTP使用客户服务器方式。一个FTP服务器进程可同时为多个客户进程提供服务。在进行文件传输时，FTP的客户和服务器之间要建立两个并行的TCP连接：控制连接和数据连接。实际用于传输文件•328•

