### 分块 1
第7章网络安全随着计算机网络的发展，网络中的安全问题也日趋严重。当网络的用户来自社会各个
门阶层与部门时，大量在网络中存储和传输的数据就需要保护。由千计算机网络安全是另
专业学科，所以本章只对计算机网络安全问题的基本内容进行初步的介绍。
一(1)
本章最重要的内容是：计算机网络面临的安全性威胁和计算机网络安全的主要问题。
(2)对称密钥密码体制和公钥密码体制的特点。
(3)鉴别、报文鉴别码、数字签名、证书、证书链的概念。
(4)网络层安全协议IPsec协议族和运输层安全协议TLS的要点。
(5)应用层电子邮件的安全措施。
(6)系统安全：防火墙与入侵检测。
7.1网络安全问题概述一7.1.1计算机网络面临的安全性威胁本节讨论计算机网络面临的安全性威胁、安全的内容和般的数据加密模型。
计算机网络的通信面临两大类威胁，即被动攻击和主动攻击（如图7-1所示）。
___________________i___________________________飞-－－－－－－－－－－－－－－－－－－－－－－－－－－－－-:源占终占，)，仁尸＼：终占脱占
。

### 分块 2
。
终占源占终占．．．主勹°王喜昙图7-1对网络的被动攻击和主动攻击被动攻击是指攻击者从网络上窃听他人的通信内容。通常把这类攻击称为截获。在被一一个协议数据单元PDU（这里使用PDU这动攻击中，攻击者只是观察和分析某
名词是考
虑到所涉及的可能是不同的层次）而不干扰信息流。即使这些数据对攻击者来说是不易理解
的，他也可通过观察PDU的协议控制信息部分，了解正在通信的协议实体的地址和身份，
研究PDU的长度和传输的频度，从而了解所交换的数据的某种性质。这种被动攻击又称为
流量分析(trafficanalysis)。在战争时期，通过分析某处出现大量异常的通信量，往往可以发
现敌方指挥所的位置。
主动攻击有如下几种最常见的方式。
(1)篡改攻击者故意篡改网络上传送的报文。这里也包括彻底中断传送的报文，甚至是把完全伪造的报文传送给接收方。这种攻击方式有时也称为更改报文流。

### 分块 3
(2)恶意程序恶意程序(rogueprogram)种类繁多，对网络安全威胁较大的主要有以下几种：•334••计算机病毒(computervirus)，一种会“传染”其他程序的程序，”“传染是通过修改其他程序来把自身或自己的变种复制进去而完成的。
•计算机蠕虫(computerworm)，一种通过网络的通信功能将自身从一个节点发送到一另个节点并自动启动运行的程序。
•特洛伊木马(Trojanhorse),一种程序，它执行的功能并非所声称的功能而是某种恶意功能。如一个编译程序除了执行编译任务以外，还把用户的源程序偷偷地复制下来，那么这种编译程序就是一种特洛伊木马。计算机病毒有时也以特洛伊木马的形式出现。
•逻辑炸弹(logicbomb)，一种当运行环境满足某种特定条件时执行其他特殊功能的程序。如一个编辑程序，平时运行得很好，但当系统时间为13日又为星期五时，它会删去系统中所有的文件，这种程序就是一种逻辑炸弹。
•后门入侵(backdoorknocking)，是指利用系统实现中的漏洞通过网络入侵系统。就一像
个盗贼在夜晚试图闯入民宅，如果某家住户的房门有缺陷，盗贼就能乘虚而入。

### 分块 4
个盗贼在夜晚试图闯入民宅，如果某家住户的房门有缺陷，盗贼就能乘虚而入。
索尼游戏网络(PlayStationNetwork)在2011年被入侵，导致7700万用户的个人信息，诸如姓名、生日、E-mail地址、密码等被盗[W-BACKD]。
•流氓软件，一种未经用户允许就在用户计算机上安装运行并损害用户利益的软件，其典型特征是：强制安装、难以卸载、浏览器劫持、广告弹出、恶意收集用户信息、恶意卸载、恶意捆绑等。现在流氓软件的泛滥程度已超过了各种计算机病毒，成为互联网上最大的公害。流氓软件的名字一般都很吸引人，如某某卫士、某某搜霸等，因此要特别小心。
上面所说的计算机病毒是狭义的，也有人把所有的恶意程序泛指为计算机病毒。例如1988年10月“Morris病毒”入侵美国互联网，舆论说该事件是“计算机病毒入侵美国计算机网”，而计算机安全专家却称之为“互联网蠕虫事件”
。

### 分块 5
。
(3)拒绝服务DoS(DenialofService)指攻击者向互联网上的某个服务器不停地发送大量分组，使该服务器无法提供正常服务，甚至完全瘫痪。2000年2月7日至9日美国几个著名网站遭黑客CD袭击，使这些网站的服务器一直处千＂忙＂的状态，因而无法向发出请求的客户提供服务。这种攻击被称为拒绝服务。又如在2014年圣诞节，索尼游戏网(PlayStationNetwork)和微软游戏网(MicrosoftXboxLive)被黑客攻击后瘫痪，估计有1.6亿用户受到影响[W-DOS]。
若从互联网上的成百上千个网站集中攻击一个网站，则称为分布式拒绝服务DDoS(DistributedDenialofService)。有时也把这种攻击称为网络带宽攻击或连通性攻击。
2018年2月，6日世界标准时间零时，亚太地区许多计算机同时向根服务器系统发动
袭击，企图使之瘫痪。它们每秒传送的数据量相当千服务器每分钟要接收75万封电子邮件。
结果至少有6个根服务器系统受到影响，两个破坏严重。有分析认为攻击来自韩国，但CD注：黑客

### 分块 6
结果至少有6个根服务器系统受到影响，两个破坏严重。有分析认为攻击来自韩国，但CD注：黑客
一(hacker)是指精通计算机编程的高手，他们能够通过专门的技术手段进入某些据称是相当安全的计算机系统中。
一黑客般可分为两大类。一类是蓄意搞破坏或盗窃别人计算机中数据信息的坏人，而另类则是专门研究计算机系统安全性的好人。例如，银行发行的信用卡必须十分安全，但这种信用卡的安全性在公开发行之前却无从知晓。这时就要请专门研究计算机安全的黑客对信用卡进行攻击实验。如黑客在努力尝试后仍无法攻破，则可认为该信用卡至少在目前是相对安全的。
•335•一ICANN不认为黑客定是韩国人，他可以是任何地点的任何人，只不过是操纵了韩国的计算机而已。
还有其他类似的网络安全问题。例如，在使用以太网交换机的网络中，攻击者向某个
以太网交换机发送大量的伪造源MAC地址的帧。以太网交换机收到这样的帧，就把这个假
的源MAC地址写入交换表中（因为交换表中没有这个地址）。由于这种伪造的地址数量太
大，因此很快就把交换表填满了，导致以太网交换机无法正常工作（称为交换机中毒）。

### 分块 7
大，因此很快就把交换表填满了，导致以太网交换机无法正常工作（称为交换机中毒）。
对于主动攻击，可以采取适当措施加以检测。但对于被动攻击，通常却是检测不出来的。根据这些特点，可得出计算机网络通信安全的目标如下：(1)防止析出报文内容和流量分析。
(2)防止恶意程序。
(3)检测更改报文流和拒绝服务。
对付被动攻击可采用各种数据加密技术，而对付主动攻击，则需将加密技术与适当的鉴别技术相结合。
7.1.2安全的计算机网络一一人们直希望能设计出种安全的计算机网络，但不幸的是，网络的安全性是不可判
定的[DENN82]。目前在安全协议的设计方面，主要是针对具体的攻击设计安全的通信协议。

### 分块 8
定的[DENN82]。目前在安全协议的设计方面，主要是针对具体的攻击设计安全的通信协议。
但如何保证所设计出的协议是安全的？这可以使用两种方法。一种是用形式化方法来证明，一一另种是用经验来分析协议的安全性。形式化证明的方法是人们所希望的，但般意义上的协议安全性也是不可判定的，只能针对某种特定类型的攻击来讨论其安全性。对千复杂的通信协议的安全性，形式化证明比较困难，所以主要采用人工分析的方法来找漏洞。对于简单一的协议，可通过限制入侵者的操作（即假定入侵者不会进行某种攻击）来对些特定情况进行形式化的证明，当然，这种方法有很大的局限性。
一一根据上节所述的各种安全性威胁，不难看出，个安全的计算机网络应设法达到以下四个目标：1.机密性机密性（或私密性）就是只有信息的发送方和接收方才能懂得所发送信息的内容，而信息的截获者则看不懂所截获的信息。显然，机密性是网络安全通信最基本的要求，也是对付被动攻击所必须具备的功能。通常可简称为保密。尽管计算机网络安全并不仅仅依靠机密性，但不能提供机密性的网络肯定是不安全的。为了使网络具有机密性，需要使用各种密码技术。

### 分块 9
2.端点鉴别安全的计算机网络必须能够鉴别信息的发送方和接收方的真实身份。网络通信和面对面的通信差别很大。现在频繁发生的网络诈骗，在许多情况下，就是由千在网络上不能鉴别一出对方的真实身份。当我们收到封电子邮件时，发信人也可能并不是邮件上所署名的那个人。当我们进行网上购物时，卖家也有可能是犯罪分子假冒的商家。不能解决这个问题，就不能认为网络是安全的。端点鉴别在对付主动攻击时是非常重要的。
•336•3.信息的完整性即使能够确认发送方的身份是真实的，并且所发送的信息都是经过加密的，我们依然不能认为网络是安全的。还必须确认所收到的信息都是完整的，也就是信息的内容没有被人
篡改过。保证信息的完整性在应对主动攻击时也是必不可少的。信息的完整性和机密性是两
个不同的概念。例如，商家向公众发布的商品广告当然不需要保密，但如果广告在网络上传
送时被人恶意删除或添加了些内容，那么就可能对商家造成很大的损失。
一实际上，信息的完整性与端点鉴别往往是不可分割的。假定你准确知道报文发送方的
“
身份没有错（即通过了端点鉴别），但收到的报文却已被人篡改过（即信息不完整），那么这

### 分块 10
“
身份没有错（即通过了端点鉴别），但收到的报文却已被人篡改过（即信息不完整），那么这
样的报文显然是没有用处的。因此，在谈到
的完整性。也就是说，既鉴别发送方的身份，又鉴别报文的完整性。
时，有时是同时包含了端点鉴别和报文鉴别”4.运行的安全性一现在的机构与计算机网络的关系越密切，就越要重视计算机网络运行的安全性。上节介绍的恶意程序和拒绝服务的攻击，即使没有窃取到任何有用的信息，也能够使受到攻击的计算机网络不能正常运行，甚至完全瘫痪。因此，确保计算机系统运行的安全性，也是非常重要的工作。对千
访问控制(accesscontrol)些要害部门，这点尤为重要。
对计算机系统的安全性非常重要。必须对访问网络的权限加以
控制，并规定每个用户的访问权限。由于网络是个非常复杂的系统，其访问控制机制比操作系统的访问控制机制更复杂（尽管网络的访问控制机制是建立在操作系统的访问控制机制之(multilevelsecurity)上的），尤其在安全要求更高的多级安全
7.1.3数据加密模型情况下更是如此。
7-2ABX,E一般的数据加密模型如图后，就得出密文Y。加密密钥K了A向所示。用户

### 分块 11
7-2ABX,E一般的数据加密模型如图后，就得出密文Y。加密密钥K了A向所示。用户
截互占］「叶归改发送明文但通过加密算法运算B一图中所示的加密和解密用的密钥串秘密的字符串（即比特串）。公式是明文通过加密算法变成密文的图7-2一般的数据加密模型K(key)一一是
般表示方法。
y=E
(X)
K(7-1)就(7-1)在传送过程中可能出现密文的截取者（或攻击者、入侵者）。公式表示接收端利用
解密算法D运算和解密密钥K,解出明文X。解密算法是加密算法的逆运算。在进行解密运
(7-2)
DK(Y)=DK(EK(X))=X
算时，如果不使用事先约定好的密钥就无法解出明文。
•337•(7-2)这里我们假定加密密钥和解密密钥都是一样的。但实际上它们可以是不一样的（即使样，这两个密钥也必然有某种相关性）。密钥通常由密钥中心提供。当密钥需要向远地一不
传送时，一定要通过另一个安全信道。

### 分块 12
传送时，一定要通过另一个安全信道。
密码编码学(cryptography)是密码体制的设计学，而密码分析学(cryptanalysis)则是在未知密钥的情况下从密文推演出明文或密钥的技术。密码编码学与密码分析学合起来即为密码学(cryptology)。
如果不论截取者获得了多少密文，但在密文中都没有足够的信息来唯一地确定出对应的明文，则这一密码体制称为无条件安全的，或称为理论上是不可破的。在无任何限制的条件下，目前几乎所有实用的密码体制均是可破的。因此，人们关心的是要研制出在计算上（而不是在理论上）是不可破的密码体制。如果一个密码体制中的密码，不能在一定时间内被可以使用的计算资源破译，则这一密码体制称为在计算上是安全的。
早在几千年前人类就已经有了通信保密的思想和方法。直到1949年，信息论创始人香一农(C.E.Shannon)发表著名文章[SHAN49]，论证了
破的。密码学的研究曾面临着严重的危机。但从20世纪60年代起，随着电子技术、计算技
一般经典加密方法得到的密文几乎都是可术的迅速发展以及结构代数、可计算性和计算复杂性理论等学科的研究，密码学又进入了

### 分块 13
个新的发展时期。在20世纪70年代后期，美国的数据加密标准DES(DataEncryptionStandard)
和公钥密码体制(publickeycrypto-system,又称为公开密钥密码体制）的出现，成为近代
密码学发展史上的两个重要里程碑。
7.2两类密码体制7.2.1对称密钥密码体制所谓对称密钥密码体制，即加密密钥与解密密钥都使用相同密钥的密码体制。例如图7-2所示的情况，通信的双方使用的就是对称密钥。
数据加密标准DES属千对称密钥密码体制。它由IBM公司研制出，千1977年被美国定为联邦信息标准后，在国际上引起了极大的重视。ISO曾将DES作为数据加密标准。
一DES是种分组密码。在加密前，先对整个的明文进行分组。每一个组为64位长的二一一进制数据。然后对每
将各组密文串接起来，即得出整个的密文。使用的密钥占有64位（实际密钥长度为56位，
外加8位用千奇偶校验）。
个64位二进制数据进行加密处理，产生组64位密文数据。最后DES的机密性仅取决千对密钥的保密，而算法是公开的。DES的问题是它的密钥长度。

### 分块 14
一561656位长的密钥意味着共有2种可能的密钥，也就是说，共有约7.6X10种密钥。假设台计算机1µs可执行一次DES加密，同时假定平均只需搜索密钥空间的一半即可找到密钥，那么破译DES要超过1000年。
然而芯片的发展出乎意料地快。不久，56位DES已不再被认为是安全的。
对于DES56位密钥的问题，学者们提出了三重DES(TripleDES或记为3DES)的方
一一一一案，把个64位明文用个密钥加密，再用另个密钥解密，然后再使用第个密钥加密，即•338•Y=DESK[(DES-IK2(DESK1(X)))

