### 分块 1
可能收到多个DHCP提供报文。
0DHCP客户从几个DHCP服务器中选择其中的一个，并向所选择的DHCP服务器发送DHCP请求报文。
©被选择的DHCP服务器发送确认报文DHCPACK。从这时起，DHCP客户就可以使用这个IP地址了。这种状态叫作已绑定状态，因为在DHCP客户端的IP地址和MAC地址已经完成绑定，并且可以开始使用得到的临时IP地址了。
DHCP客户现在要根据服务器提供的租用期T设置两个计时器T1和T2,它们的超时时间分别是0.5T和0.875T。当超时时间到了就要请求更新租用期。
0租用期过了一新租用期。
半（T1时间到），DHCP客户发送请求报文DHCPREQUEST要求更8DHCP服务器若同意，则发回确认报文DHCPACK。DHCP客户得到了新的租用期，重新设置计时器。
0DHCP服务器若不同意，则发回否认报文DHCPNACK。这时DHCP客户必须立即停止使用原来的IP地址，而必须重新申请IP地址（回到步骤＠）。

### 分块 2
若DHCP服务器不响应步骤0的请求报文DHCPREQUEST,则在租用期过了87.5％时（兀时间到），DHCP客户必须重新发送请求报文DHCPREQUEST（重复步骤0)，然后又继续后面的步骤。
0DHCP客户可以随时提前终止服务器所提供的租用期，这时只需向DHCP服务器发送释放报文DHCPRELEASE即可。
DHCP很适合千经常移动位置的计算机。当计算机使用Windows操作系统时，点击“控制面板”““的
“网络
”协议后点击其属性按钮，若选择图标就可以找到某个连接中的“自动获得IP地址”“”网络
“和下面的菜单，找到TCP/IP
”自动获得DNS服务器地址选项，就表示是使用DHCP协议。
6.7简单网络管理协议SNMP6.7.1网络管理的基本概念虽然网络管理还没有精确定义，但它的内容可归纳为：网络管理包括对硬件、软件和人力的使用、综合与协调，以便对网络资源进行监视、测试、配置｀分析、评价和控制，这样就能以合理的价格满足网络的
性能、服务质量等。网络管理常简称为网管。
—些需求，如实时运行我们可以看到，网络管理并不是指对网络进行行政上的管理。

### 分块 3
—些需求，如实时运行我们可以看到，网络管理并不是指对网络进行行政上的管理。
网络是个非常复杂的分布式系统。这是因为网络上有很多不同厂家生产的、运行着一多种协议的节点（主要是路由器），而这些节点还在相互通信和交换信息。网络的状态总是
一一不断地变化着。可见，我们必须使用种机制来读取这些节点上的状态信息，有时还要把些新的状态信息写入到这些节点上。
下面简单介绍网络管理模型中的主要构件（如图6-20所示）。
管理站又称为管理器，是整个网络管理系统的核心，它通常是个有着良好图形界面的高性能的工作站，并由网络管理员直接操作和控制。所有向被管设备发送的命令都是从管理站发出的。管理站的所在部门也常称为网络运行中心NOC(NetworkOperationsCenter)。管•306•理站中的关键构件是管理程序（如图6-20中有字母M的椭圆形图标所示）。管理程序在运行时就成为管理进程。管理站（硬件）或管理程序（软件）都可称为管理者(manager)或管理器，所以这里的manager不是指人而是指机器或软件。网络管理员(administrator)才是指人。

### 分块 4
大型网络往往实行多级管理，因而有多个管理者，而一个管理者一般只管理本地网络的设备。
被管设备＼被管设备网管协议＿－－－管＠－管理程序（运行SNMP客户程序）＠－代理程序（运行SNMP服务器程序）图6-20网络管理的一般模型在被管网络中有很多的被管设备（包括设备中的软件）。被管设备可以是主机、路由器、打印机、集线器、网桥或调制解调器等。在每一个被管设备中可能有许多被管对象(ManagedObject)。被管对象可以是被管设备中的某个硬件（例如，一块网络接口卡），也可以是某些硬件或软件（例如，路由选择协议）的配置参数的集合。被管设备有时可称为网络元素或简称为网元。在被管设备中也会有一些不能被管的对象（在下面的6.7.2节将会讲到对象命名树，所谓不能被管的对象就是不在对象命名树上的对象）。
一在每个被管设备中都要运行一个程序以便和管理站中的管理程序进行通信。这些运行着的程序叫作网络管理代理程序，或简称为代理(agent)（如图6-20中有字母A的几个椭圆形图标所示）。代理程序在管理程序的命令和控制下，在被管设备上采取本地的行动。
在图6-20中还有的作用。

### 分块 5
在图6-20中还有的作用。
一个重要构件就是网络管理协议，简称为网管协议。后面还要讨论它简单网络管理协议SNMP(SimpleNetworkManagementProtocol)中的管理程序和代理程序按客户服务器方式工作。管理程序运行SNMP客户程序，而代理程序运行SNMP服务器程序。在被管对象上运行的SNMP服务器程序不停地监听来自管理站的SNMP客户程序的请求（或命令）。
一旦发现了，就立即返回管理站所需的信息，或执行某个动作（例如，把某个参数的设置进行更新）。在网管系统中往往是一个（或少数几个）客户程序与很多的服务器程序进行交兀。
关千网络管理有一个基本原理，这就是：若要管理某个对象，就必然会给该对象添加对象的影响必须尽量小些。
SNMP正是按照这样的基本原理来设计的。

### 分块 6
SNMP正是按照这样的基本原理来设计的。
一些软件或硬件，但这种““添加对原有SNMP发布于1988年。OSI虽然在这之前就已制定出许多的网络管理标准，但当时（到现在也很少）却没有符合OSI网管标准的产品。SNMP最重要的指导思想就是要尽可能简单。SNMP的基本功能包括监视网络性能、检测分析网络差错和配置网络设备等。在网络正常工作时，SNMP可实现统计、配置和测试等功能。当网络出故障时，可实现各种差错
检测和恢复功能。经过近二十年的使用，SNMP不断修订完善，较新的版本是SNMPv3,而•307•前两个版本分别是SNMPv2和SNMPvl。但一般可简称为SNMP。SNMPv3最大的改进就是安全特性。也就是说，只有被授权的人员才有资格执行网络管理的功能（如关闭某
一路）和读取有关网络管理的信息（如读取
”个配置文件的内容）。然而SNMP协议已相当庞
，整个标准共有八个RFC文档[RFC3411-3418,STD62]。因此这里简单大，一“一条链点也不
一只能给出些最基本的概念。
若网络元素使用的不是SNMP协议而是另种网络管理协议，那么SNMP协议就无法

### 分块 7
若网络元素使用的不是SNMP协议而是另种网络管理协议，那么SNMP协议就无法
控制该网络元素。这时可使用委托代理(proxyagent)。委托代理能提供如协议转换和过滤操
作等功能对被管对象进行管理。
一SNMP的网络管理由三个部分组成，即SNMP本身、管理信息结构SMI(StructureofManagementInformation)和管理信息库MIB(ManagementInformationBase)。下面简述这三部分的作用。
SNMP定义了管理站和代理之间所交换的分组格式。所交换的分组包含各代理中的对象（变量）名及其状态（值）。SNMP负责读取和改变这些数值。
SMI定义了命名对象和定义对象类型（包括范围和长度）的通用规则，以及把对象和对象的值进行编码的规则。这样做是为了确保网络管理数据的语法和语义无二义性。但从SMI的名称并不能看出它的功能。请注意，SMI并不定义一个实体应管理的对象数目，也不定义被管对象名以及对象名及其值之间的关联。
MIB在被管理的实体中创建了命名对象，并规定了其类型。
为了更好地理解上述的几个组成部分，可以把它们和程序设计进行一下对比。

### 分块 8
为了更好地理解上述的几个组成部分，可以把它们和程序设计进行一下对比。
我们在编程时要使用某种语言，而这种语言就是用来定义编程的规则。例如，一个变量名必须从字母开始而后面接着是字母数字。在网络管理中，这些规则由SMI来定义。
在程序设计中必须对变量进行说明。例如，intcounter,表示变量counter是整数类型。
MIB在网络管理中就做这样的事情。MIB给每个对象命名，并定义对象的类型。
在编程中的说明语句之后，程序需要写出一些语句用来存储变最的值，并在需要时改变这些变量的值。协议SNMP在网络管理中完成这件任务。SNMP按照SMI定义的规则，存储、改变和解释这些已山MIB说明的对象的值。
总之，SMI建立规则，MIB对变量进行说明，而SNMP完成网管的动作。
一一下面就介绍上述的三个构件。
6.7.2管理信息结构SMI管理信息结构SMI是SNMP的重要组成部分。根据6.7.1节所讲，SMI的功能应当有三个，即规定：(1)被管对象应怎样命名；(2)用来存储被管对象的数据类型有哪些；(3)在网络上传送的管理数据应如何编码。

### 分块 9
1.被管对象的命名SMI规定，所有的被管对象都必须处在对象命名树(objectnamingtree)上。图6-21给出了对象命名树的一部分。对象命名树的根没有名字，它的下面有三个顶级对象，都是世界上著名的标准制定单位，即ITU-T（过去叫作CCITT)和ISO,以及这两个组织的联合体，它•308•们的标号分别是0到2。图中的对象名习惯上用英文小写表示。在ISO的下面的
3的节点是ISO认同的组织成员org。在其下面有
个美国国防部dod(Departmentof
Defense)的子树（标号为6)，再下面就是internet（标号为1)。在只讨论internet中的对象时，
可只画出internet以下的子树，并在internet节点旁边写上对象标识符1.3.6.1即可。
个标号为一一根itu-t(0)is9(1)iso/itu-t(2)org(3)dod,(6)
|
intem�t
／

### 分块 10
|
intem�t
／
mgmt(2)(1)＜尸1.3.6.1(iso.org.dod.intemet)mib-2(1)＜�1.3.6.1.2.l(iso.org.dod.intemet.mgmt.mib-2)sy�tem(l)··interfaces
/I
/1\
/1\(2)at(3)ip(4)icmp(5)tcp(6)udp(7)egp(8).../I�]-\!I\.iplnReceives(3)＜尸1.3.6.1.2.1.4.3/1\/1\/1\图6-21SMI规定所有被管对象必须在命名树上一在internet节点下面的标号为2的节点是mgmt（管理）。再下面只有个节点，即管理
信息库mib-2,其对象标识符为1.3.6.1.2.1。在mib-2下面包含了所有被SNMP管理的对象
（见下面6.7.3节的讨论）。
2.被管对象的数据类型CD一了)来定义数据类型，但又增加
SMI使用基本的抽象语法记法l

### 分块 11
2.被管对象的数据类型CD一了)来定义数据类型，但又增加
SMI使用基本的抽象语法记法l
些新的定义。因此SMI既是ASN.1的子集，又是ASN.1的超集。ASN.1的记法很严格，（即ISO制定的ASN.l“一它使得数据的含义不存在任何可能的二义性。例如，使用ASN.1时不能简单地说个具有整数值的变量，而必须说明该变量的准确格式和整数取值的范围。当网络中的计算机对数据项并不都使用相同的表示时，采用这种精确的记法就尤其重要。
“”一我们知道，任何数据都具有两种重要的属性，即值(value)与类型(type)。这里值是“””一则是值集合的名字。如果给定种类型，则这种类型一某个值集合中的一
个元素，而的个值就是该类型的类型
个具体实例。
SMI把数据类型分为两大类：简单类型和结构化类型。简单类型是最基本的、直接使用ASN.1定义的类型。表6-4给出了最主要的几种简单类型。

### 分块 12
0注：ISO原以为还会制定出更多的抽象语法记法，但实际上到目前为止并没有第二个抽象语法记法出现。因此ASN.l似应写为ASN。抽象语法只描述数据的结构形式且与具体的编码格式无关，同时也不涉及这些数据结构在计算机内如何存放。
•309•表6-4几种最主要的简单类型类型大小4字节在－23131到2—l之间的整数说明4字节和INTEGER相同4字节32在0到2-I之间的无符号数INTEGERInterger32Unsigned32OCTETSTRINGOBJECTIDENTIFIER可变可变不超过65535字节长的字节串对象标识符IPAddressCounter32TimeTicksBITSOpaque4字节由4个整数组成的IP地址4字节可从0增加到232的整数；当它到达最大值时就返回到04字节记录时间的计数值，以1/100秒为单位比特串可变不解释的串SMI定义了两种结构化数据类型，即sequence和sequenceof。
数据类型sequence类似于C语言中的struct或record,它是

### 分块 13
数据类型sequence类似于C语言中的struct或record,它是
一一些简单数据类型的组合（不定要相同的类型）。而数据类型sequenceof类似于C语言中的array,它是同样类型的简单数据类型的组合，或同样类型的sequence数据类型的组合。
3.编码方法SMI使用ASN.1制定的基本编码规则BER(BasicEncodingRule)进行数据的编码。BER指明了每种数据的类型和值。在发送端用BER编码，可把用ASN.
一l所表述的报文转换成唯的比特序列。在接收端用BER进行解码，就可得到该比特序列所表示的ASN.1报文。
初看起来，或许用两个字段就能表示类型和值。但由千表示值可能需要多个字节，因此还需要一个指出“要用多少字节表示值”的长度字段。因此ASN.l把所有的数据元素都表示为T-L-V三个字段组成的序列（见图6-22)。
T字段(Tag)定义数据的类型，L字段(Length)定义V字段的长度，而V字段(Value)定义数据的值。
字节l可变数据元素1标记Tj长度门可变值V位2号编－5图6-22用TLV方法进行编码(1)T字段又叫作标记字段，占1字节。

### 分块 14
T字段又再分为以下三个子字段：多。
T字段比较复杂，因为它要定义的数据类型较•类别(2位）共四种：通用类(00)，即ASN.l定义的类型；应用类(01)，即SMI定
义的类型；上下文类(10)，即上下文所定义的类型；专用类(11)，保留为特定厂商
定义的类型。
•格式(1位）共两种，指出数据类型的种类：简单数据类型(0)，结构化数据类型(1)。
•310•一•编号(5位）用来标志不同的数据类型。编号的范围般为0~30。当编号大千30
时，T字段就要扩展为多个字节（这种情况很少用到，可参考ITU-TX.209,这里
一
从略）。
表6-5是些数据类型的T字段的编码。
INTEGER数据类型OCTETSTRJNGOBJECTIDENTIFIERNULLSequence,sequenceofIPAddressCounterGaugeTimeTicksOpaque表6-5几种数据类型的T字段编码
类别T字段（二进制）00编号格式00。00010
00。00100
00。00110
00。00101
01。00000
01。00001
01。00010
01。00011

### 分块 15
00。00101
01。00000
01。00001
01。00010
01。00011
Ol。0010010000I00000010000001000000011000000101001100000100000001000001010000100100001101000100T字段（十六进制）02040605304041424344(2)L字段又叫作长度字段（单字节或多字节）。当L字段为单字节时，其最高位为0,后面的7位定义V字段的长度。当L字段为多个字节时，其最高位为1,而后面的7位定
义后续字节的字节数（用二进制整数表示）。这时，所有的后续字节并置起来的二进制整数
定义V字段的长度。图6-23给出了L字段的格式举例。
、
r
o|1|o|
o|o|o|o|入
指出V字段长度＝2字节单字节的L字段田2V262人
指出后续字节数＝
”o|o|o|o|o
、尸
r一～
字段长度＝
字节
o|1HIo|
1||o|o|o|o|
|1|o||o|o|o|o|o|o|o|指出多字节的L字段，后续字节数＝2-图6-23L字段的格式举例(3)V字段又叫作值字段，用千定义数据元素的值。

### 分块 16
根据以上所述，我们给出两个用十六进制表示的编码例子。例如，INTEGER15,根据
INTEGER类型要用4字节编码。最后得出TLV编
表6-5,其T字段是02,再根据表6-4,
码为02040000000F。又如IPAddress192.1.2.3,IPAddress的T字段是40,V字段需要4
字节表示，因此IPAddress192.1.2.3的TLV编码是4004O10203。
co6.7.3管理信息库MIBTLV方法中的V字段还可嵌套其他数据元素的TLV字段，并可多重嵌套。
“”所谓管理信息就是指在互联网的网管框架中被管对象的集合。被管对象必须维持一可供管理程序读写的若干控制和状态信息。这些被管对象构成了个虚拟的信息存储器，所
以才称为管理信息库MIB。管理程序就使用MIB中这些信息的值对网络进行管理（如读取
•311•
或重新设置这些值）。只有在MIB中的对象才是SNMP所能够管理的。例如，路由器应当一维持各网络接口的状态、入分组和出分组的流量、丢弃的分组和有差错的报文的统计信息，而调制解调器则应当维持发送和接收的字符数、码元传输速率和接受的呼叫等统计信息。因
一

### 分块 17
一
此在MIB中就必须有上面这样些信息。
我们再看下图6-21,可以找到节点mib-2下面的部分是MIB子树。表6-6给出了节点mib-2所包含的前八个信息类别代表的意思（在后面还有好几个类别）。
表6-6节点mib-2所包含的信息类别举例类别systeminterfacesaddresstranslationipicmptcpudpegp一标号
(I)(2)(3)(4)(5)(6)(7)(8)所包含的信息主机或路由器的操作系统各种网络接口地址转换（例如，
IP软件ARP映射）ICMP软件TCPUDPEGP软件软件软件我们可以用个简单例子进步说明MIB的意义。例如，从图6-21可以看出，对象ip的标号是4。因此，所有与IP有关的对象都从前缀1.3.6.1.2.1.4开始。
曰定：(1)在节点ip下面有个名为iplnReceives的MIB变量（见图6-21)，表示收到的IP数据报数。这个变量的标号是3,变量的名字
而相应的数值表示是：1.3.6.1.2.1.4.3。

### 分块 18
而相应的数值表示是：1.3.6.1.2.1.4.3。
iso.org.dod.internet.mgmt.mib.ip.iplnReceives,一(2)当SNMP在报文中使用MIB变量时，对于简单类型的变量，后缀0指具有该名字
iplnReceives的数值表的变量的实例。因此，当这个变量出现在发送给路由器的报文中时，
示（即变量的一
个实例）就是：1.3.6.1.2.1.4.3.0。
个MIB变量的数值或后缀是完全没有办法进行推算的，必(3)请注意，对于分配给须查找已发布的标准。
上面所说的MIB对象命名树的大小并没有限制。下面给出若干MIB变量的例子（见表
变量6-7)，以便更好地理解MIB的意义。这里的是指特定对象的个实例。
表6-7MIB变量的例子“”一MIB变温sysUpTimeifNumberitMtuipDefaultTTLipinReceivesipForwDatagramsipOutNoRoutesipReasmOKsipFragOKsipRoutingTableipipipip甲

### 分块 19
ipip所属类别systeminterfacesinterfaces意义距上次重启动的时间网络接口数MTU特定接口的最大传送单元
IP在生存时间字段中使用的值接收到的数据报数目转发的数据报数目路由选择失败的数目重装的数据报数目分片的数据报数目
IP路由表icmplnEchosicmpICMP收到的回送请求数目•312•续表MIB变量所属类别意义tcpRtoMintcpMaxConntcplnSegsudplnDatagramstcptcptcpudpTCP允许的最小重传时间允许的最大TCP连接数H已收到的TCP报文段数目已收到的UDP数据报数目上面列举的大多数项目的值可用MIB变量ipRoutingTable则定义一一个整数来表示。但MIB也定义了更复杂的结构。例如，
些MIB变量定义了路由表

### 分块 20
些MIB变量定义了路由表
一个完整的路由表。还有其他一项目的内容，并允许网络管理协议访问路由器中的单个项目，包括前缀、地址掩码以及下跳地址等。当然，MIB变量只给出了每个数据项的逻辑定义，而一个路由器使用的内部数据结构可能与MIB的定义不同。当一个查询到达路由器时，路由器上的代理软件负责MIB变量和路由器用于存储信息的数据结构之间的映射。
6.7.4SNMP的协议数据单元和报文实际上，SNMP的操作只有两种基本的管理功能，即：(1)(2)＂“““读写操作，用Get报文来检测各被管对象的状况；操作，用Set报文来改变各被管对象的状况。
SNMP的这些功能通过探询操作来实现，即SNMP管理进程定时向被管理设备周期性地发送探询信息。上述时间间隔可通过SNMP的管理信息库MIB来建立。探询的好处是：一第，可使系统相对简单；第二，能限制通过网络所产生的管理信息的通信量。但探询管理协议不够灵活，而且所能管理的设备数目不能太多。探询系统的开销也较大。如探询频繁而并未得到有用的报告，则通信线路和计算机的CPU周期就被浪费了。

### 分块 21
但SNMP不是完全的探询协议，它允许不经过询问就能发送某些信息。这种信息称为陷阱(trap)，表示它能够捕捉”事件”
。但这种陷阱信息的参数是受限制的。
当被管对象的代理检测到有事件发生时，就检查其门限值。代理只向管理进程报告达到某些门限值的事件（这就叫作过滤）。这种方法的好处是：第一，仅在严重事件发生时才发送陷阱；第二，陷阱信息很简单且所需字节数很少。
总之，使用探询（至少是周期性地）以维持对网络资源的实时监视，同时也采用陷阱机制报告特殊事件，使得SNMP成为一种有效的网络管理协议。
SNMP使用无连接的UDP,因此在网络上传送SNMP报文的开销较小。但UDP是不保证可靠交付的。这里还要指出，SNMP使用UDP的方法有些特殊。在运行代理程序的服务器端用熟知端口161来接收Get或Set报文和发送响应报文（与熟知端口通信的客户端使用临时端口），但运行管理程序的客户端则使用熟知端口162来接收来自各代理的trap报文。

### 分块 22
SNMP现在共定义了如表6-8所示的8种类型的协议数据单元[RFC3416,STD62]，其中PDU编号为4的已经废弃了。在PDU编号后面是对应的T字段值（十六进制形式表示）。
表6-8SNMP定义的协议数据单元类型PDU编号(T字段）0(AO)1

### 分块 23
IPDU名称1一一用途GetRequest管理者从代理读取个或组变量的值•313•续表PDU编号(T字段）PDU名称用途l(Al)GetNextRequest管理者从代理读取MIB树t的下一个变蛇的值（即使不知道此变量名也行）。此操作可反复进行，特别是按顺序一－读取列表中的值很方便2(A2)Response代理向管理者或管理者向管理者发送对扛种Request报文的响应，并提供差错3(A3)5(A5)6(A6)7(A7)8(A8)码、差错状态等信息SetRequest管理者对代理的一个或多个MIB变量的值进行设置GetBulkRequest管理者从代理读取大数据块的值（如大的列表中的值）lnformRequest管珅者从另－远程管理者读取该管理者控制的代理中的变量值SNMPv2Trap代理向管理者报告代理中发生的异常事件Report在管理者之间报告某些类型的差错，目前尚未定义和大多数TCP/IP协议不一样，SNMP报文没有固定的字段。相反，它们使用标准ASN.1编码。因此，SNMP报文用人工进行编码和理解时都比较困难。为此，在图6-24中

### 分块 24
个SNMP报文共由四个部分组成，即版本、首给出了SNMPvl的报文格式。可以看出，一部、安全参数和SNMP报文的数据部分。目前最新版本是版本3。首部包括报文标识(messageidentification)、最大报文长度、报文标志(messageflag)。报文标志占1字节，其中一的每位定义安全类型或其他信息。安全参数用来产生报文摘要（见下一章的7.3.1节）。
。
2节字『卉字81
卜IP数据报UDP数据报SNMP报文4ASNMP报叉的数据部分类型1请求1DI差错状态l差错索引1名1值1名1值「．．．I
SNMPPDU十变量绑定————首部—一-l__t有关加密信思的字段图6-24SNMP的报文格式从图6-24可看出，在SNMPPDU前面还有两个有关加密信息的字段。这是当数据部分需要加密时才使用的两个字段。与网络管理直接相关的是后面的SNMPPDU部分。对千表6-8给出的前四种PDU的格式都是相同的，即由PDU类型、请求ID、差错状态、差错索引以及变量绑定这几个字段组成。PDU的各种类型以及类型的编号和T字段的编码已在表6-8中给出。下面简单介绍一下其他字段的作用。

### 分块 25
(1)请求ID(requestID)由管理进程设置的4字节整数值。代理进程在发送响应报文时也要返回此请求ID。由千管理进程可同时向许多代理发出请求读取变量值的报文，因此设置了请求ID可使管理进程能够识别返回的响应是对应于哪一个请求报文。
(2)差错状态(errorstatus)在请求报文中，这个字段是零。当代理进程响应时，就填
一
l表示tooBig（代理无法把回答个数字。例如0表示noError（切正常），一入0~18中的一装入到个SNMP报文之中），2表示noSuchName（操作指明了一个不存在的变量），3表示badValue（无效值或无效语法），等等[RFC3416]。
•314•(3)差错索引(errorindex)在请求报文中，这个字段是零。当代理进程响应时，若出
现noSuchName,badValue或readOnly的差错，代理进程就设置一个整数，指明有差错的变量在变量列表中的偏移。
(4)变量绑定(variable-bindings)指明一个或多个变量的名和对应的值。在请求报文中，变量的值应忽略（类型是NULL)。

### 分块 26
为了大致了解ASN.l给出的定义的形式，下面举出定义GetRequest-PDU的例子。两个连字符””-－后面的是注解。
Get-request-POU::=[OJIMPLICITSEQUENCE{--[O]表示上下文类，编号为0
－类型是SEQUENCE
－－变量request-id的类型是integer32
-－变量error-status取值为0~18的整数mteger32,
INTEGER{0..18},
INTEGER{O..max-bindings},－－变量error-index取值为0~max-bindings的整数request-iderror-statuserror-indexvanable-bindingsVarBindList}－－变量variable-binding的类型是VarBindL1st但变量VarBindList是什么类型呢？还需要继续定义（这里从略）。上面ASN.l定义中的第二行中的IMPLICIT叫作隐式标记，是为了在进行编码时可省去对IMPLICIT后面的类型(SEQUENCE)的编码，使最后得出的编码更加简洁。

### 分块 27
下面我们假定管理者发送GetRequest-PDU,为的是从某路由器的代理进程获得“收到的信息。从图6-21可以查出，mib-2下面第7个节点是udp,而udp节
UDP数据报的数目
点下面的第一个节点就是udpinDatagrams。由千这个节点已经是叶节点（即没有连接在它下”面的子节点了），读取这个节点的数值时应在节点标识符后面加上O,即1.3.1.1.2.1.7.1.0。这样，可得出GetRequest-PDU的ASN.l编码，如图6-25所示。
TILOBJECTIDENTIFlER10910103060l\2OlOlOlOO
I.3.6.I.2.I.7.I.0图6-25GetRequest-PDU的ASN.1编码可以把图中各字段的十六进制编码表示如下。
AOID020405AE560202010002010030OF30ODreques曰d=05AE5602--GetRequest-PDU,上下文类型，长度1o,6=29
--INTEGER类型，长度0416,
--INTEGER类型，长度0116•errorstatus=oo,6

### 分块 28
--INTEGER类型，长度0116•errorstatus=oo,6
--INTEGER类型，长度0116'errorindex=0016
--SEQUENCEOF类型，长度OF16=15
--SEQUENCE类型，长度OD16=13•315•

