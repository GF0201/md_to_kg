### 关键词提取 - 分块 1
此后，音频／视频文件被下载，所用的协议是运行在UDP上的。可以是后面要介绍的RTP,也可以是其他专用的协议。在音频／视频流播放的过程中，媒体播放器可以随时暂停（利用PAUSE报文）和继续播放（利用PLAY报文），也可以快进或快退。
©用户在不想继续观看时，可以由RTSP客户发送TEARDOWN报文断开连接。
0媒体服务器的RTSP服务器发送响应RESPONSE报文。
请注意，以上编号的步骤0至0都使用实时流协议RTSP。在图8-8中步骤＠后面没有
则使用另外的传送音频／视频数据的协议，如RTP。
“”编号的
音频／视频流
8.3交互式音频／视频限千篇幅，在本节中我们只介绍交互式音频，即IP电话。
IP电话是在互联网上传送多
个例子。通过IP电话的讨论，可以有助千了解在互联网上传送多媒体信息应一媒体信息的
当解决好哪些问题。
8.3.1IP电话概述1.狭义的和广义的IP电话IP电话有多个英文同义词。常见的有VoIP(VoiceoverIP),InternetTelephony和VON“”“(VoiceOntheNet)。但IP电话的含义却有不同的解释。

**关键词**: 音频／视频文件 UDP RTP PAUSE报文 PLAY报文 RTSP客户 TEARDOWN报文 媒体服务器 RTSP服务器 RESPONSE报文 实时流协议 传送音频／视频数据的协议 IP电话 VoIP InternetTelephony VON


### 关键词提取 - 分块 2
狭义的IP电话就是指在IP网络上打电话。所谓”交换网
不过在互联网中至少要有一个IP网络。
的简称。这里的网络可以是互联网，也可以是包含有传统的电路交换网的互联网，IP网络就是使用IP协议的分组广义的IP电话则不仅仅是电话通信，而且还可以是在IP网络上进行交互式多媒体实时
通信（包括话音、视像等），甚至还包括即时传信IM(InstantMessaging)。即时传信是在上网时就能从屏幕上得知有哪些朋友也正在上网。若有，则彼此可在网上即时交换信息（文字的或声音的），也包括使用
Skype、QQ和MSNMessenger[CHEN07]，很受网民的欢迎。
的多媒体服务平台，是话音、视像、数据综合的基础结构。在某些条件下（例如使用宽带的点对多点的多播技术。目前流行的即时传信应用程序有微信、IP电话可看成是个正在演进一一一局域网），IP电话的话音质量甚至还优千普通电话。
下面讨论狭义的IP电话[COLLOl]，而广义的IP电话在原理上是样的。

**关键词**: IP网络 IP协议 分组交换 互联网 电路交换网 即时传信 IM(InstantMessaging) Skype QQ MSNMessenger 微信 局域网 宽带 多播技术


### 关键词提取 - 分块 3
下面讨论狭义的IP电话[COLLOl]，而广义的IP电话在原理上是样的。
其实IP电话并非新概念。早在20世纪70年代初期ARPANET刚开始运行不久，美国一即着手研究如何在计算机网络上传送电话信息，即所谓的分组话音通信。但在很长
里，分组话音通信发展得并不快。主要的原因是：段时间(1)缺少廉价的高质量、低速率的话音信号编解码软件和相应的芯片。
(2)计算机网络的传输速率和路山器处理速率均不够快，因而导致传输时延过大。
(3)没有保证实时通信服务质量QoS(QualityofService)的网络协议。
(4)计算机网络的规模较小，而通信网只有在具有定规模后才能产生经济效益。
一2.IP电话网关然而到了20世纪90年代中期，上述的几个问题才相继得到了较好的解决。千是美国的•379•VocalTec公司在1995年初率先推出了实用化的IP电话。但是这种IP电话必须使用PC。1996

**关键词**: 计算机网络 分组话音通信 IP电话 网关 QoS


### 关键词提取 - 分块 4
个转折点：VocalTec公司成功地推出了IP电话网关CIPTelephony年3月，IP电话进入了一Gateway)，它是公用电话网＠与IP网络的接口设备。IP电话网关的作用就是：(1)在电话呼叫阶段和呼叫释放阶段进行电话信令的转换。
(2)在通话期间进行话音编码的转换。
有了这种IP电话网关，就可实现PC用户到固定电话用户打IP电话（仅需经过IP电话
一次），以及固定电话用户之间打IP电话（需要经过IP电话网关两次）。
网关图8-9画出了IP电话几种不同的连接方式。图中最上面的情况最简单，是两个PC用户之间的通话。这当然不需要经过IP电话网关，但必须是双方都同时上网才能进行通话。图8-9中间的一种情况是PC到固定电话之间的通话。最后一种情况是两个固定电话之间打IP电话，这当然是最方便的。读者应当特别注意在哪一部分是使用电路交换还是分组交换。
_-－-－三－－、、互联网u＼-------------------,".�-|PC到固定电话「－～～------少，：＼』IP电话I、、J

**关键词**: IP电话 网关 IP网络 电话信令 话音编码 电路交换 分组交换


### 关键词提取 - 分块 5
公用电话网/i-—网关1---－－-－---＿＿＿:＿_＿一一」固定电话到固定电话f-－－－－－－-－－上＿＿－－－－--�,.iIP电话公用电话网心觅了/:尸酰j：网关LP电话：l-－－－－、二：二：网关：．电路交换分组交换电路交换图8-9IP电话的几种连接方法3.IP电话的通话质量IP电话的通话质量与电路交换电话网的通话质量有很大差别。在电路交换电话网中，任何两端之间的通话质量都是有保证的。但IP电话则不然。IP电话的通话质量主要由两个因素决定，一个是通话双方端到端的时延和时延抖动，另一个是话音分组的丢失率。但这两个因素都是不确定的，而是取决千当时网络上的通信量。若网络上的通信量非常大以致发生了网络拥塞，那么端到端时延和时延抖动以及分组丢失率都会很高，这就导致IP电话的通话质量下降。因此，一个用户使用IP电话的通话质量取决于当时其他许多用户的行为。请
注意，电路交换电话网的情况则完全不是这样。当电路交换电话网的通信量太大时，往往使我们无法拨通电话（听到的是忙音），即电话网拒绝对正在拨号的用户提供接通服务。但是O注：公用电话网即公用电路交换电话网，又称为传统电话网或电信网。

**关键词**: 公用电话网 固定电话 IP电话 网关 电路交换 分组交换 时延 时延抖动 分组丢失率 网络拥塞


### 关键词提取 - 分块 6
•380•只要我们拨通了电话，那么电信公司就能保证让用户享受满意的通话质量。
一经验证明，在电话交谈中，端到端的时延不应超过250ms,否则交谈者就会感到不自
般只有50~70ms。但经过同步卫星的电话端到端时延就超过然。陆地公用电话网的时延
250ms,一般人都不太适应经过卫星传送的过长的时延。
因此IP电话必须努力减小端到端的时延。当通信线路产生回声时，则容许的端到端时延就
更小些（有时甚至只容许几十毫秒的时延）。
IP电话的时延有时会超过250ms,IP电话端到端时延是由以下几个因素造成的：
(1)话音信号进行模数转换要产生时延。
一一(2)已经数字化的话音比特流要积累到定的数量才能够装配成个话音分组，这也会产生时延。
(3)话音分组的发送需要时间，此时间等千话音分组长度与通信线路的数据率之比。
(4)话音分组在互联网中经过许多路由器的存储转发时延。
(5)话音分组到达接收端在缓存中暂存所引起的时延。
(6)将话音分组还原成模拟话音信号的数模转换也要产生定的时延。
一(7)话音信号在通信线路上的传播时延。

**关键词**: 计算机网络 端到端时延 IP电话 模数转换 数字话音比特流 话音分组 路由器 存储转发 缓存 数模转换 通信线路传播时延


### 关键词提取 - 分块 7
一(7)话音信号在通信线路上的传播时延。
(8)山终端设备的硬件和操作系统产生的接入时延。由IP电话网关引起的接入时延约
为20~40ms,而用户PC声卡引起的接入时延为20~180ms。有的调制解调器（如V.34)还
会再增加20~40ms的时延（由千进行数字信号处理、均衡等）。
一话音信号在通信线路上的传播时延般都很小（卫星通信除外），通常可不予考虑。当一采用高速光纤主干网时，上述的第三项时延也不大。
一第、第二和第六项时延取决千话音编码的方法。很明显，在保证话音质量的前提下，
话音信号的数码率应尽可能低些。为了能够在世界范围提供IP电话服务，话音编码就必须
ITU-T己制定出不少话音质量不错的低速率话音编码的标准。目前适的国际标准。
采用统
合IP电话使用的ITU-T标准主要有以下两种：(1)G.729话音速率为8kbit/s的共辅结构代数码激励线性预测CS-ACELP(Conjugate­StructureAlgebraic-Code-ExcitedLinearPrediction)声码器。

**关键词**: 计算机网络 时延 IP电话网关 V.34调制解调器 数字信号处理 均衡 光纤主干网 话音编码 G.729标准 CS-ACELP声码器


### 关键词提取 - 分块 8
(2)G.723.1话音速率为5.3/6.3kbit/s的线性预测编码LPC(LinearPredictionCoding)声码器。
这两种标准的比较见表8-1。
标准I比特率(kbit/s)I帧大小(ms)1帧长（字节）
1处理时延(ms)
表8-1G.729和G.723.1的主要性能比较数字信号处理MIPS42016一一表中的比特率是输入为64kbit/s标准PCM信号时在编码器输出的数据率。帧大小是压
一
缩到每
个帧运行编码算法所需的时间。帧个分组中的话音信号时间长度。处理时间是对长是个已编码的帧的字节数（不包括首部）。数字信号处理MIPS（每秒百万指令）是用数字信号处理芯片实现编码所需的最小处理机速率（以每秒百万指令为单位）。如使用PC
的通用处理机，则所需的处理机MIPS还要高些。不难看出，G.723.1标准虽然可得到更低
的数据率，但其时延也更大些。
•381•要减少上述第四和第五项时延较为困难。当网络发生拥塞而产生话音分组丢失时，还
”
)对丢失的话音分组进行处理。例如，可使用定的策略（称为丢失掩蔽算法一＂必须采用
前一个话音分组来填补丢失的话音分组的间隙。

**关键词**: 计算机网络 线性预测编码 声码器 比特率 帧大小 字节 处理时延 数字信号处理 MIPS 话音分组 丢失掩蔽算法


### 关键词提取 - 分块 9
前一个话音分组来填补丢失的话音分组的间隙。
接收端缓存空间和播放时延的大小对话音分组丢失率和端到端时延也有很大的影响。
图8-10说明了这
量）、良好”““一问题。话音质量可分为四个级别，即长途电话质量”“基本可用和不好”
，各对应千图8-10中的一个区域。越接近坐标原点，”
（这是最好的质“话音质量就越好。我们假定某IP电话的通话质量处在图中B点的位置。若增大接收端缓存空间并增大播放时延，则话音分组丢失率将减小，但端到端的时延将增大（如图中的C点）。
继续增大播放时延，则话音分组丢失率将继续减小，趋向千网络所引起的丢失率（如图中的D点），但D点的端到端时延很大，话音质量很不好。反之，若将接收端缓存做得很小并减
小播放时延，则端到端时延将减小，趋向于网络所引起的端到端时延（如图中的A点），但话音分组丢失率将会大大增加，话音质量也不好。
分组
丢失率20%10%5%长途电话
质晕，良
�:0多一一100ms400ms
150ms

**关键词**: 计算机网络 端到端时延 话音分组丢失率


### 关键词提取 - 分块 10
分组
丢失率20%10%5%长途电话
质晕，良
�:0多一一100ms400ms
150ms
图8-10播放时延有一个最佳值端到端时延可见接收端的播放时延有一个最佳值。图中有一个点N,相当千端到端时延和话音分组丢失率都是最小的，但实际上并不可能工作在这个点上。
据统计，当通话双方相距3200km时，互联网上的时延约为30~100ms（传播和排队），
而所有各环节的时延总和约为100~262ms（在两个IP电话网关之间）或170~562ms（在两
个PC之间）［KAST98]。可见为了减小时延，应尽可能不要直接用PC打IP电话。
提高路由器的转发分组的速率对提高IP电话的质量也是很重要的。据统计，一个跨大西洋的IP电话一般要经过20~30个路由器。现在一个普通路由器每秒可转发50~100万个分组。若能改用吉比特路由器（又称为线速路由器），则每秒可转发500万至6000万个分组
一（即交换速率达60Gbit/s左右）。这样还可进步减少由网络造成的时延。
近几年来，IP电话的质量得到了很大的提高。现在许多IP电话的话音质量已经优千固定电话的话音质量。

**关键词**: 计算机网络 端到端时延 播放时延 路由器 转发分组 IP电话 时延 吉比特路由器


### 关键词提取 - 分块 11
近几年来，IP电话的质量得到了很大的提高。现在许多IP电话的话音质量已经优千固定电话的话音质量。
一些电信运营商还建造了自己专用的IP电话线路，以便保证更好的通话质提的就是SkypeIP电话，它给全世界的广大用户带来了高
量。在IP电话领域里，最值得
品质并且廉价的通话服务。Skype使用了GlobalIPSound公司开发的互联网低比特率编解码一器iLBC(internetLowBit
质量优于传统的公用电话网（采用电路交换）的话音质量。Skype支持两种帧长：20ms（速
个话音分组块为304bit)和30ms（速率为13.33kbit
率为15.2kbitrateCodec)[RFC3951,3952]，进行话音的编解码和压缩，使其话音个话音分组/s,/s,一一块为400bit)。Skype的另一个特点是对话音分组的丢失进行了特殊的处理，因而能够容忍高达30％的话音分组丢失率，通话的用户一般感觉不到话音的断续或迟延，杂音也很小。
•382•Skype采用了P2P（见第6章6.9节的介绍）和全球索引CGlobalIndex)技术提供快速

**关键词**: IP电话 固定电话 iLBC internet Low Bit Rate Codec P2P Global Index


### 关键词提取 - 分块 12
路由选择机制（而不是单纯依靠服务器来完成这些工作），因而其管理成本大大降低，在用
户呼叫时，由千用户路由信息分布式存储千互联网的节点中，因此呼叫连接完成得很快。
Skype还采用了端对端的加密方式，保证信息的安全性。Skype在信息发送之前进行加密，
在接收时进行解密，在数据传输过程中完全没有可能在中途被窃听。
由千Skype使用的是P2P的技术，用户数据主要存储在P2P网络中，因此必须保证存
储在公共网络中的数据是可靠的和没有被篡改的。Skype对公共目录中存储的和用户相关的
数据都采用了数字签名，保证了数据无法被篡改。
自2003年8月Skype推出以来，在短短15个月内，Skype已拥有超过5000万次的下
一载量，注册量超过2000万用户，并且还在以每天超过15万用户的速度增长。在2011年，
时间使用Skype的用户数已经突破了3000万大关。据统计，在2014年的国际长途电
在同
话的市场份额中，Skype已经占据了40%。Skype的问世给全球信息技术和通信产业带来深
远的影响，也给每
8.3.2IP电话所需要的几种应用协议位网络使用者带来生活方式的改变。

**关键词**: 路由选择机制 用户呼叫 端对端加密 P2P技术 数字签名 国际长途电话


### 关键词提取 - 分块 13
远的影响，也给每
8.3.2IP电话所需要的几种应用协议位网络使用者带来生活方式的改变。
一Q)一在IP电话的通信中，我们至少需要两种应用协议。一种是信令协议，它使我们能够在
种是话音分组的传送协议，它使我们用来进行电话通信的话
互联网上找到被叫用户
音数据能够以时延敏感属性在互联网中传送。这样，为了在互联网中提供实时交互式的音频
／视频服务，我们需要新的多媒体体系结构。
。另一图8-11给出了在这样的体系结构中的三种应用层协议。第种协议是与信令有关的，如H.323和SIP（画在最左边）；第二种协议是直接传送音频／视频数据的，如RTP（画在最
右边）；第三种协议是为了提高服务质量，如RSVP和RTCP（画在中间）。
信令音频／视频应用层协议服务质鼠UDPIPv4/IPv6底层网络图8-11提供实时交互式音频／视频服务所需的应用层协议下面先介绍实时运输协议RTP及其配套的协议实时运输控制协议RTCP,然后再介CD注：在公用电话网中，电话交换机根据用户所拨打的号码就能够通过合适的路由找到被叫用户，并在主叫和被叫之间建

**关键词**: IP电话 信令协议 话音分组传送协议 RTP RTCP H.323 SIP RSVP 服务质量 UDP IPv4 IPv6 实时交互式音频/视频服务 底层网络


### 关键词提取 - 分块 14
一一(signaling)立起条电路连接。这些都依靠电话信令完成。我们听到的振铃声、忙音或些录音提示，以及打完电话挂机释放连接，也都是由电话信令来处理的。现在电话网使用的信令就是7某种信令，但由千IP电话往往要经过已有的公用电话网，因此号信令
IPSS7IP。利用网络打电话同样也需要IP网络能够识别的电话的信令必须在所有的功能上与原有的7号信令相兼容，这样才能使IP网络和公用电话网上的两种信令能够互相转换，因而能够做到互操作。
•383•绍IP电话的信令协议H.323和会话发起协议SIP。
8.3.3实时运输协议RTP实时运输协议RTP(Real-timeTransportProtocol)是IETF的AVT工作组(AudioNideoTransportWG)开发的协议，现已成为互联网标准[RFC3550,STD64][RFC3551,STD65]。

**关键词**: 计算机网络 IP电话 信令 7号信令 H.323 SIP RTP


### 关键词提取 - 分块 15
RTP为实时应用提供端到端的运输，但不提供任何服务质量的保证。需要发送的多媒体数据块（音频／视频）经过压缩编码处理后，先送给RTP封装成为RTP分组（也可称为RTP报文CD)。RTP分组装入运输层的UDP用户数据报后，再向下递交给IP层。RTP现已成为互联网正式标准，并且已被广泛使用。RTP同时也是ITU-T的标准(H.225.0)。实际上，
些共同功能。R'fP自己并不对多媒体个协议框架，因为它只包含了实时应用的RTP是一一数据块做任何处理，而只是向应用层提供一些附加的信息，让应用层知道应当如何进行处理。
图8-11把RTP协议画在应用层。这是因为从应用开发者的角度看，RTP应当是应用层一的部分。在应用程序的发送端，开发者必须编写用RTP封装分组的程序代码，然后把RTP分组交给UDP套接字接口。在接收端，RTP分组通过UDP套接字接口进入应用层后，还要利用开发者编写的程序代码从RTP分组中把应用数据块提取出来。

**关键词**: RTP UDP IP层 多媒体数据块 压缩编码 RTP分组 互联网正式标准 ITU-T标准 R'fP 应用层 UDP套接字接口


### 关键词提取 - 分块 16
然而RTP的名称又隐含地表示它是一个运输层协议。这样划分也是可以的，因为RTP封装了多媒体应用的数据块，并且由千RTP向多媒体应用程序提供了服务（如时间戳和序号），因此也可以把RTP看成是在UDP之上的一个运输层子层的协议。
RTP还有两点值得注意。首先，RTP分组只包含RTP数据，而控制是由另用的RTCP协议提供的（这在下一节介绍）。其次，个配套使
RTP在端口号1025到65535之间选择一一个未使用的偶数UDP端口号，而在同一次会话中的RTCP则使用下一个奇数UDP端口号。
但端口号5004和5005则分别用作RTP和RTCP的默认端口号。
图8-12给出了RTP分组的首部格式，下面进行简单的介绍。
位0I3版对叫对参与原数1Mi有效载荷类型l168序号时间戳同步源标识符(SSRC)参与源标识符(CSRC)[O..15]
．．．3丁12上发送IP首部IUDP首部j-RTP首部IRTP数据部分（应用层数据）|RTP分组

**关键词**: RTP RTCP UDP SSRC CSRC


### 关键词提取 - 分块 17
．．．3丁12上发送IP首部IUDP首部j-RTP首部IRTP数据部分（应用层数据）|RTP分组
UDP用户数据报IP数据报图8-12RTP分组的首部格式＠注：按惯例，在运输层或应用层的协议数据单元应当叫作报文。但相关RFC文档中都是使用RTPpacket这一名词的。
为了和RFC文档一致，这里也使用“RTP分组”。下一节的RTCP也按同样方法处理。
•384•在RTP分组的首部中，前12个字节是必需的，而12字节以后的部分则是可选的。下面按照各字段重要性的顺序来进行介绍。
(1)有效载荷类型(payloadtype)占7位。这个字段指出后面的RTP数据属千何种格式的应用。收到RTP分组的应用层就根据此字段指出的类型进行处理。例如，对千音频有效载荷（每一种格式后面括弧中的数字就表示其有效载荷类型的编码）：µ律PCM(0),GSM
 A律PCM(8)G.722(9),G.728(15)等。对千视频有效载荷：活动JPEG(26),(7)(3),LPC
H.261(31),MPEGI(32),MPEG2(33)等。

**关键词**: RTP首部 UDP首部 IP首部 RTP分组 应用层数据 有效载荷类型


### 关键词提取 - 分块 18
H.261(31),MPEGI(32),MPEG2(33)等。
(2)序号占16位。对每一个发送出的RTP分组，其序号加1。在一次RTP会话开始时的初始序号是随机选择的。序号使接收端能够发现丢失的分组，同时也能将失序的RTP分组重新按序排列好。例如，在收到序号为60的RTP分组后又收到了序号为65的RTP分组。那么就可推断出，中间还缺少序号为61至64的4个RTP分组。
(3)时间戳占32位。时间戳反映了RTP分组中数据的第一个字节的采样时刻。在一次会话开始时时间戳的初始值也是随机选择的。即使在没有信号发送时，时间戳的数值也要随时间而不断地增加。接收端使用时间戳可准确知道应当在什么时间还原哪一个数据块，从而消除时延的抖动。时间戳还可以用来使视频应用中声音和图像同步。在RTP协议中并没有规定时间戳的粒度，这取决于有效载荷的类型。因此RTP的时间戳又称为媒体时间戳，以强调这种时间戳的粒度取决千信号的类型。例如，对千8kHz采样的话音信号，若每隔一个数据块，则一个数据块中包含有160个样本(0.02X8000=}60)。因此发送20ms构成

**关键词**: 计算机网络 序号 RTP分组 时间戳 丢失的分组 重新排列 接收端 会话 初始序号 随机选择 数据块 采样时刻 时延抖动 声音和图像同步 媒体时间戳 信号类型 8kHz采样 20ms构成


### 关键词提取 - 分块 19
一端每发送个RTP分组，其时间戳的值就增加160。
(4)同步源标识符占32位。同步源标识符SSRC(SynchronousSouRCeidentifier)是
一个数，用来标志RTP流(stream)的来源。SSRC与IP地址无关，在新的RTP流开始时随机地产生。山于RTP使用UDP传送，因此可以有多个RTP流（例如，使用几个摄像机从不同角度拍摄同一个节目所产生的多个RTP流）复用到一个UDP用户数据报中。SSRC可使接收端的UDP能够将收到的RTP流送到各自的终点。两个RTP流恰好都选择同的概率是极小的。若发生这种情况，这两个源就都重新选择另一个SSRC。
一个SSRC(5)参与源标识符这是选项，最多可有15个。参与源标识符CSRC(ContributingSouRCeidentifier)也是一个32位数，用来标志来源千不同地点的RTP流。在多播环境中，可以用中间的一个站（叫作混合站mixer)把发往同一个地点的多个RTP流混合成一个流（可节省通信资源），在目的站再根据CSRC的数值把不同的RTP流分开。
(6)参与源数占4位。这个字段给出后面的参与源标识符的数目。
(7)版本

**关键词**: 计算机网络 UDP RTP流 SSRC CSRC


### 关键词提取 - 分块 20
(6)参与源数占4位。这个字段给出后面的参与源标识符的数目。
(7)版本
(8)填充P占2位。当前使用的是版本2。
占1位。在某些特殊情况下需要对应用数据块加密，这往往要求每一个数据块有确定的长度。如不满足这种长度要求，就需要进行填充。这时就把P位置1，表示这个RTP分组的数据有若干填充字节。在数据部分的最后一个字节用来表示所填充的字节数。
(9)扩展X占1位。X置1表示在此RTP首部后面还有扩展首部。扩展首部很少使用，这里不再讨论。
(10)标记M占1位。M置l表示这个RTP分组具有特殊意义。例如，在传送视频流时用来表示每一帧的开始。
•385•,
,
8.3.4实时运输控制协议RTCPRTCP(RTPControlProtocol)RTP[RFC3550,3551]RTCP
实时运输控制协议RTP是与RTCP
，实际上，协议也是协议不可分割的部分。
配合使用的协议
一协议的主要功能是：服务质量的监视与反馈、媒体间的同步（如某RTCPRTCP
个RTP发送UDPRTCP
的声音和图像的配合），以及多播组中成员的标志。

**关键词**: 实时运输控制协议RTCP 实时传输协议RTP RFC3550 RFC3551


### 关键词提取 - 分块 21
个RTP发送UDPRTCP
的声音和图像的配合），以及多播组中成员的标志。
一分组（也可称为RTCP报文）也使用RTCP来传送，但并不对音频／视频分组进行封装。由于RTCPUDP分组很短，因此可把多个分组封装在个用户数据报中。
分组周期性地在网上传送，它带有发送端和接收端对服务质量的统计信息报告（例如，已发送的分组数和字节数、分组丢失RTCP
率、分组到达时间间隔的抖动等）。
8-2表是使用的五种分组类型，它们都使用同样的格式。
表8-2RTCP的五种分组类型类型
2002Ol202203204缩写表示SRRRSDESBYEAPP意义发送端报告接收端报告源点描述
结束特定应用BYE一结束分组APP
表示关闭个数据流。
特定应用分组
一
一
RTP
接收端报告分组收到个流（RR使应用程序能够定义新的分组类型。
一用来使接收端周期性地向所有的点用多播方式进行报告。接收端每RTPRRRR组的内容有：所收到的流的该RTP次会话包含有许多的SSRC;RTPRTP流）就产生个接收端报告分组
RTP
流的分组丢失率（若分组丢失率太高，发分一。

**关键词**: RTCP RTP UDP 多播 服务质量 分组类型 SRR RS RD SSRC BYE APP


### 关键词提取 - 分块 22
RTP
流的分组丢失率（若分组丢失率太高，发分一。
送端就应当适当降低发送分组的速率）；在该流中的最后个分组的序号；分组RR
到达时间间隔的抖动等。
一发送分组有两个目的：第RTCP，可以使所有的接收端和发送端了解当前网络的状态；RTCP第二，可以使所有发送RTCP分组的站点自适应地调整自已发送RTP分组的速率，使得起控制作用的
RTCP分组不要过多地影响传送应用数据的5%分组在网络中的传输。通常是分组的通信量不超过网络中数据分组的通信量的RTCP75%，而接收端报告分组的通信量使
又应小千所有
一SR
分组的通信量的。
一发送端报告分组RTPSR
用来使发送端周期性地向所有接收端用多播方式进行报告。发送端RTPSR每发送个SSRC;
流，就要发送RTP个发送端报告分组RTP的同步源标识符wallclocktime)
该上时钟时间；该RTP
流中最新产生的
一RTP流包含的分组数；该分组的主要内容有：该流
。
分组的时间戳和绝对时钟时间（或墙RTP一
流包含的字节数。
绝对时钟时间是必要的。因为要求每种媒体使用像和相应的声音就需要传送两个流。有了绝对时钟时间就可进行图像和声音的同步。

**关键词**: RTP RTCP SR


### 关键词提取 - 分块 23
SDES(CanonicalNAME)源点描述分组给出会话中参加者的描述，它包含参加者的规范名。规范名是参加者的电子邮件地址的字符串。
•386•个流。例如，要传送视频图
CNAME8.3.5H.323一一现在IP电话有两套信令标准：套是ITU-T定义的H.323协议，另
的会话发起协议SIP(SessionInitiationProtocol)。我们先介绍H.323协议。
“”套是IETF提出H.323是ITU-T千1996年制定的为在局域网上传送话音信息的建议书。
1998年H.323基千分组的多媒体通信系统的第二个版本改用的名称是
基千分组的网络包括互联网、局域网、企业网、城域网和广域网。H.323是互联网的端系统
之间进行实时声音和视频会议的标准。请注意，H.323不是
H.323包括系统和构件的描述、呼叫模型的描述、呼叫信令过程、控制报文、复用、话音编
解码器、视像编解码器，以及数据协议等。图8-13示意了连接在分组交换网上的H.323终
端使用H.323协议进行多媒体通信。
。在2009年已更新到H.323v7。
一个单独的协议而是组协议。

**关键词**: 计算机网络 IP电话 H.323协议 SIP 分组交换网 多媒体通信 广域网 局域网 企业网 城域网 会话发起协议 实时声音和视频会议 呼叫信令过程 控制报文 复用 话音编解码器 视像编解码器 数据协议 H.323终端 H.323v7


### 关键词提取 - 分块 24
。在2009年已更新到H.323v7。
一个单独的协议而是组协议。
一图8-13H.323终端使用H.323协议进行多媒体通信H.323标准指明了四种构件，使用这些构件连网就可以进行点对点或一体通信。
一点对多点的多媒个PC,也可以是运行H.323程序的单个设备。
(l)H.323终端
(2)网关这可以是
一网关连接到两种不同的网络，使得H.323网络可以和非H.323网络（如公用电话网）进行通信。仅在
(3)网闸(gatekeeper)个H.323网络上通信的两个终端当然就不需要使用网关。
网闸相当千整个H.323网络的大脑。所有的呼叫都要通过网闸，
因为网闸提供地址转换、授权、带宽管理和计费功能。网闸还可以帮助H.323终端找到距离
公用电话网上的被叫用户最近的个网关。
一(4)多点控制单元MCU(MultipointControlUnit)MCU支持三个或更多的H.323终端的音频或视频会议。MCU管理会议资源、确定使用的音频或视频编解码器。
一网关、网闸和MCU在逻辑上是分开的构件，但它们可实现在

**关键词**: H.323协议 H.323v7 H.323终端 网关 gatekeeper 多点控制单元MCU


### 关键词提取 - 分块 25
一网关、网闸和MCU在逻辑上是分开的构件，但它们可实现在
H.323标准中，将H.323终端、网关和MCU都称为H.323端点(endpoint)。
图8-14表示了利用H.323网关使互联网能够和公用电话网进行连接。
个物理设备中。在＼公用电话网渲图8-14H.323网关用来和非H.323网络进行连接一图8-15给出了H.323的体系结构。可以看出，H.323是一个协议族，它可以使用不同的运输协议。H.323包括以下些组成部分：•387•音频／视频应用口编解码编解码RTCPRTPUDP数据应用T.120
数据信令和控制H.225.0IH.225.0IH.245登记
信令呼叫
信令控制
信令IPTCP图8-15H.323的协议体系结构(1)音频编解码器H.323要求至少要支持G.711(64kbit/s的PCM)。建议支持如G.722C16kbit/s的ADPCM),G.723.1(5.3/6.3的LPC),G.728C16kbit/s的低时延CELP)和G.729(8kbit/s的CS-ACELP)等。

**关键词**: 网关 网闸 MCU H.323标准 H.323终端 H.323端点 H.323网关 公用电话网 H.323体系结构 音频／视频应用口编解码编解码RTCPRTPUDP数据应用T.120 数据信令和控制H.225.0IH.225.0IH.245登记信令呼叫信令控制IPTCP


### 关键词提取 - 分块 26
(2)视频编解码器H.323要求必须支持H.261标准CI76x144像素）。
(3)H.255.0登记信令，即登记／接纳／状态RAS(Registration/Admission/Status)。
H.323终端和网闸使用RAS来完成登记、接纳控制和带宽转换等功能。
(4)H.225.0呼叫信令用来在两个H.323端点之间建立连接。
(5)H.245控制信令用来交换端到端的控制报文，以便管理H.323端点的运行。
(6)T.120数据传送协议这是与呼叫相关联的数据交换协议。用户在参加音频／视频会议时，可以和其他与会用户共享屏幕上的臼板。由千使用TCP协议，因此能够保证数据传送的正确（在传送音频／视频文件时使用的是UDP,因此不能保证服务质量）。
(7)实时运输协议RTP和实时运输控制协议RTCP这两个协议前面已讨论。
H.323的出发点是以已有的电路交换电话网为基础，增加了IP电话的功能（即远距离传输采用IP网络）。H.323的信令也沿用原有电话网的信令模式，因此与原有电话网的连接比较容易。

**关键词**: 视频编解码器H.323 H.261标准 CI76x144像素 登记信令RAS Registration/Admission/Status H.323终端 网闸 带宽转换 呼叫信令H.225.0 控制信令H.245 数据传送协议T.120 实时运输协议RTP 实时运输控制协议RTCP


### 关键词提取 - 分块 27
8.3.6会话发起协议SIP虽然H.323系列现在已被大部分生产IP电话的厂商采用，但由千H.323过千复杂（整
个文档多达736页），不便千发展基千IP的新业务，因此IETF的MMUSIC工作组制定了另
一套较为简单且实用的标准，即会话发起协议SIP(SessionInitiationProtocol)[RFC3261-3264]，目前已成为互联网的建议标准。SIP使用了KISS原则：即
(KeepItSimpleandStupid)。
“保持简单、傻瓜”SIP协议的出发点是以互联网为基础，而把IP电话视为互联网上的新应用。因此SIP
协议只涉及IP电话所需的信令和有关服务质量的问题，而没有提供像H.323那样多的功能。
SIP没有强制使用特定的编解码器，也不强制使用RTP协议。然而，实际上大家还是选用RTP和RTCP作为配合使用的协议。

**关键词**: 会话发起协议SIP KISS原则 MMUSIC工作组 RFC3261-3264 互联网建议标准 信令 服务质量 编解码器 RTP协议 RTCP


### 关键词提取 - 分块 28
SIP使用文本方式的客户－服务器协议。SIP系统只有两种构件，即用户代理(useragent)和网络服务器(networkserver)。用户代理包括两个程序，即用户代理客户UAC(UserAgentClient)和用户代理服务器UAS(UserAgentServer)，前者用来发起呼叫，后者用来接受呼叫。
网络服务器分为代理服务器(proxyserver)和重定向服务器(redirectserver)。代理服务器接受来自主叫用户的呼叫请求（实际上是来自用户代理客户的呼叫请求），并将其转发给被叫用一户或下跳代理服务器，然后下一跳代理服务器再把呼叫请求转发给被叫用户（实际上是转发给用户代理服务器）。重定向服务器不接受呼叫，它通过响应告诉客户下一跳代理服务器•388•一的地址，由客户按此地址向下跳代理服务器重新发送呼叫请求。
一SIP的地址十分灵活。它可以是电话号码，也可以是电子邮件地址、IP地址或其他类型的地址。但定要使用SIP的地址格式，例如：•电话号码•1Pv4地址sip:zhangsan@8625-87654321

**关键词**: 用户代理 用户代理客户 UAC 用户代理服务器 UAS 网络服务器 代理服务器 重定向服务器 SIP地址 电话号码 IP地址


### 关键词提取 - 分块 29
sip:zhangsan@201.12.34.56•电子邮件地址sip:zhangsan@l63.com一和HTTP相似，SIP是基千报文的协议。SIP使用了HTTP的许多首部、编码规则、差错码以及些鉴别机制。它比H.323具有更好的可扩缩性。
一SIP的会话共有三个阶段：建立会话、通信和终止会话。图8-16给出了个简单的SIP会话的例子。图中的建立会话阶段和终止会话阶段，都是使用SIP协议，而中间的通信阶段，则使用如RTP这样的传送实时话音分组的协议。
被叫方主叫方＼三建立
会话通信终止
会话INVITE:地址，选项OK：地址ACK电话交谈BYE图8-16一个简单的SIP会话的例子一在图8-16中，主叫方先向被叫方发出INVITE报文，这个报文中含有双方的地址信息以及其他些信息（如通话时话音编码方式等）。被叫方如接受呼叫，则发回OK响应，而主叫方再发送ACK报文作为确认（这和建立TCP连接的三报文握手相似）。然后双方就可一以通话了。当通话完毕时，双方中的任何一方都可以发送BYE报文以终止这次的会话。
SIP有种跟踪用户的机制，可以找出被叫方使用的PC的IP地址（例如，被叫方使用

**关键词**: 计算机网络 报文 SIP协议 HTTP 首部 编码规则 差错码 鉴别机制 可扩缩性 会话阶段 RTP 传送实时话音分组 被叫方 主叫方 INVITE报文 OK响应 ACK报文 TCP连接 三报文握手 跟踪用户机制 PC的IP地址


### 关键词提取 - 分块 30
SIP有种跟踪用户的机制，可以找出被叫方使用的PC的IP地址（例如，被叫方使用
一一DHCP,因而没有固定的IP地址）。为了实现跟踪，SIP使用登记的概念。SIP定义些服务一器作为SIP登记器(registrar)。每个SIP用户都有一个相关联的SIP登记器。用户在任何时候发起SIP应用时，都应当给SIP登记器发送个SIPREGISTER报文，向登记器报告现在一使用的IP地址。SIP登记器和SIP代理服务器通常运行在同台主机上。
图8-17说明了SIP登记器的用途。主叫方把INVITE报文发送给SIP代理服务器。这个INVITE报文中只有被叫方的电子邮件地址而没有其IP地址。SIP代理服务器就向SIP登记器发送域名系统DNS查询（这个查找报文不是SIP的报文），然后从回答报文得到了被叫方的IP地址。代理服务器把得到的被叫方的IP地址插入到主叫方发送的INVITE报文中，转发给被叫方。被叫方发送OK响应，然后主叫方发送ACK报文，完成了会话的建立。
•389•｀被叫方SIP代理
服务器主叫方INVITEOKACK-ISIP登记器圣itINVITEOKACK查找回答电话交谈

**关键词**: 计算机网络 PC IP地址 DHCP SIP 注册 服务服务器 登记器 SIPREGISTER报文 域名系统DNS查询 INVITE报文 ACK报文


### 关键词提取 - 分块 31
服务器主叫方INVITEOKACK-ISIP登记器圣itINVITEOKACK查找回答电话交谈
BYE图8-17跟踪被叫方的机制如果被叫没有在这个SIP登记器进行过登记，那么这个SIP登记器就发回重定向报(cid:4825)，指示SIP代理服务器向另一个SIP登记器重(cid:4842)进行DNS查询，直到找到被叫为止。图8-17给出了这种情况下主叫(cid:4851)发出确认之前的呼叫过程。
SIP还有一个配套协议是会话描述协议SDP(SessionDescriptionProtocol)。SDP在电话会议的情况下特别重要，因为电话会议的参加者应当能够动态地加入和退出。SDP详细地指明了媒体编码、协议的端口号以及多播地址。SDP现在也是互联网建议标准[RFC8866]。
由于SIP问世较晚，因此它现在比H.323占有的市场份额要小。对今后作为IETF标准的SIP协议的进展情况应当引起我们的注意。

**关键词**: 服务器 主叫方INVITE OKACK-ISIP登记器 SIP登记器 重定向报 DNS查询 被叫方 呼叫过程 会话描述协议SDP 电话会议 媒体编码 端口号 多播地址 IETF标准 SIP协议


### 关键词提取 - 分块 32
8.4改进“尽最大努力交付＂的服务使互联网更好地传送多媒体信息的另一种(cid:4851)法，是改变互联网平等对待所有分组的思想，使得对时延有较严格要求的实时音频／视频分组，能够从网络得到更好的服务质量QoS。
下面我们先介绍提供服务质量的一般(cid:4852)法。
8.4.1使互联网提供服务质量根据ITU-T在建议书E.800中给出的定义，服务质量QoS是服务性能的总效果，此效
果决定了一个用户对服务的满意程度。因此在最简单的意义上，有服务质量的服务就是能够
满足用户的应用需求的服务，或者说，可提供致的、可预计的数据交付服务。
一在涉及一些具体问题时，服务质量可用若干基本的性能指标来描述，包括可用性、差错率、响应时间、吞吐量、分组丢失率、连接建立时间、故障检测和改正时间等。服务提供者可向其用户保证某一种等级的服务质晕。
我们已多次强调过，互联网的网络本身只能提供“＂

**关键词**: 计算机网络 服务质量QoS 实时音频／视频分组 服务性能 用户应用需求 可用性 差错率 响应时间 吞吐量 分组丢失率 连接建立时间 故障检测和改正时间


### 关键词提取 - 分块 33
我们已多次强调过，互联网的网络本身只能提供“＂
尽最大努力交付的服务。而要传送多媒体信息，网络又必须具有一定的服务质量。下面通过图8-18的例子说明应从哪些(cid:4851)面入手使互联网具有一定的服务质量[KUR017]。图中表示局域网上的两台主机凡和H2通•390•

**关键词**: 网络 服务质量 互联网 局域网 主机

