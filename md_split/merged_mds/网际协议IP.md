### 关键词提取 - 分块 1
属千控制层面的各种路由选择协议。
4.2网际协议IP网际协议IP(InternetProtocol)是TCP/IP体系中两个最主要的协议之一[STEV94][COME06][FORO10]，也是最重要的互联网标准协议之[RFC791,STD5]。网际协议IP又一称为Kahn-Cerf协议，因为这个重要协议正是RobertKahn和VintCerf二人共同研发的。这“”两位学者在2004年获得图灵奖（其地位相当于计算机科学领域的诺贝尔奖)。严格来说，这里所讲的IP其实是IP的第4个版本，记为IPv4。但在讲述协议IP的各种原理时，常省
略IP后面的版本号。在后面的4.5节我们再介绍较新的版本IPv6（版本1~3和版本5都未一曾使用过。顺便指出，所谓的IPv9只不过是某些人故意的炒作而已，不值提）。
与协议IP配套使用的还有三个协议：•地址解析协议ARP(AddressResolutionProtocol)
•网际控制报文协议ICMP(InternetControlMessageProtocol)

**关键词**: 计算机网络 路由选择协议 网际协议IP Kahn-Cerf协议 图灵奖 IPv4 IPv6 地址解析协议ARP 网际控制报文协议ICMP


### 关键词提取 - 分块 2
•网际控制报文协议ICMP(InternetControlMessageProtocol)
•网际组管理协议IGMP(InternetGroupManagementProtocol)一本来还有个协议叫作逆地址解析协议RARP
(ReverseAddressResolutionProtocol)，是和协议ARP配合使用的，但现在已被淘汰不使用了。
一图4-4画出了这三个协议和网际协议IP的关
层中，ARP画在最下面勹因为IP经一系。在这常要使用这个协议。
ICMP和IGMP画在这层的上部，因为它们要使用协议IP。这三个协议将在后面陆续介绍。由于网际协议IP是用来使互连起来的许多计算机网络能够进行通信的，因此
“
TCP/IP体系中的网络层常常被称为网际层(internet
这个名词的好处layer)，或IP层。使用网际层”应用层各种应用层协议(HTTP,FTP,SMTP等）TCP,UDP运输层网络层l压三
（网际层）lIP网络接口层与各种网络接口三物理硬件
，

**关键词**: 网际控制报文协议ICMP 网际组管理协议IGMP 逆地址解析协议RARP 网际协议IP ARP TCP/IP体系 网络层 网际层 internet层 运输层 应用层 HTTP FTP SMTP


### 关键词提取 - 分块 3
（网际层）lIP网络接口层与各种网络接口三物理硬件
，
:_----------------------------------------__:图4-4网际协议IP及其配套协议“”是强调了这是由很多网络构成的互连网络。目前比较普遍使用网络层这个名词。
在讨论网际协议IP之前，必须了解什么是虚拟互连网络。
4.2.1虚拟互连网络我们知道，如果要在全世界范围内把数以百万计的网络都互连起来，并一且能够互相通信，那么这样的任务定非常复杂。其中会遇到许多需要解决视频讲解的问题，如：句注：在互联网标准中，ARP彶列入链路层协议[RFC1122,STD3]，因此有些教科书就把ARP放在链路层中介绍[COME06][STEV94][KUROl7]。但是ARP并不知道自己是处在协议栈的哪一层。从程序调用的关系看，ARP实际上处在链路层和网络层之间[KOZI05]，但不少著名教材都是把ARP放在网络层中讲授的[TANEII][PETE12][FOROIO][STALIO]。从教学的观点看，如果从协议的底层自卜往上讲授，那么在学习链路层时就讲解ARP的工作原理，因涉及到IP地址的转换，似不易理解。

**关键词**: 网际层 IP网络接口层 物理硬件 互连网络 虚拟互连网络 ARP 链路层协议 链路层 网络层 IP地址转换


### 关键词提取 - 分块 4
编者的意见是，既然协议ARP实际上处于链路层和网络层之间，从教学法的角度考虑，对千自底层计始讲的教材，放在网络层讲述似较为方便。实际上，重要的是搞沽ARP的工作原理，不必过千纠缠ARP究竟属于哪一层。
•119••不同的寻址方案；•不同的最大分组长度；•不同的网络接入机制；•不同的超时控制；•不同的差错恢复方法；•不同的状态报告方法；•不同的路由选择技术：•不同的用户接入控制：•不同的服务（面向连接服务和无连接服务）；•不同的管理与控制方式；等等。
一一能不能让大家都使用相同的网络，这样可使网络互连变得比较简单。答案是不行的。
因为用户的需求是多种多样的，没有种单的网络能够适应所有用户的需求。另外，网络技术是不断发展的，网络的制造厂家也要经常推出新的网络，在竞争中求生存。因此客观讲在市场上总是有很多种不同性能、不同网络协议的网络，供不同的用户选用。
一一从般的概念来讲，将网络互相连接起来要使用些中间设备。根据中间设备所在的层次，可以有以下四种不同的中间设备：(1)物理层使用的中间设备叫作转发器(repeater)。

**关键词**: 链路层 网络层 ARP工作原理 寻址方案 最大分组长度 网络接入机制 超时控制 差错恢复方法 状态报告方法 路由选择技术 用户接入控制 服务类型 管理与控制方式 网络互连 中间设备 物理层 转发器


### 关键词提取 - 分块 5
(2)数据链路层使用的中间设备叫作网桥或桥接器(bridge)，以及交换机(switch)。
(3)网络层使用的中间设备叫作路由器(router)气
(4)在网络层以上使用的中间设备叫作网关(gateway)。用网关连接两个不兼容的系统需要在高层进行协议的转换。
一一当中间设备是转发器或网桥时，这仅仅是把个网络扩大了，而从网络层的角度看，
一这仍然是个网络，一般并不称之为网络互连。网关由于比较复杂，目前使用得较少。因此现在我们讨论网络互连时，都是指用路由器进行网络互连和路由选择。路由器其实就是台专用计算机，用来在互联网中进行路由选择。由千历史的原因，许多有关TCP/IP的文献曾经把网络层使用的路由器称为网关（本书有时也这样用），对此请读者加以注意。

**关键词**: 数据链路层 网桥 桥接器 交换机 网络层 路由器 网关 转发器 网桥 网络互连 路由器 专用计算机 TCP/IP


### 关键词提取 - 分块 6
一图4-5(a)表示有许多计算机网络通过些路由器进行互连。由千参加互连的计算机网络都使用相同的网际协议IP(InternetProtocol)，因此可以把互连以后的计算机网络看成为如一图4-5(b)所示的个虚拟互连网络(internet)。所谓虚拟互连网络也就是逻辑互连网络，它的意思就是互连起来的各种物理网络的异构性本来是客观存在的，但是我们利用协议IP就可一一以使这些性能各异的网络在网络层上看起来好像是
拟互连网络可简称为IP网(Ip网是虚拟的，但平常不必每次都强调个统一的网络。这种使用协议IP的虚““虚拟一二字）。使用IP网的好处是：当IP网上的主机进行通信时，就好像在个单个网络上通信样，它们看不见互连的各网络的具体异构细节（如具体的编址方案、路由选择协议，等等）。如果在这种覆盖全球的IP网的上层使用TCP协议，那么就是现在的互联网(Internet)。
＄注：还有一种网桥和路由器的混合物桥路器(brouter)，它是兼有网桥和路由器的功能的产品U实际上，严格的网桥或尹格的路巾器产品是较少见的。不过桥路器名词用得不普遍。请注意router的读音是[rautar]。

**关键词**: 计算机网络 路由器 网际协议IP 虚拟互连网络 internet IP网 TCP协议 桥路器 router


### 关键词提取 - 分块 7
•120•—虚拟的1P网
（互联网）＼—二一二／）三，一」
.＿＿二才:1-，-l＿＿二二l(a)实际的互连网络(b)虚拟的IP网图4-5IP网的概念当很多异构网络通过路由器互连起来时，如果所有的网络都使用相同的协议IP,那么在网络层讨论问题就显得很方便。现在用一个例子来说明。
在图4-6所示的互联网中的源主机凡要把一个IP数据报发送给目的主机H2。根据第1
章中讲过的分组交换的存储转发概念，主机凡先要查找自己的转发表，看目的主机H2是否
就在本网络上。如是，则不需要经过任何路由器而是直接交付，任务就完成了。如不是，则
必须把IP数据报发送给某个路由器（图中的R1)。凡在查找了自己的转发表后，知道应当
把数据报转发给民进行间接交付。这样一直转发下去，最后由路由器民知道自己是和H2
连接在同一个网络上，不需要再使用别的路由器转发了，于是就把数据报直接交付目的主机
H2。总之，分组从源节点A发送到目的节点B,若中间必须经过一个或几个路由器（这表
示A和B不在同一个网络上），则是间接交付。但若不需要经过路由器（这表示A和B在
同一个网络上），则是直接交付。
＼R1R2R3主机、I

**关键词**: 虚拟的IP网 互联网 路由器 IP数据报 转发表 分组交换 存储转发 源主机 目的主机 间接交付 直接交付


### 关键词提取 - 分块 8
同一个网络上），则是直接交付。
＼R1R2R3主机、I
r-;,;:
H1俨」三R1.-
、
1三I
I
三三三//
厂心lII`三\Il全D（灼三间接交付R4r歹
3.-户(`矿
＼3
 Hf`
.
f、I$＞,`，`2«
（｀
肆图中的协议栈中的数字1~5分别表示物理层、数据链路层、网络层、运输层和应用层图4-6分组在互联网中的传送•121•在图中画出了源主机、目的主机以及各路由器的协议栈。我们注意到，主机的协议栈共有五层，但路由器的协议栈只有下三层。图中还画出了数据在各协议栈中流动的方向（用黑色粗线表示）。我们还可注意到，在凡和民之间使用了卫星链路，而凡所连接的是个无]一线局域网（民和主机压都在同个局域网中）。在R到凡之间的三个网络则可以是任意类型的网络。总之，这里强调的是：互联网可以由多种异构网络互连组成。
有时可以把问题简化。我们可以想象IP数据报就在网络层中传送，传输路径可省略路由器之间的网络以及连接在这些网络上的许多无关主机。图4-7表示了这样的传输路径。

**关键词**: 计算机网络 物理层 数据链路层 网络层 运输层 应用层 协议栈 分组 互联网 路由器 局域网 卫星链路


### 关键词提取 - 分块 9
／跳＼／跳跳'/跳＇＼跳/跳汕主机H1-R1-Rz----:--R3-凡三厂／t间按交付///直接交付一一一R5－比目的主机图4-7源主机H]向目的主机儿发送分组一一“”“
在互联网的词汇中，分组在传送途中的每一
次转发都称为跳(hop)一
。也有人把hop
1一
译为跃点。路由器在转发分组时也常常使用25下跳(nexthop)"的说法。例如，R的下一
跳是R,而凡的下跳是R一
。对千本例，凡向儿发送分组需要经过6跳。我们还注意到，一每跳两端的两个节点都必定直接连接在同一
个网络上。例如，在图4-7中从民到民的跳，其两端的两个节点民和民都是连接在同一个网络上的。在上面所举的例子中，前5跳都是间接交付，只有最后
IP地址
4.2.2跳是直接交付。
一一在TCP/IP体系中，IP地址是个最基本的概念。
个连接在互联网上的设备，如果没有IP地址，就无法和网上的其他设备进行通信。因此应当首先学好有关IP地址的内容。

**关键词**: 跳 跳点 下跳 路由器 分组 互联网 IP地址


### 关键词提取 - 分块 10
1.IP地址及其表示方法一一整个的互联网就是一个单的、抽象的网络。IP地址就是给连接到互联网上的每一一一台主机（或路由器）的每个接口，分配个在全世界范围内是唯的32位的标识符。IP地址的结构使我们可以在互联网上很方便地进行寻址。IP地址现在由互联网名字和数字分配
机构ICANN(InternetCorporationforAssignedNamesandNumbers)进行分配气对主机或路由器来说，IP地址都是32位的二进制代码。为了提高可读性，我们常常把一32位的IP地址中的每隔8位插入个空格（但在机器中并没有这样的空格）。为了便千人一们书写和记忆，常用其等效的十进制数字表示，并且在每段数字之间加上一个小数点。这就叫伲点分十进制记法(dotteddecimalnotation)。图4-8是个IP地址表示方法的例子。显然，把IP地址用4段十进制数字来表示是个很好的方法。

**关键词**: IP地址 互联网 主机 路由器 标识符 寻址 互联网名字和数字分配机构ICANN 32位二进制代码 点分十进制记法


### 关键词提取 - 分块 11
O注：IP地圳婓按级申请分配。互联网号码分配机构JANA把大块IP地址妆地区先分配给全球五个信息中心。中国互联网信息中心CNNIC再向其中的亚太网络信息中心APNIC(AsiaPacificNetworkInfom1ationCenter)申请地址。我旧的ISP则必须向CNNIC申请地址。
IP地址都是有怯租用的。
•122•机器中存放的IP地址是连续的二进制代码一—-IlOOOOOOOOOOOlOllOOOOOOllOOOlllll|每隔8位插入个空格能够提高可读性-100000000000IO110000001100011111
仁—飞一—丿一—~－-＼——丫＿＿把8位的二进制数转换为十进制数11
3
\＼／
采用4段十进制数字的点分十进制记法一__.,.128.11.3.31128'31/图4-8采用点分十进制记法能够提高可读性前面所讲的给每个主机（或路由器）的接口分配一个IP地址，其含义就是这个IP地址
不但标志了这个主机（或路由器），而且还标志了此接口所连接的网络。因此，32位的IP
地址采用两级结构，由两个字段组成。第一个字段是网络号，它标志主机（或路由器）所连

**关键词**: IP地址 互联网号码分配机构JANA 中国互联网信息中心CNNIC 亚太网络信息中心APNIC ISP 二进制代码 十进制数 点分十进制记法 网络号


### 关键词提取 - 分块 12
地址采用两级结构，由两个字段组成。第一个字段是网络号，它标志主机（或路由器）所连
接到的网络。一个网络号在整个互联网范围内必须是唯一的。第二个字段是主机号，它标志
该主机（对路由器来说，就是标志该路由器）。一个主机号在所连接的网络（即前面的网络
号所指明的网络）中必须是唯一的。由此可见，一个IP地址在整个互联网范围内是唯一的。
因此，IP地址可以记为：IP地址：：＝｛＜网络号＞，＜主机号＞｝（4-1)式(4-1)中的符号”:：=”表示“定义为"。IP地址中包含网络号就表明，不连网的主机就
没有IP地址。一定要记住，IP地址指明了连接到某个网络上的一个主机（或路由器）。为
简单起见，当不涉及路由器时，后面我们都以主机为例来介绍IP地址。
图4-9表示IP地址中的网络号和主机号的位置。具体的规定是：IP地址中的前n位是
主机所连接的网络号，而IP地址中后面的(32-n)位是主机号。现在的问题是，当我们看到
一个IP地址时，怎样知道它的网络号的位数n是多少？下面我们就来讨论这个问题。
IP地址1网络号l-n位32位111王机号

**关键词**: 计算机网络 IP地址 网络号 主机号


### 关键词提取 - 分块 13
IP地址1网络号l-n位32位111王机号
(32—n)位------,图4-9IP地址中的网络号和主机号字段2.分类的IP地址扫一扫在互联网发展早期采用的是分类的IP地址，也就是在图4-9中的n是
固定的几个数之一。分类的方法如图4-lO(a)所示。分类的方法非常简单。
这里A类(n=8)、B类(n=16)和C类(n=24)地址都是单播地址
（一对一通信），是最常用的。D类是多播地址（一对多通信，我们将在4.7节讨论IP多播），
而E类是保留地址。
视频讲解32位的IP地址空间共有232（即4294967296,接近43亿）个地址。A类地址空间共有
2“个地址，占整个IP地址空间的50%。B类地址空间共有230个地址，占整个IP地址空间
的25%。整个C类地址空间共有229个地址，占整个IP地址的12.5%。D类和E类地址各
占整个IP地址的6.25%。图4-lO(b)给出了各类地址占IP地址总数的比例。
从图4-lO(a)可以看出，如果给出一个二进制数表示的IP单播地址，那么就可以很容易知道是哪类地址，并且也能看出这个二进制数表示的网络号和主机号。

**关键词**: IP地址 网络号 主机号 分类的IP地址 A类 B类 C类 D类 E类 单播地址 多播地址 保留地址 IP多播 IP地址空间 二进制数 网络号 主机号


### 关键词提取 - 分块 14
例如，给出一个IP地址10000000000011100010001100000111。对比一下图4-lO(a),不难看出，这是一个B类地址，前16位是网络号，后16位是主机号。
•123•l----32{立－1
尸
A类地址10}网络号1
8位
一一一B类地址＼汇网络号
161了——_/二[
I1j机号
24伈C类地址丿凹二＿一
ID类地址Illl0
-,---网络号
—-24位多五一地址E类地址［三厂保留为今后使用—j机号--－－-』
1
1
161[-1
—_＿＿＿＿-尸
1
8位一|
二主机号(a)(b)图4-10分类的IP地址(a)以及各类地址所占的比例(b)A类地址的网络号字段占1个字节，只有7位可供使用（该字段的第一“一”位已固定为0)。

**关键词**: IP地址 网络号 主机号 A类地址 B类地址 C类地址 D类地址 E类地址


### 关键词提取 - 分块 15
但要注意，第，网络号为全0的IP地叮有特殊的用途，它表示本网络；第二，网络号为127（即（）1111111)保留作为本地软件环回测试(loopbacktest)本主机的进程之间的通信之一用。若主机发送个目的地址为环回地址（例如127.0.0.l)的JP数据报，则本主机中的协议软件就处理数据报中的数据，而不会把数据报发送到任何网络。因此A类地址可指派的7网络号是126个（即2
”“—2)。
一A类地址的主机号占3个字节。但全0和全l的主机号般不指派。全0的主机号表示该IP地址是本主机所连接到的单个网络地址（例如，若主机的IP地址为5.6.7.8“主机所在的网络的网络号是5,而该网络的网络地址就是5.0.0.0)。全］表示一所有的＂,则该
24
，因此全1的主机号字段表示该网络上的所有主机。因此每个A类网络中的最大主机数是2-2,即16777214。
B类地址的网络号字段有2个字节。因此B类地址可指派的网络数为2一1614，即16384。B类地址的每个网络上的最大主机数是2-2，即65534。这里需要减2是因为要扣除全0和全l的主机号。
218

**关键词**: 网络号 IP地址 环回测试 本机进程通信 A类地址 B类地址 网络地址 主机数


### 关键词提取 - 分块 16
218
C类地址有3个字节的网络号字段。因此C类地址可指派的网络总数是2一'即2097152。每个C类地址的最大主机数是2-2，即254。
本书的前几个版本曾提到，B类地址中的网络地址128.0.0.0和C类地址中的网络地址192.0.0.0都是规定不指派的。但现在这两个网络地址都已经可以指派了[RFC6890]。
一表4-2给出了般不指派的特殊IP地址，这些地址只能在特定的情况下使用。
网络号。。
。
主机号令l
y
1
27X
全1
全l
非全0或全1的任何数表4-2一般不指派的特殊IP地址源地址使用
可以
可以
不可
不可
1-1
［以目的地址使用
个可
不可
可以
可LA
司以代表的意思DHCP协议）在本网络上的本主机（见66节
在本网络上主机号为X的主机
只在本网络上进行广播（各路由器均不转发）
对网络号为Y的网络上的所有主机进行广播

**关键词**: C类地址 网络号字段 网络总数 B类地址 网络地址128.0.0.0 C类地址 网络地址192.0.0.0 RFC6890 特殊IP地址 源地址使用 目的地址使用 主机号为X的主机 广播 网络号为Y的网络


### 关键词提取 - 分块 17
只在本网络上进行广播（各路由器均不转发）
对网络号为Y的网络上的所有主机进行广播
用千本地软件环回测试这里要指出，由于近年来已经广泛使用无分类IP地址进行路由选择，A类、B类和C•124•类这种分类地址已成为历史[RFC1812]。由千很多文献和资料现在都仍然引用传统的分类的IP地址，因此我们对分类的IP地址还要进行简单的叙述。
把IP地址划分为A类、B类、C类三个类别，当初是这样考虑的：各种网络的差异很大，有的网络拥有很多主机，而有的网络上的主机则很少。把IP地址划分为A类、B类和C类是为了更好地满足不同用户的需求。
这种分类的IP地址由千网络号的位数是固定的，因此管理简单、使用方便、转发分组迅速，完全可以满足当时互联网在美国的科研需求。后来，为了更加灵活地使用IP地址，一出现了划分子网的方法，在IP地址的主机号中，插入个子网号，把两级的IP地址变为三级的IP地址。但是，谁也没有预料到，互联网在20世纪90年代突然迅速地发展起来了。

**关键词**: 广播 路由器 无分类IP地址 A类 B类 C类 网络号 主机 传统分类的IP地址 分类地址 本地软件环回测试 子网号 转发分组


### 关键词提取 - 分块 18
互联网从美国专用的科研实验网演变到世界范围开放的商用网！互联网用户的猛增，使得IP地址的数量面临枯竭的危险。这时，人们才注意到原来分类的IP地址在设计上确实有很
个A类网络地址块的主机号数目超过了1677万个！当初美国的很不合理的地方。例如，一一多大学都可以分配到个A类网络地址块。一个大学怎么会需要这样多的IP地址？但在互
联网出现早期，人们就是认为IP地址是用不完的，不需要精打细算地分配。又如，一个C类网络地址块可指派的主机号只有254个。但不少单位需要有300个以上的IP地址，那么一干脆申请个B类网络地址块（可以指派的主机号有65534个），宁可多要些IP地址，把多余的地址保留以后慢慢用。这样就浪费了不少的地址资源。即使后来采用了划分子网的方法，也无法解决IP地址枯竭的问题千是，在20世纪90年代，当发现IP地址在不久后将会枯竭时，一种新的无分类编址方法就问世了。这种方法虽然也无法解决IP地址枯竭的问题，但可以推迟IP地址用尽的日一子。下节就介绍现在已普遍采用的这种编址方法。
3.无分类编址CIDR二勹厂言言勹厂勹c路Routi(1)网络前缀

**关键词**: 互联网 IP地址 分类的IP地址 A类网络地址块 C类网络地址块 B类网络地址块 划分子网方法 无分类编址方法 CIDR


### 关键词提取 - 分块 19
3.无分类编址CIDR二勹厂言言勹厂勹c路Routi(1)网络前缀
CIDR把图4-9中的网络号改称为尸言言勹尸勹4?3“r网络前缀"(netwok-prefix)（或简称为前缀"),用来指明网络，剩下的后面部分仍然是主机号，用来指明主机。在有些文献中也把主机号字段称为后缀(suffix)。CIDR的记法是：＝＜＜IP地址：：｛网络前缀＞，主机号＞｝(4-2)“““＂图4-11说明了CIDR的网络前缀和主机号的位置。看起来，这和图4-9也没有什么不
。其实不然。这里最大的区别就是网络前缀的位网络前缀网络号换成为同，只是把数n不是固定的数，而是可以在0~32之间选取任意的值。
32位IP地址|网络前缀l-n位主机号
l

**关键词**: 无分类编址CIDR 网络前缀 主机号 后缀


### 关键词提取 - 分块 20
32位IP地址|网络前缀l-n位主机号
l
(32-n)位一一一图4-11CIDR表示的IP地址＂”CIDR使用斜线记法(slashnotation)，或称为CIDR记法，即在IP地址后面加上斜•125•回芯妒粗-Domain兽磨r视肺讲娇“�”一线I"，斜线后面是网络前缀所占的位数。例如，CIDR表示的个IP地址128.14.35.7/20,二进制IP地址的前20位是网络前缀（相当于原来的网络号），剩下后面12位是主机号。
(2)地址块
CIDR把网络前缀都相同的所有连续的IP地址组成一“＂一个CIDR地址块。

**关键词**: 32位IP地址 网络前缀 主机号 CIDR表示 CIDR记法 CIDR地址块


### 关键词提取 - 分块 21
(2)地址块
CIDR把网络前缀都相同的所有连续的IP地址组成一“＂一个CIDR地址块。
个CIDR一地址块包含的IP地址数目，取决千网络前缀的位数。我们只要知道CIDR地址块中的任何个地址，就可以知道这个地址块的起始地址（即最小地址）和最大地址，以及地址块中的一地址数。例如，已知IP地址128.14.35.7/20是某CIDR地址块中的个地址，现在把它写成二进制表示形式，其中的前20位是网络前缀（用粗体和下划线表示出），而前缀后面的12位是主机号：128.14.35.7/20=100__0__0_000___0__0__0__0_0010001100000111可以很方便地得出这个地址所在的地址块中的最小地址和最大地址：10000000000011100010000000000000最小地址最大地址112814320
128.14.47.255110000000000011100010111111111111这个地址块的IP地址共有2一址）后，可指派的地址数是2122个，扣除主机号为全0和全l的地址（最小地址和最大地

**关键词**: CIDR 地址块 网络前缀 IP地址 主机号


### 关键词提取 - 分块 22
-2个。我们常使用地址块中的最小地址和网络前缀的位数指明个地址块（不必每次都减2算出可指派的地址数，这样做太麻烦）。显然，上面导出的最小地址并不是该地址块128.14.32.0/20的网络地址。
也可以用二进制代码简要地表示此地址块：10000000000011100010*。这里的星号＊代表了主机号字段的所有的0。星号前的二进制代码的个数，就是网络前缀的位数。
“”在不需要指明网络地址时，也可把这样的地址块简称为/20地址块。
请读者注意：128.14.32.7是IP地址，但未指明网络前缀长度，因此不知道网络地址是什么。
128.14.32.7/20也是IP地址，但同时指明了网络前缀为20位，由此可导出网络地址。
.14.32.0/20是包含多个IP地址的地址块或网络前缀，或更简单些，就称为前缀，同
时也是这个地址块中主机号为全0的地址。请注意，上面地址块中4段十进制数字最后的O128有时可以省略，即简写为128.14.32/20。
一.14.32.0来指明个网络地址，因为无法知道网络前缀是多少。例如一我们不能仅用128
.14.32.0/19或128128

**关键词**: 计算机网络 地址块 网络前缀 IP地址 二进制代码 主机号字段 网络地址 十进制数字


### 关键词提取 - 分块 23
.14.32.0/19或128128
派的IP地址（如果网络前缀的位数不超过18)。
.14.32.0/21,也都是有效的网络地址。128.14.32.0也可能是个可以指早期使用分类的IP地址时，A类网络的前缀是8位，B类网络的前缀是16位，而C类
一网络的前缀是24位，都是固定值，因此不需要重复指明其网络前缀。例如在使用分类地址时，看15.3.4.5就知道是个A类地址，其网络地址为15.0.0.0。但在使用CIDR记法时，
一个很小的地址块15.3.4.4/30中的、不属于任何类别的15.3.4.5/30则是一一总之，无分类编址CIDR具有很多优点，但一定要记住，采用CIDR后，仅从斜线左边一扫个IP地址。
扫的IP地址已无法知道其网络地址了。在这点上，原来的分类地址还是比较方便的。
｀心勹勹戌记法可以让我们知道网络前缀的数值。但是计算机看不售兽视频讲解匣芯妇见斜线记法，而是使用二进制来进行各种计算时就必须使用32位的地址掩•126•码(addressmask)能够从IP地址迅速算出网络地址。
地址掩码（常简称为掩码）由一连串l和接着的一连串0组成，而l的个数就是网络

**关键词**: 计算机网络 IP地址 CIDR记法 分类地址 地址掩码


### 关键词提取 - 分块 24
地址掩码（常简称为掩码）由一连串l和接着的一连串0组成，而l的个数就是网络
前缀的长度。地址掩码又称为子网掩码气在CIDR记法中，斜线后面的数字就是地址掩码
中1的个数。例如，
连续的1和接着的12个连续的0)。这个掩码用CIDR记法表示就是255.255.240.0/20。
／20地址块的地址掩码是：11111111111111111111000000000000C20个对于早期使用的分类IP地址，其地址掩码是固定的，常常不用专门指出。例如：
A类网络，地址掩码为255.0.0.0或255.0.0.0/8。
B类网络，地址掩码为255.255.0.0或255.255.0.0/16。
C类网络，地址掩码为255.255.255.0或255.255.255.0/24。
把二进制的IP地址和地址掩码进行按位AND运算，即可得出网络地址。图4-12说明
了AND运算的过程。AND运算就是逻辑乘法运算，其规则是：1ANDI=1,1ANDO=O,
0ANDO=0。点分十进制的IP地址是128.14.35.7/20,前缀长度是20（见图中的灰色背景）。

**关键词**: 地址掩码 子网掩码 CIDR记法 网络地址


### 关键词提取 - 分块 25
请注意，从点分十进制的IP地址并不容易看出其网络地址。要使用二进制地址来运算。在本例中把二进制IP地址的前20位保留不变，剩下的12位全写为0,即可得出网络地址。
二进制lP地址地址掩码
按位AND运算
网络地址.14128.
10000000000011100010001100000111
11111111111111111111000000000000357.10000000000011100010000000000000
.12814320../20•前缀20位——一图4-12从IP地址算出网络地址从上面的运算结果可以知道，IP地址128.14.35.7/20所在的网络地址是128.14.32.0/20。
表4-3给出了最常用的CIDR地址块。表中的K表示2”即1024。网络前缀长度在13到27之间是最常用的。在“包含的地址数”中把全l和全0的主机号都计算在内了。

**关键词**: 计算机网络 二进制地址 IP地址 按位AND运算 网络地址 CIDR地址块 包含的地址数


### 关键词提取 - 分块 26
网络前缀长度/13/14/]5/16/17/18/19/20/21/22/23点分十进制255248002552520025525400255255002552551280255255192025525522402552552400255255248025525525202552552540表4-3常用的CIDR地址块包含的地址数512K256K128K64K32K16K8k4K2KIK512相当千包含分的网络数类8个B类或2048个C类4个B类或1024个C类2个B类或512个C类l个B类或256个C类128个C类64个C类32个C类16个C类8个C类4个C类2个C类＄注：子网(subnet或subnetwork)是很常用的一个名词。某个网络的一部分就可以称为其子网。一个网络对整个互联网来说，就可以看成是一个子网。在本书中，“子网”和“网络“常常被认为是同义词，经常混用。

**关键词**: 计算机网络 网络前缀长度 CIDR地址块 子网 网络


### 关键词提取 - 分块 27
•127•网络前缀长度点分十进制包含的地址数相当于包含分类的网络数续表/24/25/26/272552552550255255.2551282552552551922552552552242561286432CIDR地址中还有三个特殊地址块，即：1个C类1/2个C类1/4个C类1/8个C类一(1)前缀n=32，即32位IP地址都是前缀，没有主机号。这其实就是个IP地址。这个特殊地址用于主机路由（见4.3.2节）。
(2)前缀n=31,这个地址块中只有两个IP地址，其主机号分别为0和l。这个地址块用千点对点链路（见后面的第4小节）。
=(3)前缀nO同时IP地址也是全O,即0.0.0.0/0。这用于默认路由（见4.3.2节）。
一一从表4-3可看出，每个CIDR地址块中的地址数一”定是2的整数次幕。除最后几行外，CIDR地址块都包含了多个C类地址（是
一有时称CIDR编址为构造超网。
“”个C类地址的2倍，n是整数），因此在文献中使用CIDR的一

**关键词**: 网络前缀长度 点分十进制 包含的地址数 分类的网络数 CIDR地址 特殊地址块 C类1/2个C类1/4个C类1/8个C类 主机路由 点对点链路 默认路由 CIDR编址 构造超网


### 关键词提取 - 分块 28
一有时称CIDR编址为构造超网。
“”个C类地址的2倍，n是整数），因此在文献中使用CIDR的一
个好处就是可以更加有效地分配IP地址空间，可根据客户的需要分配适当大小的CIDR地址块。然而在使用分类地址时，向个部门分配IP地址，就只能以／8,/16或／24为单位来分配。这显然是很不灵活的。
一的一个大的CIDR地址块中往往包含很多小地址块，所以在路由器的转发表中就利用较大个CIDR地址块来代替许多较小的地址块。这种方法称为路由聚合(routeaggregation),
个项目就可以表示原来传统分类地址的很多个（例如上千个）路由项它使得转发表中只用一目，因而大大压缩了转发表所占的空间，减少了查找转发表所需的时间。

**关键词**: CIDR编址 构造超网 C类地址 IP地址空间 分类地址 路由器 转发表 路由聚合 routeaggregation


### 关键词提取 - 分块 29
图4-13给出的是CIDR地址块灵活分配的例子。假定某ISP已拥有地址块206.0.64.0/18一（相当千有64个C类网络）。现在某大学需要800个IP地址。ISP可以给该大学分配10个地址块206.0.68.0/22,它包括1024（即2)个IP地址，相当千4个连续的C类／24地址块，占该ISP拥有的地址空间的1/16。这个大学可灵活地对本校各系继续分配地址块，而各系还可再划分本系各教研室的小地址块。CIDR的地址块的地址范围有时不易看清，这是因为网络前缀和主机号的界限不是恰好出现在整数字节处。但只要写出地址的二进制表示，弄清网络前缀的位数，就能够知道地址块的范围。
图4-13表示这个ISP共拥有64个C类网络。如果不采用CIDR技术，则在与该ISP的一一一路由器交换路由信息的每一个路由器的转发表中，就需要有64行，每一行指出了到哪个一
网络的下
一

**关键词**: 计算机网络 ISP CIDR地址块 IP地址 地址空间 路由信息 转发表


### 关键词提取 - 分块 30
网络的下
一
块的下跳。但采用地址聚合后，在转发表中只需要用行来指出到206.0.64.0/18地址跳。这个大学共有4个系。在ISP内的路由器的转发表中，也仅需用206.0.68.0/22这个项目，就能把外部发送到这个大学各系的所有分组，都转发到大学的路由器。这个路一由器好比是大学的收发室。凡寄给大学任何个系的邮件，邮递员都不必送到大学的各个系，一而是把这些邮件集中投递到大学的收发室，然后由大学的收发室再进行下步的分发。这样就加快了邮递员的投递工作（相当于缩短了转发表的查找时间）。
从图4-13的表格中可看出，网络前缀越短的地址块所包含的地址数就越多。
•128•一系二系地址块单位
ISP206.0.640/18
大学206068.0/22
一系206.0.68.0/23
二系206.0.70.0/24
三系206.0.71.0/25
四系206.071128/25二进制表示的地址块110011100000000001*
1100I110000000000I0001*
不
11001110000000000l00010
11001110000000000I000110*

**关键词**: 网络 路由器 转发表 地址聚合 ISP 大学 收发室 邮递员 二进制表示 地址块 前缀


### 关键词提取 - 分块 31
11001110000000000l00010
11001110000000000I000110*
1I001110000000000I0001110*
1100I110000000000I0001111*相当千C类网络数
64
4
2
I
1/2
1/2一表中星号＊是
种常
用的简写方式，衣
示星号后面的二进
制主机号都省略了图4-13ClDR地址块划分举例4.IP地址的特点一一
IP地址具有以下
(1)每些重要特点。
一个IP地址都由网络前缀和主机号l历部分组成。从这个意义上说，IP地址是一种分等级的地址结构。分两个等级的好处是：第一，IP地址管理机构在分配IP地址时只分配网络前缀（第级），而剩下的主机号（第勹级）则由得到该网络前缀的单位自行分配。
这样就方便了IP地址的管理；第二，路由器根据目的主机所连接的网络前缀（即地址块）来转发分组（而不考虑目的主机号），这样就可以使转发表中的项目数大幅度减少，从而减少转发表所占的存储空间，缩短查找转发表的时间。

**关键词**: 计算机网络 IP地址 网络前缀 主机号 路由器 转发分组 转发表 存储空间 查找转发表时间 C类网络数


### 关键词提取 - 分块 32
一一一(2)实际上IP地址是标志台主机（或路山器）和条链路的接口。当台主机同时连接到两个网络上时，该主机就必须同时具有两个相应的IP地址，其网络前缀必须是不同的。
一一这种主机称为多归属主机(multihomedhost)。由千一个路由器至少应当连接到两个网络，因此个路由器至少应当有两个不同的IP地址。这好比个建筑正好处在北京路和上淘路的交叉口上，那么这个建筑就可以拥有两个门牌号码。例如，北京路4号和上海路37号。
一(3)按照互联网的观点，个网络（或子网）是拒具有相同网络前缀的主机的集合，因—此，用转发器或交换机连接起来的若干个局域网仍为个网络，因为这些局域网都具有同样的网络前缀。具有不同网络前缀的局域网必须使用路由器进行互连。
(4)在IP地址中，所有分配到网络前缀的网络（不管是范围很小的局域网，还是可能覆一盖很大地理范围的广域网）都是平等的。所谓平等，是指互联网同等对待每
123个IP地址。
1图4-14画出了三个局域网(LAN一,LAN
2和LAN连构成的个互连网络。其中局域网LAN一是由两个网段通过以太网交换机互连的。图中的)通过三个路由器(R

**关键词**: IP地址 主机 路山器 接口 多归属主机 multihomedhost 路由器 网络前缀 互联网 局域网 LAN 广域网 以太网交换机 路由器


### 关键词提取 - 分块 33
一，民和R3)互小圆圈表示需要有个IP地址。这是为了强调，IP地址是标志个主机连接在网络上的接口。如果我们把某条连接线断开，那么相应的IP地址也就不存在了。但通常为了方便，这•129•样的小圆圈可以不必画出。
LAN1＇，口，z,1z'2.－＿-i.-
ll?-i\\、三网络地址IP
一1一一、、、一1地址LAN3
-＿l、.1.1.16/29�.1.1.27kkll.l.l9＼二;:1124/31
·_＿～1I
L－ll勹lll3-N31.1.1.28/31八2产歹三谥乡以太网交换机－－－-IJ28病玄，等众，3-:l.lll.｝路由器＇,,'＝＝z＼/z1气/',/＼[t1,＇',图4-14需要IP地址的地方用小圆圈表示我们应当注意到：
•在同一个局域网上的主机或路由器的IP地址中的网络前缀必须是同样的，即必须具有同样的网络号。
•图中的网络地址（用粗体字加下画线表示）里面的主机号必定是全0。例如，LAN1
的网络地址1.1.1.0/29=00000001000000010000000100000000,在二进制表示的IP

**关键词**: 计算机网络 局域网 IP地址 网络前缀 网络号 主机号


### 关键词提取 - 分块 34
地址中，前29位有下画线的数字是网络前缀，最后3位为主机号，是全0。
•图4-14中的所有设备都有自己的MAC地址（都未画出）。请注意，图中以太网交
换机连线上画出的小圆圈，是主机或路由器的IP地址，并不是以太网交换机的IP地址。以太网交换机是链路层设备，只有MAC地址。
•用以太网交换机（它只在链路层工作）连接的几个网段合起来仍然是一个局域网，只使用同样的网络前缀，例如LAN沪•路由器总是具有两个或两个以上的IP地址。即路由器每个接口的IP地址的网络前缀都不同。
•当两个路由器直接相连时（例如通过一条租用线路），在连线两端的接口处，可以
分配也可以不分配IP地址。如分配了IP地址，则这一段连线就构成了一种只包含
一段线路的特殊“网络＂（如图中的N1,N2和N3)。之所以叫作“网络“，是因为
它有IP地址。这种网络仅需两个IP地址，因此这里就使用了／31地址块。这种地
址块专门为点对点链路的两端使用[RFC3021]，主机号（只有1位）可以是0或l。
但为了节省IP地址资源，对千点对点链路构成的特殊“网络＂，现在也常常不分配

**关键词**: 计算机网络 MAC地址 IP地址 以太网交换机 路由器 局域网 网络前缀 链路层 特殊“网络” 点对点链路 /31地址块


### 关键词提取 - 分块 35
但为了节省IP地址资源，对千点对点链路构成的特殊“网络＂，现在也常常不分配
IP地址。通常把这样的特殊网络叫作无编号网络(unnumberednetwork)或匿名网络
(anonymousnetwork)[COME06]。
4.2.3IP地址与MAC地址在学习IP地址时，很重要的一点就是要弄懂主机的IP地址与MAC地
址的区别。在局域网中，由于MAC地址已固化在网卡上的ROM中，因此常常将MAC地址称为硬件地址或物理地址。在本书中，物理地址、硬件地视频讲解•130•址和MAC地址常常作为同义词出现。物理地址的反义词就是虚拟地址、软件地址或逻辑地
址，IP地址就属于这类地址。
图4-15说明了这两种地址的区别。从层次的角度看，MAC地址是数据链路层使用的地
址，而IP地址是网络层和以上各层使用的地址，是一种逻辑地址（称IP地址为逻辑地址是因为IP地址是用软件实现的）。
应用层数据I
IP地址I�———TCP报文�1首部1厅音旷
;,部IIP数据报MAC帧I
，｝网络层及以上
使用IP地址

**关键词**: 无编号网络 匿名网络 MAC地址 物理地址 虚拟地址 逻辑地址 数据链路层 网络层 IP地址


### 关键词提取 - 分块 36
;,部IIP数据报MAC帧I
，｝网络层及以上
使用IP地址
一一一---－-－－－－－－－-－－－－－－一一一一一一一一--一I尾部1数据链路层使用MAC地址图4-15IP地址与MAC地址的区别在发送数据时，数据从高层下到低层，然后才到通信链路上传输。使用IP地址的IP数
据报一旦交给数据链路层，就被封装成MAC帧。MAC帧在传送时使用的源地址和目的地
址都是MAC地址，这两个MAC地址都写在MAC帧的首部中。
连接在通信链路上的设备（主机或路由器）在收到MAC帧时，根据MAC帧首部中的
MAC地址决定收下或丢弃。只有在剥去MAC帧的首部和尾部后把MAC层的数据上交给
网络层后，网络层才能在IP数据报的首部中找到源IP地址和目的IP地址。
总之，IP地址放在IP数据报的首部，而MAC地址则放在MAC帧的首部。在网络层和网络层以上使用的是IP地址，而数据链路层及以下使用的是MAC地址。在图4-15中，
当IP数据报插入到数据链路层的MAC帧以后，整个的IP数据报就成为MAC帧的数据，
因而在数据链路层看不见数据报的IP地址。

**关键词**: 部IIP数据报 MAC帧 网络层 IP地址 MAC地址 通信链路 数据链路层 首部 尾部 主机 路由器 剥去 上交 IP数据报 MAC帧数据


### 关键词提取 - 分块 37
因而在数据链路层看不见数据报的IP地址。
图4-16(a)画的是三个局域网用两个路由器R1和民互连起来。现在主机凡要和主机H2通信。这两台主机的IP地址分别是IP1和IP2,而它们的MAC地址分别为MAC1和MAC扣
一经过凡转发一再经过凡转发-H2。路由器R1因同时连接到两个局域通信的路径是：H1网上，因此它有两个MAC地址，即MAC3和MAC4。同理，路由器民也有两个MAC地址
MAC扛0MAC妒图4-16(b)特别强调了IP地址与MAC地址所使用的位置的不同。表4-4归纳了这种区别。
表4-4图4-16(b)中不同层次、不同区间的源地址和目的地址在网络层在数据链路层写入IP数据报首部的地址写入MAC帧首部的地址源地址目的地址从凡到R1从凡到R2从民到H2IP1IP1IP1IP2IP2IP2源地址MAC1MAC4MAC6目的地址MAC3MAC5MAC2•131•主IPlF二二
一、三c,路由器RI路由器R2MA亿MAC5I`-严|MAC(局坡网—(a)网络配置主机H2[P2I
b-I局坡网:l'J\ll甘1到IP2由器R1厂二尸产：路由器R2
勹
-－－－－－－芷
芷.4

**关键词**: 数据链路层 局域网 IP地址 MAC地址 路由器 IP数据报 MAC帧 网络层 数据链路层 源地址 目的地址


### 关键词提取 - 分块 38
b-I局坡网:l'J\ll甘1到IP2由器R1厂二尸产：路由器R2
勹
-－－－－－－芷
芷.4
示--------IP层上的虑拟互联网三MAC尸三MAC帧MAC帧MAC帧(b)不同层次、不同区间的脱地址和目的地址图4-16从不同层次上看IP地址和MAC地址这里要强调指出以下几点：]
(1)在IP层抽象的互联网上只能看到IP数据报。虽然IP数据报要经过路由器R2和R的两次转发，但在它的首部中的源地址和目的地址始终分别是IP21“。图中的数据报上21
和IP写的从IP到IP”就表示前者是源地址而后者是目的地址。数据报中间经过的两个路由器的IP地址并不出现在IP数据报的首部中。
(2)虽然在IP数据报首部有源站IP地址，但路由器只根据目的站的IP地址进行转发。
(3)在局域网的链路层，只能看见MAC帧。IP数据报被封装在MAC帧中。MAC帧

**关键词**: 路由器 IP地址 MAC帧 IP数据报 局域网


### 关键词提取 - 分块 39
(3)在局域网的链路层，只能看见MAC帧。IP数据报被封装在MAC帧中。MAC帧
在不同网络上传送时，其MAC帧首部中的源地址和目的地址要发生变化，如图4-16(b)所1示。开始在凡到凡间传送时，MAC帧首部中写的是从MAC地址MAC3发送到MAC地址MAC,路由器凡收到此MAC帧后，在数据链路层，要剥去原来的MAC帧的首部和尾部，）在转发时，在数据链路层，要重新添加上MAC帧的首部和尾部。这时首部中的源地址和目45的地址分别变成为MAC和MAC。路山器民收到此帧后，再次更换MAC帧的首部和尾6和MAC2
。MAC帧的首部的这种变化，部，首部中的源地址和目的地址分别变成为MAC在上面的IP层上是看不见的。
一(4)尽管互连在起的网络的MAC地址体系各不相同，但IP层抽象的互联网却屏蔽了下层这些很复杂的细节。只要我们在网络层上讨论问题，就能够使用统一的、抽象的IP地址研究主机和主机或路由器之间的通信。
以上这些概念是计算机网络的精髓所在，对这些重要概念务必仔细思考和掌握。
细心的读者会发现，还有两个重要问题没有解决：(1)主机或路由器怎样知道应当在MAC帧的首部填入什么样的MAC地址？

**关键词**: 局域网 链路层 MAC帧 IP数据报 源地址 目的地址 MAC地址 路由器 数据链路层 IP层 互联网 主机 通信


### 关键词提取 - 分块 40
(2)路由器中的转发表是怎样得出的？
•132•第一个问题就是下一节所要讲的内容，而第二个问题将在后面的4.5节详细讨论。
4.2.4地址解析协议ARP在实际应用中，我们经常会遇到这样的问题：已经知道了一个机器
（主机或路由器）的IP地址，需要找出其相应的MAC地址。地址解析协
议ARP[RFC826,STD37]就是用来解决这样的问题的。图4-17说明了协议
ARP的作用。
视频讲解荨三1P．网络层．MAC地址IARP请求或回答分组I发送仁4太网首部数据1FCS|
ARP分组封装在以太网中图4-17协议ARP的作用还有一个旧的协议叫作逆地址解析协议RARP,它的作用是使只知道自己MAC地址的
主机能够通过协议RARP找出其IP地址。现在的协议DHCP（见第6章的6.6节）已经包
含了协议RARP的功能。因此本书不再介绍协议RARP。
下面就介绍协议ARP的要点。
我们知道，网络层使用的是IP地址，但在实际网络的链路上传送数据帧时，最终还是
必须使用链路层的MAC地址。IP地址和下面链路层的MAC地址之间由于格式不同而不存

**关键词**: 地址解析协议ARP 逆地址解析协议RARP 动态主机配置协议DHCP


### 关键词提取 - 分块 41
必须使用链路层的MAC地址。IP地址和下面链路层的MAC地址之间由于格式不同而不存
在简单的映射关系（例如，IP地址有32位，而链路层的MAC地址是48位）。此外，在一
个网络上可能经常会有新的主机加入进来，或撤走一些主机。更换网络适配器也会使主机的
MAC地址改变（请注意，主机的MAC地址实际上就是其网络适配器的MAC地址）。地址
解析协议ARP解决这个问题的方法是在主机的ARP高速缓存中存放一个从IP地址到MAC
地址的映射表，并且这个映射表还经常动态更新（新增或超时删除）。
每一台主机都设有一个ARP高速缓存(ARPcache)，里面存有本局域网上的各主机和路
由器的IP地址到MAC地址的映射表，这些都是该主机目前知道的一些MAC地址。那么主
机怎样知道这些MAC地址呢？我们可以通过下面的例子来说明。
当主机A要向本局域网上的某台主机B发送IP数据报时，就先在其ARP高速缓存中
查看有无主机B的IP地址。如有，就在ARP高速缓存中查出其对应的MAC地址，再把这
个MAC地址写入MAC帧，然后通过局域网把该MAC帧发往此MAC地址。

**关键词**: 链路层 MAC地址 IP地址 ARP 高速缓存 ARP高速缓存 局域网 MAC帧


### 关键词提取 - 分块 42
个MAC地址写入MAC帧，然后通过局域网把该MAC帧发往此MAC地址。
也有可能查不到主机B的IP地址。这可能是主机B才入网，也可能是主机A刚刚加电，
其高速缓存还是空的。在这种情况下，主机A就自动运行ARP,然后按以下步骤找出主机
B的MAC地址。
(1)ARP进程在本局域网上广播发送一个ARP请求分组（具体格式可参阅[COME06]的
第23章）。图4-l8(a)是主机A广播发送ARP请求分组的示意图。ARP请求分组的主要内
容是：“我的IP地址是209.0.0.5,MAC地址是00-00-CO-l5-AD-l8。我想知道IP地址为
209.0.0.6的主机的MAC地址。”(2)在本局域网上的所有主机上运行的ARP进程都收到此ARP请求分组。
•133•(3)主机B的IP地址与ARP请求分组中要查询的IP地址一致，就收下这个ARP请求
分组，并向主机A发送ARP响应分组，同时在这个ARP响应分组中写入自己的MAC地址。
由于其余所有主机的IP地址都与ARP请求分组中要查询的IP地址不一致，因此都不理睬这

**关键词**: MAC地址 MAC帧 局域网 ARP IP地址 主机B 高速缓存 ARP请求分组 ARP响应分组 MAC地址 广播发送 ARP进程 本局域网 ARP请求分组 IP地址 主机A ARP响应分组 自己的MAC地址


### 关键词提取 - 分块 43
由于其余所有主机的IP地址都与ARP请求分组中要查询的IP地址不一致，因此都不理睬这
个ARP请求分组，如图4-18(b)所示。ARP响应分组的主要内容是：“我的IP地址是209.0.0.6,
我的MAC地址是08-00-2B-OO-EE-OA。”请注意：虽然ARP请求分组是广播发送的，但ARP
响应分组是普通的单播，即从一个源地址发送到一个目的地址。
我的IP地址是209.0.0.5,MAC地址是00-00-C0-15-AD-18。
我想知道主机209.0.0.6的MAC地址。
00-00-CO-l5-AD-l8(a)主机A广播发送ARP请求分组我的IP地址是209.0.0.6,MAC地址是08-00-2B-OO-EE-OA。
z08-00-2B-OO-EE-OA(b)主机B向A发送ARP响应分组图4-18地址解析协议ARP的工作原理(4)主机A收到主机B的ARP响应分组后，就在其ARP高速缓存中写入主机B的IP地址到MAC地址的映射。
当主机A向B发送数据报时，很可能以后不久主机B还要向A发送数据报，因而主机

**关键词**: ARP IP地址 MAC地址 ARP请求分组 ARP响应分组 广播 单播 高速缓存


### 关键词提取 - 分块 44
当主机A向B发送数据报时，很可能以后不久主机B还要向A发送数据报，因而主机
B也可能要向A发送ARP请求分组。为了减少网络上的通信最，主机A在发送其ARP请
求分组时，就把自己的IP地址到MAC地址的映射写入ARP请求分组。当主机B收到A的
ARP请求分组时，就把主机A的这一地址映射写入主机B自己的ARP高速缓存中。以后
主机B向A发送数据报时就很方便了。
可见ARP高速缓存非常有用。如果不使用ARP高速缓存，那么任何一台主机只要进行
一次通信，就必须在网络上用广播方式发送ARP请求分组，这就会使网络上的通信量大大
增加。ARP把已经得到的地址映射保存在高速缓存中，这样就使得该主机下次再和具有同
样目的地址的主机通信时，可以直接从高速缓存中找到所需的MAC地址而不必再用广播方式发送ARP请求分组。
ARP对保存在高速缓存中的每一个映射地址项目都设置生存时间（例如，10~20分
钟）。凡超过生存时间的项目就从高速缓存中删除掉。设置这种地址映射项目的生存时间是
很重要的。设想有一种情况：主机A和B通信。A的ARP高速缓存里保存有B的MAC地

**关键词**: 计算机网络 ARP请求分组 ARP高速缓存 MAC地址 IP地址 通信量 生存时间


### 关键词提取 - 分块 45
很重要的。设想有一种情况：主机A和B通信。A的ARP高速缓存里保存有B的MAC地
址，但B的网络适配器突然坏了，B立即更换了一块，因此B的MAC地址就改变了。假•134•定A还要和B继续通信。A在其ARP高速缓存中查找到B原先的MAC地址，并使用该
MAC地址向B发送数据帧。但B原先的MAC地址已经失效了，因此A无法找到主机B。
一但是过了段不长的生存时间，A的ARP高速缓存中已经删除了B原先的MAC地址，于是A重新广播发送ARP请求分组，又找到了B。
一请注意，ARP用于解决同个局域网上的主机或路由器的IP地址和MAC地址的映射一一
问题。如果所要找的主机和源主机不在同个局域网上，例如，在前面的图4-16中，主机凡就无法解析出另个局域网上主机压的MAC地址（实际上主机儿也不需要知道远程主一机压的MAC地址）。主机凡发送给压的IP数据报首先需要通过与主机凡连接在同1个局域网上的路由器凡来转发，因此主机凡必须知道路由器R331的IP地址。于是儿使用]ARP把路由器R的IP地址IP解析为MAC地址MAC

**关键词**: 主机A 主机B ARP高速缓存 MAC地址 ARP请求分组 局域网 路由器 IP数据报 ARP解析


### 关键词提取 - 分块 46
2,然后把IP数据报传送到路由器Ro以后，凡从转发表知道应把IP数据报转发到路由器R25,再使用ARP解析出民的MAC地址MAC，把IP数据报转发到路由器R。路由器民用同样方法解析出目的主机儿的MAC2沪地址MAC,使IP数据报最终交付主机H从IP地址到MAC地址的解析是自动进行的，主机的用户对这种地址解析过程是不知一道的。只要主机或路由器要和本网络上的另个已知IP地址的主机或路由器进行通信，协议ARP就会自动地把这个IP地址解析为链路层所需要的MAC地址，然后插入到MAC帧中。
下面我们归纳出使用ARP的四种典型情况（如图4-19所示）。
HHIH2R13鲤R2N,-o-｀已尸N2-N3图4-19使用ARP的四种典型情况1一一(1)发送方是主机（如H)，要把IP数据报发送到同1这时凡发送ARP请求分组（在网络N1上广播），找到目的主机H个网络上的另
2
一
一
的MAC地址。
台主机（如H2)。
(2)发送方是主机（如H)，要把IP数据报发送到另1一

**关键词**: IP数据报 路由器Ro 路由器R25 ARP解析 MAC地址 主机H 链路层 IP地址 主机或路由器 通信 ARP请求分组 N1网络 目的主机H2


### 关键词提取 - 分块 47
一
一
的MAC地址。
台主机（如H2)。
(2)发送方是主机（如H)，要把IP数据报发送到另1一
个网络上的1台主机（如儿或凡）。这时凡发送ARP请求分组（在网络N)上广播），找到N上的个路由器凡的MAC地址。剩下的工作由路由器民来完成。R1要做的事情是下面的(3)或(4)。
一(3)发送方是路由器（如R)，要把IP数据报转发到与凡连接在同2个网络N2上的主机（如儿）。这时凡发送ARP请求分组（在N
一(4)发送方是路由器（如R1上广播），找到目的主机凡的MAC地址。
3一)，要把IP数据报转发到网络N台主机（如H4)。
个网络上的。这时民发送ARP请求分组（在N2上广播），找到连上的个路由器民的MAC地址。剩下的工作由这个路由器民来完成。
在许多情况下需要多次使用ARP,但这只是以上几种情况的反复使用而已。
有的读者可能会产生这样的问题：既然在网络链路上传送的帧最终是按照MAC地址找
到目的主机的，那么为什么我们还要使用两种地址(Ip地址和MAC地址），而不直接使用一MAC地址进行通信？只用个MAC地址进行通信似乎可以免除使用ARP。
这个问题必须弄清楚。

**关键词**: MAC地址 IP数据报 ARP请求分组 路由器 网络链路


### 关键词提取 - 分块 48
这个问题必须弄清楚。
由于全世界存在着各式各样的网络，它们使用不同的MAC地址。要使这些异构网络•135•一2儿与民不是连接在同
接在N上的能够互相通信就必须进行非常复杂的MAC地址转换工作，因此由用户或用户主机来完成
一
这项工作几乎是不可能的事。即使是对分布在全世界的以太网MAC地址进行寻址，也是
一极其困难的。然而IP编址把这个复杂问题解决了。连接到互联网的主机只需各自拥有个IP地址，它们之间的通信就像连接在同个网络上那样简单方便，即使必须多次调用ARP来找到MAC地址，但这个过程都是由计算机软件自动进行的，对用户来说是看不见的。
因此，在虚拟的IP网络上用IP地址进行通信给广大的计算机用户带来了很大的方便。
4.2.5IP数据报的格式IP数据报的格式说明协议IP都具有什么功能。在协议IP的标准中，描述首部格式的宽度是32位（即4字节）。图4-20是IP数据报的完整格式视频讲解[RFC791,STD5]。
位-4--+-4-f--—8

**关键词**: 计算机网络 MAC地址 IP编址 IP地址 ARP 虚拟的IP网络 协议IP数据报格式 RFC791 STD5


### 关键词提取 - 分块 49
位-4--+-4-f--—8
版本1首部长度区分服务标识16总长度片偏移标志1生存时间协议首部检验和源地址目的地址可选字段（长度可变）填充数据部分首部I数据部分-小俨．少·｀．八·`．．气·•发送在前IP数据报图4-20IP数据报的格式一从图4-20可看出，一个IP数据报由首部和数据两部分组成。首部的前一部分长度是固定的，共20字节，是所有IP数据报必须具有的。在首部的固定部分的后面是些可选字段，其长度是可变的。下面介绍首部各字段的意义。
1.IP数据报首部的固定部分中的各字段一(1)版本占4位，指协议IP的版本。通信双方使用的协议IP的版本必须致。这里讨论的协议IP版本号为4（即IPv4)。关千IPv6（即版本6的协议IP)，我们将在后面的
4.5节讨论。
(2)首部长度占4位，可表示的最大十进制数值是15。请注意，首部长度字段所表
示数的单位是32位字长(1个32位字长是4字节）。因为IP首部的固定部分是20字节，
因此首部长度字段的最小值是5（即二进制表示的首部长度是0101)。而当首部长度字段为

**关键词**: IP数据报 首部 版本 首部长度 区分服务标识 总长度 片偏移标志 生存时间 协议首部检验和 源地址 目的地址 可选字段 填充数据部分 数据部分


### 关键词提取 - 分块 50
因此首部长度字段的最小值是5（即二进制表示的首部长度是0101)。而当首部长度字段为
最大值1111时（即十进制的15)，就表明首部长度达到最大值15个32位字长，即60
字节。当IP分组的首部长度不是4字节的整数倍时，必须利用最后的填充字段加以填充。
因此IP数据报的数据部分永远在4字节的整数倍时开始，这样在实现协议IP时较为方便。
首部长度限制为60字节的缺点是有时可能不够用，但这样做是希望用户尽量减少开销。最常用的首部长度是20字节，不使用任何可选字段。
•136•(3)8一
区分服务占位，用来获得更好的服务。这个字段在旧标准中叫作服务类型，但实际上Services)直没有被使用过。1998年IETF把这个字段改名为区分服务DS(Differentiated
般的情况下都不。只有在使用区分服务时，这个字段才起作用（见8.4.4节）。在一使用这个字段[RFC2474,RFC3168(4),RFC3260]。
总长度总长度指首部和数据之和的长度，单位为字节。总长度字段为16位，6因此数据报的最大长度为i-l=65535字节。然而实际上传送这样长的数据报在现实中是极少遇到的。

**关键词**: 计算机网络 IP分组 首部长度 填充字段 IP数据报 区分服务 服务类型 总长度 RFC2474 RFC3168 RFC3260


### 关键词提取 - 分块 51
一一我们知道，在IP层下面的每种数据链路层协议都规定了一个数据帧中的数据字段的最大长度，这称为最大传送单元MTU(MaximumTransferUnit)。当一个IP数据报封装成链路层的帧时，此数据报的总长度（即首部加上数据部分）定不能超过下面的数据链路层所规定的MTU值。例如，最常用的以太网就规定其MTU值是1500字节。若所传送的数据报长度超过数据链路层的MTU值，就必须把过长的数据报进行分片处理。
一虽然使用尽可能长的IP数据报会使传输效率得到提高（这样每个IP数据报中首部长度占数据报总长度的比例就会小些），但数据报短些也有好处。IP数据报越短，路由器转发的速度就越快。为此，协议IP规定，在互联网中所有的主机和路由器必须能够接受长度不
超过576字节的数据报。这是假定上层交下来的数据长度有512字节（合理的长度），加上最长的IP首部60字节，再加上4字节的富余量，就得到576字节。当主机需要发送长度超一过576字节的数据报时，应当先了解下，目的主机能否接受所要发送的数据报长度。否则，就要进行分片。

**关键词**: 最大传送单元MTU IP数据报 数据链路层 分片处理 路由器转发 以太网 IP首部


### 关键词提取 - 分块 52
一在进行分片时（见后面的＂”“”片偏移字段），数据报首部中的总长度字段是指分片后的每个分片的首部长度与该分片的数据长度的总和。
一一(5)标识(identification)”
占16位。IP软件在存储器中维持“个计数器，每产生个数据报，计数器就加1,并将此值赋给标识字段。但这个
无连接服务，数据报不存在按序接收的问题。当数据报由于长度超过网络的MTU而必须分并不是序号，因为IP是标识片时，这个标识字段的值就被复制到所有的数据报片的标识字段中。相同的标识字段的值使分片后的各数据报片最后能正确地重装成为原来的数据报。
(6)标志(flag)占3位，但目前只有两位有意义。
•标志字段中的最低位记为MF(MoreFragment)。MF=l即表示后面
”的数据报。MF=O表示这已是若干数据报片中的最后“
个。
一一””还有分片•标志字段中间的位记为DF(Don'tFragment)，意思是不能分片。只有当DF=0时才允许分片。
(7)片偏移占13位。片偏移指出：较长的分组在分片后，某片在原分组中的相对
位置。也就是说，相对千用户数据字段的起点，该片从何处开始。片偏移以8个字节为偏移

**关键词**: 分片 数据报首部 总长度字段 分片后的每个分片 首部长度 数据长度 标识(identification) IP软件 计数器 数据报 无连接服务 按序接收 数据报片 标志(flag) MF(MoreFragment) DF(Don'tFragment) 片偏移


### 关键词提取 - 分块 53
位置。也就是说，相对千用户数据字段的起点，该片从何处开始。片偏移以8个字节为偏移
定是8字节(64位）的个数据报片外，其他每个分片的长度一一单位。这就是说，除最后
一整数倍。
个例子。
下面举
【例4-1】一个数据报的总长度为3820字节，其数据部分为3800字节长（使用固定首部），盂要分片为长度不超过1420字节的数据报片。因固定首部长度为20字节，因此每
个妏据报片的数据部分长度不能超过1400字节。于是分为3个数据报片，其数据部分的长度分别为1400,1400和1000字节。原始数据报首部被复制为各数据报片的首部，但必须修•137•改有关字段的值。图4-21给出分片后得出的结果（请注意片偏移的数值）。
共分部据数节。
。
需要分片的数据报首部｝｝｝
_,,-
',子=n-o＇，产＃廿-z，＇，夕，,＇，'夕2''2＇/1400／K
，三,二入＇上数据屾勹三二字节01399数据报片l
片偏移＝0/8=01400
数据报片2
片偏移＝1400/8=1753字。。8，;'二。
83207｀、、、、、、、、、，
，
，
 ，3首部/／
8＝偏片移、、、、、＝99、、、、,
'
,

**关键词**: 计算机网络 数据报 分片 片偏移


### 关键词提取 - 分块 54
，
，
 ，3首部/／
8＝偏片移、、、、、＝99、、、、,
'
,
'，
＇
，
＇，
＇
，
＇、勹279928003799图4-21数据报的分片举例表4-5是本例中数据报首部与分片有关的字段中的数值，其中标识字段的值是任意给定的(12345)。具有相同标识的数据报片在目的站就可无误地重装成原来的数据报。
表4-5IP数据报首部中与分片有关的字段中的数值总长度标识原始数据报数据报片l数据报片2数据报片3382014201420102012345123451234512345。
MFI。
1DF。
。
。
。
片偏移。
。
175350现在假定数据报片2经过某个网络时还需要再进行分片，即划分为数据报片2-1（携带数据800字节）和数据报片2-2（携带数据600字节）。那么这两个数据报片的总长度、标识、MF、DF和片偏移分别为：820,12345,l,0,175;620,12345,1,0,275。

**关键词**: 数据报 分片 标识 MF DF 片偏移


### 关键词提取 - 分块 55
(8)生存时间占8位，生存时间字段常用的英文缩写是TTL(TimeToLive)，表明这是数据报在网络中的寿命。由发出数据报的源点设置这个字段。其目的是防止无法交付的2)3数据报无限制地在互联网中兜圈子（例如从路由器R转发到R1,再转发到R一,然后又转发到R)，因而白臼消耗网络资源。最初的设计以秒作为TTL值的单位。每经过一个路由器时，就把TTL减去数据报在路由器所消耗掉的段时间。若数据报在路由器消耗的时间小于1秒，就把TTL值减1。当TTL值减为零时，就丢弃这个数据报。
”

**关键词**: 生存时间 TimeToLive TTL 路由器 互联网 数据报


### 关键词提取 - 分块 56
”
然而随着技术的进步，路由器处理数据报所需的时间不断在缩短，一般都远远小千l“秒，后来就把TTL字段的功能改为跳数限制（但名称不变）。路由器在每次转发数据报之前就把TTL值减l。若TTL值减小到零，就丢弃这个数据报，不再转发。因此，现在TTL的单位不再是秒，而是跳数。TTL的意义是指明数据报在互联网中至多可经过多少个路由器。显然，数据报能在互联网中经过的路由器的最大数值是255。若把TTL的初始值一设置为1，就表示这个数据报只能在本局域网中传送。因为这个数据报传送到局域网上的某个路由器，在被转发之前TTL值就减小到零，所以会被这个路由器丢弃。
(9)协议占8位，协议字段指出此数据报携带的数据使用何种协议，以便使目的主机的IP层知道应将数据部分上交给哪个协议进行处理。
•138•一常用的
协议名协议字段值些协议和相应的协议字段值如下[W-IANA]芞
ICMP
TCP
6IGMP
2IGP
9UDPEGPIP241Pv6
4117ESP
50AH
51ICMP-IPv6
58OSPF89(10)首部检验和一是因为数据报每经过占16位。这个字段只检验数据报的首部，但不包括数据部分。这

**关键词**: 路由器 数据报 TTL 跳数限制 局域网 协议字段 ICMP TCP IGMP UDP ESP AH ICMP-IPv6 OSPF


### 关键词提取 - 分块 57
一
些字段，如生存个路由器，路由器都要重新计算下首部检验和（一一时间、标志、片偏移等都可能发生变化）。不检验数据部分可减少计算的工作量。为了进步减少计算检验和的工作量，IP首部的检验和不采用复杂的CRC检验码而采用下面的简单计算方法：在发送方，先把IP数据报首部划分为许多16位字的序列，并把检验和字段置零。
＠用反码算术运算把所有16位字相加后，将得到的和的反码写入检验和字段。接收方收到一数据报后，把首部的所有16位字再使用反码算术运算相加次。将得到的和取反码，即得出接收方检验和的计算结果。若首部未发生任何变化，则此结果必为O,千是就保留这个数据报；否则即认为出差错，并将此数据报丢弃。图4-22说明了IP数据报首部检验和的计算
过程。
发送端数
据
报
首
部l6位1字l
字2|
|
检验和1
字n|l6位116.位1
全o
：|反码算术运算求和I16位1取反码』检验和116位I数据部分不参与检验和的计算数据部分字l16位1接收端
|
字21
16位1
16位1：
检验和1
字nG位1
厂一16位1反码算术
运算求和取反码n结果116位1』若结果为0，则保留；

**关键词**: 生存个路由器 首部检验和 IP首部 反码算术运算 数据报首部 16位字 检验和字段 CRC检验码 发送方 接收方 出差错 数据部分 计算过程


### 关键词提取 - 分块 58
检验和1
字nG位1
厂一16位1反码算术
运算求和取反码n结果116位1』若结果为0，则保留；
否则，丢弃该数据报图4-22IP数据报首部检验和的计算过程(11)源地址
(12)目的地址占32位。发送IP数据报的主机的IP地址。
占32位。接收IP数据报的主机的IP地址。
注：原来如协议字段值这样的数值都是由互联网赋号管理机构!ANA负责指派，并公布在有关的RFC文档中的。

**关键词**: 计算机网络 IP数据报 首部检验和 源地址 目的地址


### 关键词提取 - 分块 59
IANA由美国政府建立，升始由JonPostel负责管理。由于JonPostel千1998年去世，同时也山千互联网的商业化和国际化，许多国家CD一一一希望由个新的、私营的、非营利的国际公司互联网名称与数字地址分配机构ICANN[W-ICANN]取代IANA。但后来!CANN并没有取代IANA,而是保留了1ANA，并且和IANA进行了分工。因此现在就出现了IANA/ICANN或ICANN/IANA这一样的写法。这两个机构都负责IP地址和些重要参数的管理。现在有关互联网的重要参数已经不在RFC文档公布[RFC3232],曲改为在网址www.iana.org上查询在线的数据库。从2016年起，升始进行1ANA的管理权逐步向ICANN转移的工作。
＠注：这里的IP表示特殊的IP数据报[P数据报再封装到IP数据报中(IPEncapsulationwithinIP)。

**关键词**: 计算机网络 互联网 IANA ICANN IP地址


### 关键词提取 - 分块 60
＠注：两个数进行二进制反码求和的运算很简单。它的规则是从低位到高位逐列进行计算。0和0相加是0,0和l相加一一是1,1和1相加是0但要产生个进位I,加到下列。若最高位相加后产生进位，则最后得到的结果要在最低位加1。请注意，反码(one'scomplement)和补码(two'scomplement)是不样的。
一•139•2.IP数据报首部的可变部分IP数据报首部的可变部分就是一个选项字段c选项字段用来支持排错、测量以及安全
等措施，内容很丰富。此字段的长度可变，从1字节到40字节不等，取决千所选择的项
目。某些选项项目只需要l字节，它只包括1字节的选项代码。而有些选项需要多个字节，
这些选项一个个拼接起来，中间不需要有分隔符，最后用全0的填充字段补齐为4字节的
整数倍。
增加首部的可变部分是为了增加IP数据报的功能，但这同时也使得IP数据报的首部长
度成为可变的。这就增加了每一个路由器处理数据报的开销。实际上这些选项很少被使用。
很多路由器都个考虑IP首部的选项宁段，因此新的IP版本IPv6就把IP数据报的首部长度

**关键词**: 二进制反码 补码 IP数据报首部 选项字段 路由器 IPv6


### 关键词提取 - 分块 61
很多路由器都个考虑IP首部的选项宁段，因此新的IP版本IPv6就把IP数据报的首部长度
做成固定的了。这里就不讨论这些选项的细节了。有兴趣的读者可参阅RFC791。
4.3IP层转发分组的过程4.3.1埜于终点的转发我们在图4-7中已经描述了分组在互联网中逐跳转发的概念。分组在互
联网上传送和转发是基于分组首部中的目的地址的，因此这种转发方式称为基千终点的转发。
视频讲解因此，分组每到达一个路由器，路由器就根据分组中的终点（目的地址）查找转发表，然后就得知下一跳应当到哪一个路由器。
但是，路由器中的转发表却不是按目的IP地址来直接查出下一跳路由器的。这是因为
互联网中的主机数目实在太大了。如果用目的地址直接查找转发表，那么这种结构的转发表就会非常庞大，使得查找过程非常之慢。这样的转发表也就没有实用价值了。因此必须想办法压缩转发表的大小。
我们知道，32位的IP地址是由两级组成的。前一部分是前缀，表示网络，后一部分表
示主机。所以司以把查找目的主机的方法变通一下，即不是直接查找目的主机，而是先查找
目的网络（网络前缀），在找到了目的网络之后，就把分组在这个网络上直接交付目的主机。

**关键词**: 路由器 IP首部 IPv6 IP数据报 选项字段 IP层 转发 分组 互联网 终点地址 转发表 主机数目 目的地址 下一跳路由器 查找过程 32位IP地址 前缀 网络 主机 目的网络 网络前缀


### 关键词提取 - 分块 62
目的网络（网络前缀），在找到了目的网络之后，就把分组在这个网络上直接交付目的主机。
由千互联网上的网络数远远小千主机数，这样就可以大大压缩转发表的大小，加速分组在路由器中的转发。这就是基千终点的转发过程。
读者可能还会想到一个问题，就是分组首部中没有地方可以用来指明
“
，那么待转发的分组又怎样能够找到下一跳路由器呢？
的IP地址“下一跳路由器当路由器收到一个待转发的分组，在从转发表得出下一跳路由器的IP地址后，不是把
这个地址填入分组首部，而是送交数据链路层的网络接口软件。网络接口软件负责把下一跳
路由器的IP地址转换成MAC地址（必须使用ARP)，并将此MAC地址放在链路层的
MAC帧的首部，然后利用这个MAC地址传送到下一跳路由器的链路层，再取出MAC帧
的数据部分，交给网络层。由此可见，当发送一连串的分组时，上述的这种查找转发表、调
用ARP解析出MAC地址、把MAC地址写入MAC帧的首部等过程，都是必须做的（当然
都是由机器自动完成的）。

**关键词**: 目的网络 分组 路由器 转发表 终点 互联网 主机数 下一跳路由器 IP地址 MAC地址 ARP 链路层 数据链路层 网络接口软件


### 关键词提取 - 分块 63
都是由机器自动完成的）。
那么，能不能在转发表中不使用IP地址而直接使用MAC地址呢？不行。我们一定要弄清楚，使用抽象的IP地址，本来就是为了隐蔽各种底层网络的复杂性而便千分析和研究
问题，这样就不可避免地要付出些代价，例如在选择路由时多了一些开销。但反过来，如果•140•

**关键词**: 计算机网络 IP地址 MAC地址 转发表 底层网络 路由选择

