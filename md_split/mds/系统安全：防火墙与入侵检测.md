钥 属 实， 则C 可以用其私钥分别对A 和 B 的公钥进行签 名， 为这 两个公 钥进行担 保 。 当A

一

得到

个经C 签 名的 B 的公钥时， 可以用已确认的C 的公钥对 B 的公 钥 进行 鉴 别 。 不过，

用户发布其公钥的最常见的方式还是把公钥发布在他们的个人网页上， 或仅仅通过电子邮件

进行分发 。

P GP 很难被攻破 。 因此在 目 前 可以认为PGP 是足够安全的 。

7 . 6   系统安全 ： 防火墙与 入侵检测

恶 意用户或软件通过网络对计算机系统的入 侵或 攻击已成为当今计 算机安全最严重的

一

威胁之

。 用户入侵 包 括利用系统漏 洞进行 未 授权登录， 或者授权用户非法获取更高级别权

限 。 软件入侵方式包括通过网络传 播病 毒、 蠕虫和特洛 伊 木 马 。 此外还包括 阻止合法用户正

常使用服务的拒 绝服务攻击， 等等 。 而前面讨论的所有安 全机制都不能有 效解决以上安全问

的计算机系统通过网络 向 攻击者泄漏

题 。 例如， 加 密技术 并不能 阻 止 植入了

“

特洛伊 木 马

秘 密信息 。

7.6.1 防火墙

”

防火墙( firew all) 作为

一

种访问控制技术 ， 通过严格控制进出网络边界的分组， 禁止任何不

必要的通信， 从而减少潜在入侵的发生， 尽可能 降低这类安全威胁所带来的安全 风 险 。 由千防

火墙不可能 阻 止所有入侵行为， 作为系统 防 御的第二道 防线， 入侵检测 系 统 I DS (I nt rusi on

Det ect i on S yst em )通过对进入网络的分组进行深 度分析与检 测发现疑似入侵行为的网络活动 ，

并进行报 警以便进

一

步采取相应措 施 。

防 火 墙是

一

种特殊编 程的路 由器， 安装在

一

个网点和网络的其余部分之间， 目 的是实

施访问控制策 略 。 这 个访问控制 策 略是 由使用防 火墙的单位自行制定的 。 这种安全 策略应当

最适合本单位的需 要 。 图7 -24 指出 防 火 墙位 千互联网和内部网络之间 。 互联网这 边是防 火

“

”

可 信 的网络

墙的外面， 而内部网络这 边是防 火墙的里面 。 一 般都把防 火墙里面的网络称为
(t rust ed  net w o rk)气 而把防 火墙外面的网络称为

不 可 信 的网络

(u nt rust ed n et w o rk) 。

“

”

防 火墙 的 外 面 唱

，

＇  防 火墙

，

防 火墙 的 里面． － － / 、;

／ 可 信 的 网 络 ＼

｝

分组过滤
路 由 器

I

)  ＼  !

＼

｝
＼二

图 7-24 防火墙在 互连 网 络 中 的位置

CD 注 ： 2004 年 I I 月 ， 联 合 国 总 部 建立 了

“

互 联 网冶 理 工 作 组 WGIG ( Working Group on Internet  Governance) ", 来解决互联

网 的 诚 信 和 安 全 问 题 。 我 国 在 2006 年 2 月 颁 布 的 《 国 家 中 长 期 科 学 和 技 术 发展 规 划 纲 要 ( 2006

—

2020 年 ） 》 中 ， 提 出 以 发展 高

可信 网 络 为 重 点 。 现 在 高 可信 网 络 已 成 为 研 究 热 点 。

•  364  •

防 火墙技术

一

般分为以下 两类。

(1 ) 分组过滤路 由器是

种具有分组过 滤功能的路 由器 ， 它根据 过 滤 规 则 对 进 出 内 部 网

一

络的分组执行 转发或者丢 弃（即过滤）。 过 滤 规 则是基 于分组的网络层 或运 输 层 首 部 的 信 息 ，

例如 ： 源／目的 IP 地址、 源／目的端 口 、 协议类型 (TCP 或 UDP) ， 等 等 。 我 们 知 道 ， TCP 的
端 口 号指出了在TCP 上面的应用层服务。 例如 ， 端 口 号 23 是T ELN ET , 端 口 号 l l9 是 新 闻
网 US ENET , 等等。 所以 ， 如果在分组过滤器中将所有目的端 口 号为 23 的 入 分组(i ncomi n g
p ac ket )都进行 阻拦 ， 那么 所 有 外单 位用户就不能 使用 T ELN ET 登录到 本 单 价 的 主 机 上 。 同

理 ， 如果某公 司 不愿意其雇 员在上班时花费大量时间去看互联网的 US ENET 新 闻 ， 就 可 将

目的端 口 号为119 的 出 分组(out goi n gp ac ket ) 阻拦住 ， 使其无法发送到互联网。

分组过 滤可以是无 状 态的 ， 即独 立地处理每

一

个分组。 也 可 以是有 状 态 的 ， 即 要 跟 踪

每个连接或会话的通信状态 ， 并根据这些状态信息来决定是 否 转发分组。 例 如 ， 一 个进 入 到

分组过滤路 由器的分组 ， 如果其目的端 口是某个客户动态分配的 ， 那 么 该 端 口 显 然 无 法 事 先
一

一

包 含在规 则中。 这样的分组被允 许通过的唯

条件是： 该分组是该端 口 发 出 合 法请求的

个

响应。 这样的规则只能通过有状态的检查来实现 。

分组过 滤 路 由器的优点是简单高 效 ， 且对于用户是透明的 ， 但 不能 对 高 层 数 据 进 行 过

滤。 例如 ， 不能 禁 止 某 个用户对某 个特定应用进行某 个特定的操作 ， 不能 支 持 应 用 层 用户 鉴

别等。 这 些功能 需要使用应用网关技术 来实现。

( 2) 应用网关也称为代理服 务器(p roxy s erver) ， 它在应用层通信 中 扮演 报 文 中 继 的 角 色 。

一种网络应用需要

一

个应用网关 ， 例如在上

一

章 6 .4. 3 节中

”

代理服务 器

”

介 绍 过 的 万 维网

缓存就是

一

种刀维网应用的代理服务器。 在应用网关中 ， 可以实现基 千 应 用 层数据 的 过 滤 和

高层用户 鉴别。

所 有进出网络的 应 用 程 序 报 文都必须通过应用网关。 当 某 应用 客 户 进程 向 服 务 器发送

一份请求报文时 ， 先发送给应用网关 ， 应用网关在应用层打开该报 文 ， 查看该 请 求是 否 合 法

（可根据 应用层用户标识 ID 或其他应用层信息来确定 ）。 如果请求合法 ， 应 用 网关 以 客户

进程的身份将请求报文转发给原始服务器。 如果不合法 ， 报文则 被 丢 弃 。 例 如 ， 一 个 邮件网

关在检查每
“

没有

导 弹

一

” “

”

核弹头
一

个邮件时 ， 会根据邮件地址 ， 或邮件的其他 首部 ， 甚 至 是报 文 的 内 容 （ 如 ， 有

等关键词） 来确定该邮件能 否 通过 防 火墙。

应用网关也 有

些缺点。 首 先 ， 每种应用都需要

一

个不同的 应用网 关 （ 可 以 运 行在同

一

台 主 机上 ）。 其次 ， 在应用层 转发和处理报 文 ， 处理 负 担较重。 另 外 ， 对应 用 程 序 不 透明 ，

需要在应用程序客户端配置应用网关地址。

通常可将这 两种技术 结合使用 ， 图7- 24 所 画 的 防 火 墙就同时具有 这 两种技 术。 它 包括

两个分组过滤路 由器和

一

个应用网关 ， 它们通过两个局 域网连接在

一

起。

7.6.2  入侵检测 系 统

防 火 墙 试图在入 侵 行为发生之前 阻 止 所 有可疑的通信 。 但事 实是不 可 能 阻 止 所 有 的 入

侵行为 ， 有必要采取措施在入侵已经开始 ， 但 还没有造成 危 害 或 在 造 成 更 大 危 害 前 ， 及时检

测到入侵 ， 以便尽快 阻 止入侵 ， 把 危 害 降低到最小。 入侵检测 系统 I DS 正 是 这 样

一

种技 术。

IDS 对进入网络的分组执行深度分组检查 ， 当观察到可疑分组时 ， 向网络 管 理 员 发 出 告 警 或

执行 阻断 操作（ 由千 IDS 的

＂

误报

＂

率通常较高 ， 多数情况不执行 自 动阻 断 ）。 I DS 能 用 于

检 测 多种网络 攻击 ， 包括网络 映 射、 端 口 扫 描 、 DoS 攻击、 蠕 虫 和 病 毒、 系 统 湍 洞 攻 击 等 。

•  36 5  •

入侵检测方法

一

般可以分为基于特征的入侵检测和基 千 异 常的入侵检测 两种。

基于特征的I DS 维护

一

个所有已知攻击标志性特征的数据 库。 每个特征是

一

个与某种

入侵活动相关联的规则 集 ， 这些规则可能 基 千单个 分组的首部字段值或数据 中 特定 比特 串 ，

一

或 者 与

系 列 分组有关。 当发现有与某 种 攻击特征 匹配的分组或 分 组序 列 时 ， 则认为可能检

测 到某种入侵行为。 这 些特征和规则通常 由网络安全专家生成 ， 机构的网络管理 员定制 并将

其加 入 到数据库中。

基于特 征的I DS 只能检测 已知攻击 ， 对于未知攻击则束手无 策。 基于异 常的I DS 通过观

察 正 常 运行的 网络流量 ， 学 习 正 常流量 的统计特性和规律 ， 当检测 到网络中流量的某种统计

规 律不 符合 正常情况时 ， 则认为可能发生了 入 侵行为。 例 如 ， 当 攻击者在对内网 主机进行

p i n g 搜索时 ， 或 导致ICMPp i n g 报 文突 然大量增加 ， 与正常的统计规律有明显不同。 但区分

正常流和统计异常流是

一

件非常 困 难 的事情。 至 今为 止 ， 大多数 部 署的 I DS 主要是基千特征

的 ， 尽 管某些I DS 包括了某些基于 异 常的特性。

不论 采用什么 检 测技术 都 存在

＂

漏 报

“

”

和

误报

“

情况。 如果

＂

＂

淜 报

率 比较高 ， 则

只能检溯到少量 的 入 侵 ， 给人以安全的假 象。 对千特定I DS , 可以通过 调整某些 阙 值来 降低

＂

”

＂

＂

＂

＂

漏报

率 ， 但同时会增大

误报

率。

误报

率太大会 导 致 大量 虚 假 警报 ， 网络管理 员
“

“

需要花费大量时间 分析报 警信息 ， 甚至会因为 虚 假 警报太多而对报 警

视 而不见

， 使I DS

形同虚 设。

7 . 7   一 些 未 来 的 发 展 方 向

本 章介绍了网络安 全 的 主要 概 念。 网络安 全是

一

个 很 大的领 域 ， 无 法 在 这 进行 深 入的

探讨。 对 于 有 志 于这

一

领域的读 者 ， 可 在 下面几 个方向做进

一

步的研 究 ：

(1 ) 椭 圆 曲 线 密码 ECC 目 前椭 圆 曲 线 密码已在T L S 1 .3 的握手 协 议中 占 据非常重要

的地位。 此外 ， 在 电子护照和 金 融系统 中也 大量使用椭 圆 曲 线 密码系统。 在互联网上已有许

多 关 千椭 圆 曲 线 密码的 资料。 限 千篇 幅 ， 无法在本 书中进行 介 绍。

( 2 ) 移 动安 全 (M obi l e S ecu rit y)  移动通信 带 来的 广 泛 应 用 （ 如 移 动 支 付 ， M obil e

Paym ent ) 向网络安 全提出了更高的要求。

(3) 量子密码(Qu antumCr yp t o grap h y)  量子计算机的到来将使得 目 前许 多使用中的密

码技 术 无 效 ， 后 晕子密码学(Post - Qu antumCr yp t o grap h y)的研 究方兴 未 艾。

(4 ) 商 密 九 号 算 法 S M9 为 了 降低公钥和 证 书 管 理的 复 杂性 ， 早 在 三 十多年前 提出的
标 识 密码( Id ent it y- Bas ed Cr yp t o grap h y) ， 现在又 被重视。 标识 密码把用 户的标识 （ 如 手机 号
码 ） 作 为公钥 ， 使得安 全 系 统 变得 易 千 部 署和管理。 200 8年标识 密码算法 正式 获得我国密
码管 理 局 签发 为商密 九 号算法 SM 9 。 此 算 法不需要 申 请数字 证 书 ， 适 用 千 互 联 网 应用的各

种新兴应用 的 安 全 保 障 ， 其应用前 景 值 得 关注。

本章的 重要概念

•  计算机网络上的通信面 临的威胁可 分为两大类 ， 即被动攻击 （ 如截获 ） 和 主动攻击

（ 如中断 、 篡改、 伪造）。 主 动攻击的类型有 更改报文流、 拒 绝服 务、 伪造初始化、

恶意程 序 （病 毒、 蠕 虫、 木 马、 逻辑炸 弹、 后门入侵、 流氓软件） 等。

•  计算机网络安全主要有以下

一

些内容 ： 机 密性、 端点鉴别、 信息的完整性、 运行的

•  366  •

