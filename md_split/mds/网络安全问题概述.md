第 7 章 网络安全

随 着 计 算 机 网 络 的 发 展 ， 网 络 中 的 安 全 问 题 也 日 趋 严 重 。 当 网 络 的 用 户 来 自 社会 各 个
门

阶层 与 部 门 时 ， 大 量在 网 络 中 存储 和 传 输 的 数 据 就 需 要 保护 。 由 千 计算机 网 络 安 全 是 另
专 业学科 ， 所 以 本 章 只 对计 算 机 网 络 安 全 问 题 的 基本 内 容 进 行 初 步 的 介 绍 。

一

( 1 )
本 章 最 重要 的 内 容 是 ：

计算机 网 络面 临 的 安 全性威胁和计算机 网 络 安 全 的 主 要 问 题 。

(2) 对 称 密 钥 密 码 体 制 和 公 钥 密 码体制 的 特 点 。
(3) 鉴 别 、 报 文 鉴 别 码 、 数字签 名 、 证书 、 证 书 链 的 概念 。
(4) 网 络层 安 全协议 IPsec 协议族 和运输层 安 全协议 TLS 的 要 点 。
(5) 应用 层 电 子 邮 件 的 安全措施 。
(6) 系 统 安 全 ： 防 火墙与入侵检测 。

7. 1  网 络 安 全 问 题概述

一

7.1 .1  计算机网 络 面 临 的 安 全性威胁

本 节 讨 论计算 机 网 络 面 临 的 安 全性威胁 、 安 全 的 内 容 和

般 的 数据 加 密 模 型 。

计 算机 网 络 的 通 信 面 临 两 大类威胁 ， 即 被动 攻击和 主动攻击 （ 如 图 7- 1 所示 ） 。

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _  i _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 飞- － － － － － － － － － － － － － － － － － － － － － － － － － － － － -:

源占

终占

，)，仁

尸 ＼ ：

终占 脱占
。

终占 源占

终占

． ．．

主勹

°王 喜 昙

图 7- 1 对 网 络 的 被 动 攻 击 和 主 动 攻 击

被 动 攻 击 是 指 攻 击 者 从 网 络 上 窃 听 他 人 的 通 信 内 容 。 通 常 把 这 类 攻 击 称 为 截 获 。 在 被

一

一

个协议 数据单 元 PDU （ 这里使用 PDU 这

动攻击 中 ， 攻击者 只 是观 察 和 分 析 某
名 词 是考
虑 到 所涉及 的 可 能 是 不 同 的 层 次 ） 而 不干扰信 息 流 。 即 使 这些数据对攻击者来说是 不 易 理解
的 ， 他也可通过观察 PDU 的 协 议控制 信 息 部 分 ， 了 解正 在通 信 的 协 议 实 体 的 地址 和 身 份 ，
研 究 PDU 的 长 度 和 传 输 的 频度 ， 从 而 了 解所交换 的 数据 的 某 种 性质 。 这种被动攻击又称为
流量 分析 (traffic analysis) 。 在 战 争 时 期 ， 通 过 分 析 某 处 出 现 大 量 异 常 的 通信 量 ， 往 往 可 以 发
现敌方指挥所 的 位 置 。

主动攻击有 如 下 几种 最 常 见 的 方 式 。
( 1 ) 篡改

攻 击 者 故 意 篡 改 网 络上传 送 的 报 文 。 这里也包括彻底 中 断传 送 的 报文 ， 甚

至 是把完全伪 造 的 报 文 传送给接收方 。 这种攻击方式有 时 也称 为 更 改报 文 流 。

(2) 恶意程序

恶 意 程序 (rogue program)种类 繁 多 ， 对 网 络 安 全 威胁较大 的 主 要 有 以

下 几种 ：

•  334  •

•  计算机病毒(c om put er vi rus ) ，

一

种会

“

传 染

”

其他程序的程 序 ，

”

“

传 染

是通过 修

改其他程序来把自身或自己的变种复制进去而完成的。

•  计算机蠕虫(c om put er w o rm ) ， 一种通过网络的通信功能 将自 身从

一

个 节点发送到

一

另

个 节点并自动启 动运行的程序。

•  特洛伊木马 (Tro jan ho rs e) , 一种程 序 ， 它执行的功能并非所 声称的功能而是某种恶

意功能。 如

一

个编 译 程 序 除了执行编译任务以外 ， 还把用户的源程序偷偷地复制下

来 ， 那么 这种编 译 程 序就是

一

种特洛伊木 马。 计算机病 毒有时也 以 特洛伊木 马的形

式出现。

•  逻辑炸弹(lo gic bomb ) ，

一

种当运 行 环境满足某种特定条件时 执 行其他特殊功能的

程序。 如

一

个编辑程序 ， 平时运行得很好 ， 但当系统时间为13 日 又为星期五时 ， 它

会删去系统中所有的文件 ， 这种程序就是

一

种逻辑炸 弹。

•  后 门 入侵(ba c kd oo r knoc ki n g) ， 是指利用系统实现中的漏洞通过网络入侵系统。 就

一

像
个 盗 贼在夜晚试图闯入民宅 ， 如果某家住户的房门有缺 陷 ， 盗 贼就 能乘虚而入。
索 尼 游戏网络(Pla ySta ti on Netw ork)在 2011年被入侵 ， 导致7700 万用户的个人信息 ，

诸如 姓 名 、 生日、 E -mail地址 、 密码等被盗[W -BACKD]。

•  流氓软件 ，

一

种 未经用户 允许就在用户计算机上安装运行并损害用户利益的软件 ，

其 典 型 特 征是： 强制安装 、 难以卸载 、 浏 览器劫持 、 广告弹出 、 恶意收集用户信息、

恶意卸载 、 恶意捆 绑等。 现在流 氓软件的泛滥程度已超过了各种计算机 病 毒 ， 成为

互联网上最大的公 害。 流氓软件的名字

一

般都很吸引人 ， 如某某卫 士 、 某某搜霸等 ，

因此要特别小心。

上 面所说的计算机 病 毒是狭 义的 ， 也 有人把所有的 恶意 程 序泛指为计算机 病 毒。 例如

1 988年 10 月

“

Morri s 病 毒

”

入侵美国互联网 ， 舆论说该事件是

“

计算机病 毒入侵美国计算

机 网

”

， 而计算机安全专家却称之为

“

互联网蠕虫事件

”
。

(3) 拒绝服 务 Do S ( Deni al  o f  Servi c e)  指攻击者向互联网上的某个服务器不停地发送

大量分组 ， 使该服务器无法提供正 常服务 ， 甚至完全瘫痪。 2000年 2 月 7 日至 9 日美国几

个著名网站遭 黑客

CD

袭击 ， 使这 些网站的服务器

一

直处千

＂

忙

＂

的状态 ， 因而无法向发出请

求的客户 提 供服务。 这 种 攻击 被称 为 拒 绝服 务。 又如在 2014 年 圣 诞节 ， 索 尼 游 戏 网

(Pla ySta t i on  Net w ork)和微软游戏网( Microso ft Xbox  L i ve)被黑客攻击 后 瘫 痪 ， 估计有1.6亿用

户受到影响[ W - DO S]。

若从互联网上的成 百 上千个网站 集 中 攻击

一

个网站 ， 则称为 分 布 式 拒 绝服 务 DDo S

( Distri but ed  Denia l o f  Servic e)。 有时也把这种攻击称为网络带 宽攻击或连通性攻击。

201 8年 2 月 ， 6 日世界标准时间 零时 ， 亚太地区 许多计算机同时向根服务器系统发动
袭击 ， 企图使之瘫痪。 它们每 秒传送的数据量相当千服务 器每分钟要接收75 万 封电子邮件。

结果 至少有 6 个根服务器系统受到影响 ， 两个 破 坏 严 重。 有分析认为 攻击来自韩国 ， 但

CD 注 ： 黑 客
一

(hacker)

是 指 精 通 计 算 机编 程 的 高 手 ， 他们 能 够 通过 专 门 的 技 术 手 段 进 入 某 些 据 称 是 相 当 安 全 的 计算 机 系 统 中 。

一

黑 客

般 可 分 为 两 大 类 。 一 类 是 蓄 意搞破坏或盗窃 别 人计 算 机 中 数据 信 息 的 坏 人 ， 而 另

类 则 是 专 门 研 究计 算 机 系 统 安全性 的 好

人 。 例 如 ， 银行 发 行 的 信 用 卡 必 须十 分 安 全 ， 但 这种 信 用 卡 的 安 全性 在 公 开 发 行 之 前 却 无 从 知 晓 。 这时 就要请专 门 研 究 计 算 机 安

全 的 黑客对信 用 卡进行攻击实验 。 如 黑 客 在 努 力 尝试后仍无法攻破 ， 则 可认 为 该 信 用 卡 至 少 在 目 前 是相 对 安 全 的 。

• 335  •

一

ICANN 不 认 为 黑 客

定 是 韩 国 人 ， 他 可 以 是 任 何 地 点 的 任 何 人 ， 只 不过是操纵 了 韩 国 的 计

算机而 已 。

还 有 其他 类似 的 网 络 安 全 问 题 。 例 如 ， 在 使 用 以 太 网 交 换 机 的 网 络 中 ， 攻 击 者 向 某 个
以 太 网 交换机发送 大 量 的 伪造源 MAC 地址 的 帧 。 以 太 网 交换 机 收 到 这样 的 帧 ， 就把这个假
的 源 MAC 地 址 写 入 交 换 表 中 （ 因 为 交 换 表 中 没 有 这 个 地址 ） 。 由 于这种伪造 的地址数量太
大 ， 因 此很快就把交换表填满 了 ， 导 致 以 太 网 交换机无法 正 常 工 作 （ 称为交换机 中 毒 ） 。

对 于 主 动 攻击 ， 可 以 采 取 适 当 措 施加 以 检 测 。 但 对 于 被 动 攻 击 ， 通 常 却 是 检 测 不 出 来

的 。 根据这些特 点 ， 可 得 出 计算机 网 络 通 信 安全 的 目 标如 下 ：

( 1 ) 防 止析 出 报 文 内 容 和 流 量 分 析 。
(2) 防 止恶 意程序 。
(3) 检测 更 改报 文 流 和 拒绝服务 。
对 付 被 动 攻 击 可 采 用 各 种 数据 加 密 技术 ， 而 对 付 主 动 攻 击 ， 则 需 将 加 密 技 术 与 适 当 的

鉴 别 技 术 相 结 合 。
7.1 .2  安 全 的 计 算机 网 络

一

一

人 们

直 希 望 能 设 计 出

种 安 全 的 计 算 机 网 络 ， 但 不 幸 的 是 ， 网 络 的 安 全 性 是 不 可 判
定 的 [DENN82] 。 目 前 在 安 全协 议 的 设计 方 面 ， 主 要 是 针对 具 体 的 攻击 设 计 安 全 的 通信 协 议 。
但 如 何保证所设计 出 的协 议 是 安全 的 ？ 这可 以 使 用 两种 方法 。 一 种 是 用 形 式化方法来证 明 ，

一

一

另

种 是 用 经验来分析协议 的 安 全 性 。 形式化证 明 的 方法是人们所希望 的 ， 但

般 意 义上 的

协 议 安 全 性 也 是 不 可判 定 的 ， 只 能针对某种特定 类 型 的 攻击来讨论其安全性 。 对 千 复 杂 的 通

信 协 议 的 安全 性 ， 形式化证 明 比较 困 难 ， 所 以 主要采用 人 工 分 析 的方法来找漏洞 。 对于 简 单

一

的 协 议 ， 可通过 限制 入侵者 的 操 作 （ 即 假 定 入 侵 者不会进行某种攻击 ） 来对

些特定情况进

行 形 式 化 的 证 明 ， 当 然 ， 这 种 方法有 很大 的 局 限性 。

一

一

根 据 上

节 所 述 的 各种 安 全 性 威 胁 ， 不 难看 出 ，

个 安 全 的 计 算 机 网 络 应 设法 达 到 以

下 四 个 目 标 ：

1 . 机密性

机 密 性 （ 或私 密 性 ） 就 是 只 有 信 息 的 发 送 方 和 接 收 方 才 能懂 得 所 发 送 信 息 的 内 容 ， 而

信 息 的 截 获 者 则 看不懂所截 获 的 信 息 。 显 然 ， 机 密 性 是 网 络 安 全通信最基 本 的 要求 ， 也 是对

付被动攻击所 必 须 具 备 的 功 能 。 通 常 可 简 称 为保密 。 尽 管计算机 网 络安 全并 不 仅 仅 依 靠机 密

性 ， 但 不 能提供机密 性 的 网 络肯 定 是 不 安全 的 。 为 了 使 网 络 具 有 机 密 性 ， 需要使用 各 种 密 码

技 术 。

2 . 端点鉴别

安 全 的 计 算 机 网 络 必 须 能 够 鉴 别 信 息 的 发送 方 和 接 收 方 的 真 实 身 份 。 网 络 通 信 和 面对

面 的 通 信 差 别 很大 。 现在频繁 发 生 的 网 络 诈骗 ， 在 许 多 情况 下 ， 就 是 由 千在 网 络 上 不 能 鉴 别

一

出 对 方 的 真 实 身 份 。 当 我们 收 到

封 电子 邮件 时 ， 发信 人 也 可 能 并 不 是 邮件上所署名 的 那 个

人 。 当 我们 进行 网 上购物 时 ， 卖 家 也 有 可 能是犯罪分子假 冒 的 商 家 。 不 能解决这个 问 题 ， 就

不 能认 为 网 络 是 安 全 的 。 端 点 鉴 别 在 对付主动攻击 时 是 非 常重 要 的 。

•  336 •

3 . 信息的 完整性

即 使 能 够 确 认 发送 方 的 身 份 是 真 实 的 ， 并 且 所 发 送 的 信 息 都 是 经 过 加 密 的 ， 我们 依 然

不 能认 为 网 络 是 安 全 的 。 还 必 须确认所收到 的 信 息 都 是 完 整 的 ， 也就 是信 息 的 内 容 没有被人
篡 改 过 。 保证信 息 的 完整性在应对主动攻击 时 也 是 必 不可 少 的 。 信 息 的 完 整 性 和 机 密 性 是 两
个 不 同 的 概念 。 例 如 ， 商 家 向 公 众 发布 的 商 品 广 告 当 然 不 需 要 保 密 ， 但 如 果 广 告 在 网 络 上 传
送 时 被 人 恶 意 删 除或添加 了

些 内 容 ， 那 么 就 可 能对 商 家造成很 大 的 损 失 。

一

实 际 上 ， 信 息 的 完 整 性 与 端 点 鉴 别 往 往 是 不 可 分 割 的 。 假 定 你 准 确 知 道 报 文 发 送 方 的
“
身份没有错 （ 即 通过 了 端 点 鉴别 ） ， 但 收到 的 报 文 却 已被人篡改过 （ 即 信 息 不完 整 ） ， 那 么 这
样 的报 文 显 然 是 没有 用 处 的 。 因 此 ， 在谈到
的 完 整 性 。 也 就 是 说 ， 既 鉴 别 发送方 的 身 份 ， 又 鉴 别 报 文 的 完整 性 。

时 ， 有 时 是 同 时包 含 了 端 点 鉴 别 和 报 文

鉴 别

”

4. 运行的 安全性

一

现 在 的 机 构 与 计 算 机 网 络 的 关 系 越 密 切 ， 就 越 要 重 视 计 算 机 网 络 运 行 的 安 全 性 。 上

节介绍 的 恶 意 程 序 和 拒 绝服务 的 攻击 ， 即 使 没有 窃 取 到 任 何有用 的 信 息 ， 也 能够 使 受 到 攻击

的 计 算机 网 络 不 能 正 常运行 ， 甚至完全瘫痪 。 因 此 ， 确 保计算机 系 统运 行 的 安 全性 ， 也 是 非

常 重要 的 工 作 。 对千
访 问 控制

(access control)

些 要 害 部 门 ， 这 点 尤为重要 。

对 计 算 机 系 统 的 安 全 性 非 常 重 要 。 必 须对 访 问 网 络 的 权 限 加 以
控制 ， 并 规 定 每 个 用 户 的 访 问 权 限 。 由 于 网 络是 个 非 常 复杂 的 系 统 ， 其 访 问 控制机制 比 操 作

系 统 的访 问 控制 机制 更 复杂 （ 尽 管 网 络 的 访 问 控制机制 是建立在操作 系 统 的 访 问 控制 机 制 之

(multilevel security)

上 的 ） ， 尤其在安 全 要 求更 高 的 多 级 安 全
7 . 1 .3  数据加 密 模 型

情况 下 更 是 如 此 。

7-2

A

B

X,

E

一般 的 数据 加 密 模 型 如 图

后 ， 就得 出 密文 Y。加密密钥 K 了

A

向

所示 。 用 户
截互占］「叶归改

发送明文

但通过加 密算法

运算

B

一

图 中 所示 的 加 密 和 解 密 用 的密钥

串 秘密 的 字 符 串 （ 即 比特 串 ） 。 公 式

是 明 文通过加 密 算法变成密 文 的

图 7-2 一 般 的 数据 加 密 模型

K (key)

一

一

是
般表示方法 。
y  =  E
(X)
K

(7- 1 )

就

(7- 1 )

在传送 过程 中 可 能 出 现密 文 的 截取者 （ 或攻击者 、 入侵者 ） 。 公 式

表 示 接 收 端 利 用
解密算法 D 运算和解密密钥 K, 解 出 明 文 X。 解 密 算 法 是 加 密 算 法 的逆运算 。 在进行解密运
(7-2)
DK( Y)  =  DK(EK(X))  =  X
算 时 ， 如 果 不使用 事 先 约 定 好 的 密 钥 就无法解 出 明 文 。

•  3 3 7  •

(7-2)

这里我们假定加 密 密 钥 和解密 密 钥都是

一

样的 。 但实 际上 它 们可以是不

一

样的（即使

样， 这两 个 密 钥也必然有 某 种 相 关性） 。 密 钥通常 由 密 钥 中心提供 。 当 密 钥需要向远地

一

不
传送时，

一

定要通过 另

一

个安全 信道 。

密码编码学(cr ypt o grap h y)是密码体制的设计学， 而 密 码 分析学(cr ypt anal ysis ) 则是在 未知

密 钥 的情况下从密文推演出明文或 密 钥的技术 。 密码编码学与密码分析学合起来即为密码学

(cr yp t olo gy) 。

如果 不论 截取者 获 得 了 多 少 密文， 但在密文 中 都没有足够的信息来 唯

一

地确定出对应

的明文， 则 这

一

密 码体制称为无条件 安 全的， 或称为理论上是不可破的 。 在无任何限制的条

件 下 ， 目 前 几 乎所 有实用的 密 码体制 均是可破的 。 因此， 人们关心的是要 研制出在 计 算 上

（而不是在理论上） 是不可破的密码体制 。 如果

一

个密码体制 中的密码， 不能在

一

定时间内被

可以使用的计算 资源破译， 则 这

一

密 码体制称为在计算上是安全的 。

早在几 千 年前人类就已经有了通信保密的思 想 和方法 。直到 19 4 9 年， 信息论 创始人 香

一

农(C.E .  Sh annon)发表著名文章[SHAN 4 9 ]， 论证了
破的 。 密 码学的研 究曾面 临 着 严重的危机 。 但从 20 世纪 60 年代起， 随 着电子技术 、 计算技
一

般经典加密方法得到的密文几乎都是可

术 的迅速发展以及结构代数、 可计算性和计算 复 杂性理论等学科的研 究， 密码学又进入了
个新的发展时期。 在 20 世纪70 年代后期， 美国的数据加密标准 DE S ( Dat a E ncr yption St and ard)
和公钥 密 码 体制 (p u blic key cr yp t o -s yst em , 又称为公 开 密 钥 密码体制） 的出现， 成为近代
密码学发展史上的两个重要里程碑 。

7 . 2   两 类 密码体制

7.2.1  对称密钥密码体制

所 谓 对称 密 钥 密 码 体制， 即加 密 密 钥 与 解密 密 钥 都使用相 同 密 钥 的密 码 体 制 。 例如图

7- 2 所示 的情况， 通信的双方使用的就是对称密 钥 。

数 据 加 密标准 DE S 属 千对称 密 钥 密码体制 。 它 由I BM 公 司 研制出， 千 1977 年被美国

定为联邦信息标准后， 在国际上引起了极大的重视 。 I SO 曾将 DE S 作为数据加密标准 。

一

DE S 是

种分组密码 。 在加密前， 先 对整 个的明文进行分组 。 每

一

个组为64 位长的二

一

一

进制数据 。 然后对每
将各组密文 串 接起来， 即得出整个 的 密文 。 使用的 密 钥 占 有 64 位（实 际 密 钥长 度为56 位，
外加 8 位用千 奇 偶 校验） 。

个 64 位 二进制数据进行加密处理， 产生

组 64 位 密文数据 。 最后

DES 的机密性仅取决千对密钥的保密 ， 而算法是公开的 。 DE S 的问题是它的密 钥长 度 。
一

56

1 6

56 位长的密钥意味着共有 2

种可能的密钥， 也就是说， 共有约 7.6 X  10

种 密 钥 。 假设

台 计 算机 1 µs 可执行

一

次 DE S 加密， 同时假定平 均只需搜索 密 钥空间的

一

半即可找到密 钥，

那么 破译 DE S 要超过1000年 。

然而 芯 片的发展出乎意料地快 。 不久， 56 位 DE S 已不再被认为是安全的 。

对 于 DE S 56 位 密 钥的问题， 学者们提出了三重 DE S ( T rip l e  DE S 或记为3DE S ) 的方
一

一

一

一

案， 把

个 64 位明文用

个密钥加密， 再 用 另

个密钥解密， 然后再使用第

个密钥加 密，

即

• 338  •

Y = DE S K[ ( DE S -I K2( DE S K 1  (X)))

