故 障 ， 变 得 无 法 再 继 续 工 作 ， 说 明 其 质 量 不 好 。 高 质 量 的 网 络往 往 价 格 也 较 高 。

3 . 标准化

网 络 的 硬 件 和 软 件 的 设 计 既 可 以 按 照 通 用 的 国 际 标 准 ， 也 可 以 遵 循 特 定 的 专 用 网 络 标

准 。 最 好 采 用 国 际标 准 的 设计 ， 这 样 可 以 得 到 更 好 的 互操 作 性 ， 更 易 千 升 级 换 代 和 维 修 ， 也

更 容 易 得 到 技 术上 的 支 持 。

4 . 可靠性

可 靠 性 与 网 络 的 质 量 和 性 能 都 有 密 切 关 系 。 高 速 网 络 的 可 靠 性 不 一 定 很 差 。 但 高 速 网

络 要 可 靠地运 行 ， 则 往往 更加 困 难 ， 同 时 所 需 的 费 用 也 会较 高 。

5 . 可扩展性和 可升级性

在 构 造 网 络 时 就 应 当 考 虑 到 今 后 可 能 会 需 要 扩 展 （ 即 规 模 扩 大 ） 和 升 级 （ 即 性 能 和 版

本 的 提 高 ） 。 网 络 的性 能越好 ， 其 扩 展 费用 往 往 也 越 高 ， 难 度 也 会相 应增 加 。

6 . 易 千管理和维护

网 络 如 果 没有 良 好 的 管 理 和 维护 ， 就 很 难 达 到 和 保持 所 设 计 的性 能 。

1 . 7  计 算机网络体 系结构

在 计 算 机 网 络 的 基 本 概 念 中 ， 分 层 次 的 体 系 结构 （ 或 架构 ） 是 最 基 本 的 。 计 算 机 网 络

体 系 结 构 的 抽 象 概 念 较 多 ， 在 学 习 时 要 多 思 考 。 这 些 概 念 对 后 面 的 学 习 很 有 帮 助 。

1 .7. 1  计 算机 网 络体系 结 构 的 形 成

计 算 机 网 络 是 个 非 常 复 杂 的 系 统 。 为 了 说 明 这 一 点 ， 可 以 设 想 一 种 最 简 单 的情 况 ： 连

接 在 网 络 上 的 两 台 计 算 机 要 互相 传 送 文 件 。

显 然 ， 在 这 两 台 计 算 机 之 间 必 须 有 一 条 传 送 数据 的 通 路 。 但 这 还 远 远 不 够 。 至 少 还 有

以 下 几项 工作 需 要 去 完 成 ：

( 1 ) 发 起 通 信 的 计 算 机 必 须 将 数 据 通 信 的 通路激活(activate) 。 所 谓 “ 激活

”

就 是 要 发 出

一 些信 令 ， 保 证 要 传 送 的 计 算 机数据 能在 这 条通路上 正 确 发送 和 接 收 。

(2) 告 诉 网 络 如 何 识 别 接 收 数据 的 计 算机 。

(3) 发起通信 的 计 算 机必 须 查 明 对 方 计 算 机 是 否 已 开 机 ， 并 且 与 网 络 连接 正 常 。
(4) 发起通信 的 计 算 机 中 的 应 用 程 序 必 须 弄清 楚 ， 在 对方 计 算 机 中 的 文 件 管 理 程 序 是 否

己 做 好接 收 文 件 和 存储文 件 的 准 备工 作 。

(5) 若 计 算 机 的 文 件格 式 不 兼 容 ， 则 至 少 其 中 一 台 计 算 机 应 完 成 格 式转 换 功 能 。
(6) 对 出 现 的 各 种 差 错 和 意 外 事 故 ， 如 数据 传 送错 误 、 重 复 或 丢 失 ， 网 络 中 某个 节 点 交

换机 出 现 故 障 等 ， 应 当 有 可 靠 的 措 施 保 证 对 方 计 算机最 终 能 够 收 到 正 确 的 文 件 。

还 可 以 列 举 一 些 要 做 的 其 他 工 作 。 由 此 可 见 ， 相 互 通 信 的 两 个 计 算 机 系 统 必 须 高 度 协
是 相 当 复杂 的 。 为 了 设计 这样 复 杂 的 计 算机 网 络 ， 早 在 最 初 的

调 工 作 才 行 ， 而 这 种

协 调

“

”

ARPANET 设 计 时 即 提 出 了 分层 的 方 法 。

“

”

分 层

可 将 庞 大而 复 杂 的 问 题 ， 转 化 为 若 干 较 小

•  27 •

的 局 部 问 题 ， 而 这 些较 小 的 局 部 问 题 就 比 较 易 千 研 究 和 处 理 。

1 974 年 ， 美 国 的 IBM 公 司 宣 布 了 系统网络体 系结构 SNA (System Network Architecture) 。
这 个 著 名 的 网 络标 准 就 是 按 照 分 层 的 方法 制 定 的 。 现 在 用 IBM 大 型 机 构 建 的 专 用 网 络 仍 在
使 用 SNA 。 不 久后 ， 其 他一 些 公 司 也 相 继推 出 自 己 公 司 的 具 有 不 同 名 称 的 体 系 结 构 。

不 同 的 网 络 体 系 结 构 出 现 后 ， 使 用 同 一 个 公 司 生 产 的 各 种 设 备 都 能够 很 容 易 地 互 连 成
网 。 这 种 情 况 显 然 有 利 千 一个 公 司 垄 断 市 场 。 但 由 千 网 络体 系 结 构 的 不 同 ， 不 同 公 司 的 设 备
很 难 互 相 连通 。

然 而 ， 全 球 经 济 的 发 展 使 得 不 同 网 络 体 系 结 构 的 用 户 迫 切 要 求 能 够 互 相 交 换 信 息 。 为

了 使 不 同 体 系 结 构 的 计 算 机 网 络 都 能 互连 ， 国 际标准化组织 ISO 千 1 977 年 成 立 了 专 门 机构
研 究 该 问 题 。 他们 提 出 了 一 个 试 图 使 各 种 计 算机 在 世 界 范 围 内 互连成 网 的 标 准 框 架 ， 即 著 名
的 开放 系统互连基本参考模型 OSI/RM (Open  Systems  Interconnection  Reference  Model) ， 简
是 指 非 独 家 垄 断 的 。 因 此 只 要 遵 循 OSI 标 准 ， 一 个 系 统就可 以 和 位 于 世
称 为 OSI 。 “ 开放
界 上 任 何地方 的 、 也 遵 循 这 同 一标准 的 其 他 任 何 系 统进 行通信 。 这 一 点 很 像 世 界 范 围 的 有 线

”

是 指 在 现 实 的 系 统 中 与 互 连有 关 的 各
电 话 和 邮 政 系 统 ， 这 两 个 系 统 都 是 开 放 系 统 。 ” 系 统
部 分 （ 我们 知 道 ， 并 不 是 一个 系 统 中 的 所 有 部 分都 与 互 连 有 关 。 OSI/RM 把 与 互 连 无 关 的 部

”

分 除 外 ， 而 仅 仅 考虑 与 互 连有 关 的 那 些 部分 ） 。 所 以 OS I/RM 是 个抽 象 的 概 念 。 在 1 983 年形

成 了 开 放 系 统互连基本参 考 模 型 的 正 式 文件 ， 即 著 名 的 ISO 7498 国 际标 准 ， 也 就 是 所谓 的

七 层 协议 的 体 系 结 构 。

OSI 试 图 达 到 一种 理 想 境 界 ， 即 全球 计 算 机 网 络 都遵 循 这 个 统 一 标 准 ， 因 而 全 球 的 计 算
机 将 能 够 很方便地进 行 互 连 和 交 换 数据 。 在 20 世 纪 80 年 代 ， 许 多 大 公 司 甚至 一 些 国 家 的政
府机构 纷纷表示 支 持 OSI 。 当 时 看来似乎 在 不 久 的 将 来 全 世 界 一 定 会按 照 OSI 制 定 的 标 准 来
构 造 自 己 的 计 算机 网 络 。 然 而 到 了 20 世 纪 90 年 代 初 期 ， 虽 然 整 套 的 OSI 国 际标 准 都 已 经

制 定 出 来 了 ， 但 由 千 基千 TCP/IP 的 互 联 网 已 抢 先 在 全球 相 当 大 的 范 围 成 功地运行 了 ， 而 与

此 同 时 却 几 乎找 不 到 有什 么 厂 家 生 产 出 符合 OSI 标 准 的 商 用 产 品 。 因 此 人们 得 出 这样 的 结
论 ： OSI 只 获得 了 一 些 理 论研 究 的 成 果 ， 但 在 市场 化 方面 则 事 与 愿违地 失败 了 。 现 今 规 模 最
大 的 、 覆 盖 全 球 的 、 基 于 TCP/IP 的 互联 网 并 未 使 用 OSI 标准 。 OSI 失 败 的 原 因 可 归 纳 为 ：

( 1 )  OSI 的 专 家 们 缺 乏 实 际经验 ， 他们 在 完 成 OSI 标 准 时 缺 乏 商 业 驱动 力 ；

(2) OSI 的 协 议 实 现起 来过 分 复 杂 ， 而 且 运 行 效 率 很 低 ；

(3) OSI 标 准 的 制 定 周 期 太长 ， 因 而使 得 按 OSI 标 准 生 产 的 设 备无法及 时进入 市场 ；

(4)  OSI 的 层 次 划 分 不 太合 理 ， 有 些 功 能 在 多 个层 次 中 重 复 出 现 。
按 照 一 般 的 概 念 ， 网 络 技 术 和 设 备 只 有 符 合 有 关 的 国 际 标 准 才 能 大 范 围 地 获 得 工 程 上
的 应 用 。 但 现在 情 况 却 反过来 了 。 得 到 最 广 泛应 用 的 不 是法律上 的 国 际标准 OSI , 而 是 非 国

际 标 准 TCP/IP 。 这样 ， TCP/IP 就 常 被 称 为 是 事实 上 的 国 际标准 。 从这种 意 义 上 说 ， 能 够 占

领 市 场 的 就 是标 准 。 在 过去 制 定 标准 的 组织 中 往往 以 专 家 、 学 者 为 主 。 但 现 在许 多 公 司 都纷
纷 加 入 各 种 标 准化组织 ， 使 得 技 术 标 准 具 有 浓 厚 的 商 业 气 息 。 一 个 新 标 准 的 出 现 ， 有 时 不 一
定 反 映 其 技 术 水 平 是 最 先进 的 ， 而 是 往 往 有 着 一 定 的 市场 背 景 。

顺 便 说一 下 ， 虽 然 OSI 标 准 在 一开 始 由 ISO 来制 定 ， 但后 来 的 许 多 标准 都 是 ISO 与 原

• 2 8  •

来 的 国 际 电报 电 话 咨询 委 员 会 CCITT。联合制 定 的 。 从 历 史上来看 ， CCITT 原 来 是 从通 信 的
角 度 考 虑 一 些 标 准 的 制 定 的 ， 而 I SO 则 关 心 信 息 的 处 理 。 但 随 着 科 学 技 术 的 发展 ， 通 信 与
信 息 处理 的 界 限变 得 比较模糊 了 。 千 是 ， 通 信 与 信 息 处理 就 都 成 为 CCITT 与 ISO 所 共 同 关

心 的 领域 。 CCITT 的 建 议 书 X.200 就 是 关 千 开 放 系 统 互连 基 本 参 考 模 型 的 ， 它 和 上 面 提 到

的 ISO 7498 基 本 上 是 相 同 的 。

1 .7.2  协 议 与 划 分 层 次

在 计 算 机 网 络 中 要 做 到 有 条 不 紊 地 交 换 数 据 ， 就 必 须 遵 守 一 些 事 先 约
定 好 的 规 则 。 这 些 规则 明 确规定 了 所 交 换 的 数 据 的 格 式 以 及 有 关 的 同 步 问

题 。 这 里 所 说 的 同 步 不 是 狭 义 的 （ 即 同 频 或 同 频 同 相 ） 而 是 广 义 的 ， 即 在
一 定 的 条 件 下 应 当 发生 什 么 事 件 （ 例 如 ， 应 当 发送 一 个 应 答 信 息 ） ， 因 而 同 步含 有 时序 的 意
思 。 这 些 为 进 行 网 络 中 的 数 据 交 换 而 建 立 的 规 则 、 标 准 或 约 定 称 为 网 络 协 议 (network
protocol) 。 网 络协 议 也 可 简 称 为协议 。 更 进 一 步讲 ， 网 络 协 议 主 要 由 以 下 三个 要 素 组 成 ：

视频讲解

( 1 ) 语法 ， 即 数据 与 控 制 信 息 的 结 构 或 格 式 ；

(2) 语义 ， 即 需 要 发 出 何种 控 制 信 息 ， 完 成 何 种 动 作 以 及 做 出 何种 响 应 ；

(3) 同 步 ， 即 事件 实 现 顺 序 的 详 细 说 明 。

由 此 可 见 ， 网 络 协 议 是 计 算 机 网 络 不 可 缺 少 的 组 成 部 分 。 实 际 上 ， 只 要 我 们 想 让 连 接
在 网 络 上 的 另 一 台 计 算机做 点 什 么 事情 （ 例 如 ， 从 网 络 上 的 某 台 主 机 下 载 文件 ） ， 都 需 要 有
协 议 。 但 是 当 我们 经 常 在 自 己 的 个 人 电 脑 上 进 行 文件 存 盘 操 作 时 ， 就不 需要任何网络协议 ，

除 非 这 个 用 来 存储 文 件 的 磁 盘 是 网 络 上 的 某 个 文 件 服 务 器 的 磁 盘 。

协 议 通 常 有 两 种 不 同 的 形 式 。 一 种 是 使 用 便 于 人 来 阅 读 和 理 解 的 文 字 描 述 。 另 一 种 是
使 用 让 计 算 机 能 够 理 解 的 程序 代 码 。 这 两种 不 同 形式 的 协议 都 必 须 能够 对 网 络上 的 信 息 交换

过 程做 出 精确 的 解释 。

ARPANET 的 研 制 经验表 明 ， 对 千 非 常 复 杂 的 计 算 机 网 络协 议 ， 其 结 构 应 该 是 层 次 式 的 。

我们 可 以举 一 个 简 单 的 例 子 来 说 明 划 分层 次 的概念 。

现 在 假 定 我 们 在 主 机 l 和 主 机 2 之 间 通过 一个 通 信 网 络传 送 文件 。 这 是 一 项 比较 复 杂

的 工 作 ， 因 为 需 要 做 不 少 的 工 作 。

我 们 可 以 将 要 做 的 工 作 划 分 为 三 类 。 第 一 类 工 作 与 传 送 文 件 直 接 有 关 。 例 如 ， 发 送 端
的 文 件传送应用 程序应 当 确 信接 收 端 的 文 件管理程序 己 做 好 接 收 和 存 储文 件 的 准 备 。 若 两 台
主机所用 的 文件 格 式 不 一样 ， 则 至 少 其 中 的 一 台 主机应完 成 文 件 格 式 的 转 换 。 这 两 项 工 作 可
用 一个文件传送模块来完成 。 这 样 ， 两 台 主 机 可 将 文件传送模块作 为 最 高 的 一层 （ 如 图 1 - 1 5
所 示 ） 。 在 这两 个 模 块 之 间 的 虚 线 表示 两 台 主 机 系 统 交 换 文 件 和 一 些 有 关 文 件 交 换 的 命 令 。

”

CD 注 ： 鉴千 “ 有 线 电 ” 和 “ 无线 电

的 关 系 日 益密切 ， 国 际 电信联盟 ITU (International Telecommunication Union) 已将 国 际
电报 电 话 咨 询 委 员 会 CCITT 和 国 际 无线 电 咨询 委 员 会 CCIR 合 并为 电信标准化部门 TSS (Telecommunication  Standardization
Sector) 。 从 1 993 年 3 月 1 日 起 ， CCITT 和 CCIR 不 复 存 在 ， 有 关 电信 的 标准就 由 国 际 电信联盟 ITU 的 电信标准化部 门 颁 布 ， 并
在 每个 建 议 书 的前面加上 ITU-T 这几个 字 ， 例 如 ， 原 来 的 CCITT X.25 现在就称为 ITU-T X.25 。 为 了 节约 经 费 ， 以 后 不 再 是 每 隔
四 年 就 出 版 全 套 的 建 议 书 ， 而 是 只 出 版新通过 的 建 议书 或 旧 建议 书 中 有变 化 的 部 分 。 CCITT 虽 然 不 存在 了 ， 但过去 CCITT 所制
定 的标 准 并 未 作 废 ， 凡 未 过 时 的 标准我们 在 需 要 时 都可继续 引 用 。

• 2 9  •

］＿机 l

文件传送校块

通 信 服 务 模 块

网 络桵 入校块

叉 件 及 文 件 传这 命 令

与 迫 信 有 关 的 报 又

图 1 - 1 5 划 分层 次 举例

主机 2

义件传送模块

迫 估 服 务 模 块

网络接入模块

但 是 ， 我 们 并 不 想 让 文 件 传 送 模 块 完 成 全 部 工 作 的 细 节 ， 这 样 会 使 文 件 传 送 模 块 过 千
复 杂 。 可 以 再 设 立 一 个通信 服务模块 ， 用 来 保 证 文 件 和 文 件 传 送 命 令 可 靠 地在 两 个 系 统 之 间
交 换 。 这 就是 我 们 要做 的 第 二 类 工 作 。 也 就 是 说 ， 让 位 千 上 面 的 文 件传送模块利 用 下 面 的 通

信 服 务模块所提 供 的 服 务 。 我 们 还 可 以 看 出 ， 如 果将 位 千 上 面 的 文件传送模块换成 电 子 邮件

模块 ， 那 么 电了 邮 件 模块 同 样 可 以 利 用 在 它 下 面 的 通信 服 务模块所提供 的 可靠 通 信 的 服 务 。

我 们 要 做 的 第 三 类 工 作 可 以 是 再 构 造 一 个 网 络 接 入 模 块 ， 让 这 个 模 块 负 责 做 与 网 络 接

口 细 节 有 关 的 工 作 ， 并 向 上层 提 供服 务 ， 使 上 面 的 通 信 服 务模块 能 够 完 成 可靠通信 的 任 务 。

从上述 的 简 单 例 子 可 以 更 好 地理解分层 能 带 来很 多 好 处 ， 如 ：
( l ) 各 层 之 间 是独立 的 。 某 一 层 并 不 需 要 知 道 它 的 下 一 层 是 如 何 实 现 的 ， 而仅 仅 需 要 知

道 该 层 通 过 层 间 的 接 口 （ 即 界面 ） 所提 供 的 服 务 。 由 千 每 一 层 只 实 现 一 种 相 对 独立 的 功 能 ，
因 而 可将 一 个 难 以 处理 的 复杂 问 题 分 解 为 若 干 个 较 容 易 处理 的 更 小 一 些 的 问 题 。 这 样 ， 整 个
问 题 的 复杂 程 度 就 下 降 了 。

(2) 灵 活性 好 。 当 任 何 一 层 发 生 变 化 时 （ 例 如 由 于 技 术 的 变化 ） ， 只 要 层 间 接 口 关 系 保
持 不 变 ， 那 么 在 这 层 以 上 或 以 下 各层 均 不 受影 响 。 此外 ， 对 某 一层 提 供 的 服 务 还 可 进 行 修 改 。
当 不 再 需 要 某 层 提供 的 服 务 时 ， 甚 至 可 以 将 这 层 取 消 。

(3) 结构上可分割 开 。 各层 都 可 以 采 用 最 合 适 的 技 术 来 实 现 。
(4) 易 千 实现和维护 。 这 种 结 构 使 得 实 现 和 调 试 一 个 庞 大 而 又 复 杂 的 系 统 变 得 更 加 容 易 ，

因 为 整 个 系 统 已 被 分 解 为若 干 个 相 对 独立 的 子系 统 。

(5) 能促进标准化工作 。 因 为 每 一 层 的 功 能 及 其 所提 供 的 服 务 都 已 有 了 精 确 的 说 明 。
分 层 时 应 注 意 使 每 一 层 的 功 能 非 常 明 确 。 若 层 数 太 少 ， 就 会 使 每 一 层 的 协 议 太 复 杂 ；

但 层 数 太 多 又 会 在 描 述 和 综 合 各层 功 能 的 系 统工 程 任 务 时 遇 到 较 多 的 困 难 。 通 常 各 层 所 要 完
成 的 功 能 主 要 有 以 下 一 些 （ 可 以 只 包括 一 种 ， 也 可 以 包 括 多 种 ） ：

句 差错控制

使 相 应 层 次 对 等 方 的通信 更 加 可 靠 。

＠ 流量控制

发送端 的 发送速 率 必 须 使接 收端 来 得 及 接 收 ， 不 要 太 快 。

＠ 分段 和 重 装

＠ 复 用 和 分用

发送端将 要 发送 的 数 据 块划 分 为 更 小 的 单位 ， 在接收端将其还 原 。
发送喘 几个 高 层 会 话 复 用 一条 低 层 的 连接 ， 在 接 收 端 再 进 行 分 用 。
交 换 数据 前 先 建 立 一 条逻辑连接 ， 数据传 送 结 束 后释放连接 。

＠ 连接建立和释放
分 层 当 然 也 有 一 些 缺 点 ， 例 如 ， 有 些 功 能 会 在 不 同 的 层 次 中 重 复 出 现 ， 因 而 产 生 额 外

开 销 。

计算机 网 络 的 各 层 及 其协议 的 集 合 就 是 网 络 的 体 系 结构 (architecture) 。 换种 说 法 ， 计算
机 网 络 的 体 系 结 构 就 是 这 个计算机 网 络及 其 构件 所 应 完成 的 功 能 的 精 确 定 义 [GREE82] 。 需

•  30  •

要 强调 的 是 ： 这 些 功 能 究竟 是 用 何种 硬件或软件 完 成 的 ， 则 是 一 个遵循这种 体 系 结 构 的 实 现
(implementation) 的 问 题 。 体 系 结 构 的 英 文 名 词 architecture 的 原 意 是 建 筑 学 或 建 筑 的 设 计 和
风 格 。 它 和 一 个 具 体 的 建筑 物 的 概 念 很 不 相 同 。 例 如 ， 我们 可 以 走进 一 个 明 代 的 建 筑物 中 ，
但 却 不 能 走 进 一 个 明 代 的 建筑 风 格 之 中 。 同 理 ， 我 们 也 不 能把一 个 具 体 的 计 算机 网 络 说 成 是
一 个 抽 象 的 网 络 体 系 结 构 。 总 之 ， 体 系结构是抽 象 的 ， 而实现则 是 具体 的 ， 是真正在运行的
计算机硬件和 软件 。

扫 一 扫

1 .7.3  具 有 五 层 协 议 的 体 系 结 构

OSI 的 七层 协 议 体 系 结 构 （ 如 图 1 - 1 6(a)所 示 ） 的 概 念 清 楚 ， 理 论 也 较

完 整 ， 但 它 既 复杂 又 不 实 用 。 TCP/IP 体 系 结 构 则 不 同 ， 它 现 在 得 到 了 非 常 聪霆耘

广 泛 的 应 用 。 TCP/IP 是 一 个 四 层 的 体 系 结 构 （ 如 图 1 - 1 6(b)所 示 ） ， 它 包含
应 用 层 、 运 输 层 、 网 际层 和 链 路 层 （ 网 络 接 口 层 ） 。 用 网 际 层 这 个 名 字 是 强 调 本 层 解 决 不 同

视肋讲解

网 络 的 互连 问 题 。 在 互联 网 的 标 准 文档 [RFC 1 1 22,  STD3] 中 ， 体 系 结 构 中 的 底 层 叫 作 链路层 ，

但 接 着 又 说 明 了 链 路 层 就 是媒体接入层 。 但 也 有 把链 路 层 称 为 网 络接 口 层 的 [COME06] 或 子

网 层 的 [PETE 1 2] 。 从 实 质 上 讲 ， TCP/IP 只 有 最 上 面 的 三 层 ， 因 为 最 下 面 的 链 路层 并 没 有 属

千 TCP/IP 休 系 的 具 体协议 。 链 路 层 所 使 用 的 各种 局 域 网 标 准 ， 并 非 由 IETF 而 是 由 IEEE 的

802 委 员 会 下 属 的 各 工 作 组 负 责 制 定 的 。 在 讲授 计 算 机 网 络 原 理 时 往 往 采 取 另 外 的 办法 ， 即

综 合 OSI 和 TCP/IP 的 优 点 ， 采 用 如 图 1 - 1 6(C)所示 的 五层协议 的 体 系 结 构 ， 这 对 阐 述计 算 机

网 络 的 原 理 是 十 分方便 的 。

OSI 的 体 系 结 构

TCP/IP 的 体 系 结 构

五 层 协 议 的 体 系 结构

／

／

／

／

／

／

7

6

5

4

3

应 用 层 V
．表示层

J

应 用 层

（ 各 种 应 用 层 协 议 如
DNS, HTTP, SMTP 等 ）

／

会话层

V
运输层 V  运输层 ( TCP 或 UDP ) V
V

网 际层 1P

网 络 层

／
2  数据 链路层 ／
I

物理层

I/

(a) O S I 的 七 层 协 议

链路层 （ 网 络接 口 层 ）

（ 这 一层 并 没 有 具 体 内 容 ） V
( b )  TCP/IP 的 四 层 协 议

图 1 - 1 6 计 算 机 网 络 体 系 结 构

5

4

3

应 用 层

运输层

7
I/
网 络 层 v

2  数据链路层 V
I)

物理层

I

(c) 讲 述 原 理 的 五 层 协 议

现 在 结 合 互 联 网 的情 况 ， 自 上 而 下 地 、 非 常 简 要 地 介 绍 一 下 各 层 的 主 要 功 能 。 实 际 上 ，

只 有认 真 学 习 完 本 书 各 章 的协议 后 才 能 真 正 弄 清 各 层 的 作 用 。

( 1 ) 应 用 层(application layer)
应 用 层 是 体 系 结 构 中 的 最 高 层 。 应 用 层 的 任 务 是 通 过 应 用 进 程 间 的 交 互 来 完 成特定 网

络应用 。 应 用 层协议 定 义 的 是应 用 进程间通信和 交 互 的规则 。 这 里 的进 程 就 是 指 主 机 中 正在

运 行 的 程序 。 对 千 不 同 的 网 络 应 用 需 要 有 不 同 的 应 用 层协议 。 互 联 网 中 的 应 用 层 协 议 很 多 ，
如 域 名 系 统 DNS 、 支 持 万 维 网 应 用 的 HTTP 协议 、 支 持 电 子 邮 件 的 SMTP 协 议 ， 等 等 。 我
们 把 应 用 层 交 互 的 数据 单 元 称 为报文(message) 。

•  3 1  •

(2) 运输层(transport layer)
运 输层的任 务 就 是 负 责 向 两 台 主 机 中 进 程 之 间 的 通信提供通 用 的 数 据传输服务 。 应 用
进 程 利用 该服务传送应 用 层 报 文 。 所谓 “ 通 用的
， 是指 并 不 针 对 某 个 特 定 网络应 用 ， 而 是
多 种 应用 可 以 使用 同 一个运输层服务 。 由千 一 台 主机可 同 时 运 行 多 个进程 ， 因 此运输层有复
用 和分 用 的功能。 复用 就 是 多 个应 用 层进程可 同 时使 用 下面运输层的服 务 ， 分 用 和复用 相反，
是运输层把收到的信 息 分 别 交付上面应 用 层中的相 应进程 。

＂

运输层主要使用 以 下 两种 协 议：
•  传输控制协议 TCP (Transmission  Control  Protocol}-—－提供面 向 连接的、 可 靠的数

据传输服务 ， 其数据传输的单位是报文段(segment) 。

•  用 户 数据报协议 UDP (User Datagram  Protocol}-－－提供无连接的尽最大努力 (best­
effort)的数 据 传 输 服 务 （不 保 证 数 据 传 输的可 靠 性 ）， 其 数 据 传 输的单 位 是 用 户 数
据报 。

顺 便指出 ， 有人愿意把运输层 称 为传输层 ， 理由是这 一层 使 用 的 TCP 协议 就 叫 作传输
控制 协 议 。 从意思上看， 传输和运输差 别 也 不 大 。 但 OS I 定 义的第 4 层 使 用 的是 Transport ,
而不是 Transmission 。 这两个词的含义还是有些差别的。 因 此 ， 使用 运输层这个译 名 较为准确 。

(3) 网络层(network layer)
网络层 负 责 为 分 组 交 换网 上的不 同 主机提供 通 信 服 务 。 在发送 数据 时 ， 网络层 把 运 输
层 产 生的报 文段或用 户 数据 报封装成分组或包进行传送 。 在 TCP/IP 体 系 中 ， 由千网络层使
作
用 IP 协 议 ， 因 此分组 也 叫 作 IP 数据报 ， 或简称为数据报 。 本 书 把
为 同 义词使用 。

数据报

分组

和

”

”

“

“

请注意： 不要将运输层的 “ 用 户 数据报协议 UDP " 和 网络层的 “IP 数据报 ＂ 弄 混 。 此

外 ， 无论在 哪一层 传 送 的 数 据单 元 ， 都可笼统地用

“

”

分组

来表示 。

网络层的具 体 任 务有两 个 。 第一 个 任 务 是通过一 定的算法 ， 在 互 联 网 中的每 一 个 路 由
器 上 生 成一个用 来转发分组的转发表 。 第二个任务较为 简 单 ， 就 是 每一个路由器在接收到一
个分组时 ， 依据转发表中指 明 的路径把 分组转发到下 一 个路 由 器 。 这样就可 以 使源主机运输
层所传 下 来的分组 ， 能够通过合适的路由最 终到达 目 的主机 。

这 里 要 强 调 指 出 ， 网络层 中的 “ 网 络
在 计算机网络体 系 结 构 模 型 中的第3 层的名 称 。

”

二字 ， 已 不 是 我 们 通 常 谈 到的具 体网络， 而 是

互联网 是 由大量的异构(heterogeneous)网络通过路 由 器 (router)相 互 连 接 起 来的 。 互联网
使用的网络层 协议是无连接的网 际协议 IP (Internet  Protocol)和许 多 种 路由选择协议 ， 因 此互
联 网 的 网络层 也 叫 作 网 际层 或 IP 层 。 在 本 书 中 ， 网络层 、 网 际层和 IP 层都是 同 义语 。

(4) 数 据链路层(data link layer)
数 据 链 路 层 常 简 称 为链 路层 。 我 们 知 道 ， 两 台 主机之 间 的数 据 传 输 ， 总 是在 一段 一 段
的链 路上传送的， 这 就 需 要 使 用 专 门的链路层的协议 。 在 两 个相 邻 节 点 之 间 传 送数据 时 ， 数
据链路层将网络层 交 下 来的 IP 数 据 报组装成帧 ( framing ) ， 在 两 个相 邻 节 点 间的链 路 上传
送帧 ( frame ) 。 每 一 帧 包 括 数据和必 要的控制 信 息 （如 同 步 信 息 、 地址信 息 、 差错控制 等 ）。
在 接 收 数 据 时 ， 控 制 信 息 使 接 收端能够 知 道 一 个 帧 从 哪 个 比 特 开 始 和 到 哪 个 比 特 结 束 。

这样 ， 数据链路层在 收到一个 帧 后 ， 就可从中提取出数据 部 分 ， 上交给网络层 。

控 制 信 息 还 使 接 收 端 能够 检 测 到 所 收 到的帧中有无 差 错 。 如发现有差错 ， 数 据 链 路 层

就简 单地丢弃这个出 了 差错的帧 ， 以免继续在网络中传送 下 去 臼 臼 浪 费 网络资 源 。 如 果 需 要

• 3 2  •

改 正 数据 在 数据 链 路 层 传 输 时 出 现 的 差 错 （ 这 就 是 说 ， 数 据 链 路 层 不 仅 要 检 错 ， 而 且 要 纠

错 ） ， 那 么 就 要 采 用 可 靠 传 输 协 议 来 纠 正 出 现 的 差 错 。 这 种 方 法会 使 数据 链 路 层 的 协 议 复 杂

些 。

(5) 物理层(physical layer)
在 物 理 层 上 所 传 数 据 的 单位 是 比特 。 发 送 方 发送 l

0 ) 而 不 是 0 （ 或 1 ） 。 因 此物 理 层 要 考 虑 用 多 大 的 电 压 代 表

（ 或
“ 0 "' 以 及接 收方 如 何识
别 出 发送 方 所 发 送 的 比特 。 物 理 层 还 要 确 定 连接 电缆 的 插 头 应 当 有 多 少 根 引 脚 以 及 各 引 脚应
如 何连接 。 当 然 ， 解释 比特代表 的 意 思 ， 不 是物 理 层 的 任务 。 请 注 意 ， 传 递信 息 所利 用 的 一
些物理传输媒体 ， 如 双绞 线 、 同 轴 电 缆 、 光 缆 、 无 线 信 道 等 ， 并 不 在物 理 层 协 议之 内 ， 而 是
在 物 理 层 协 议 的 下 面 。 因 此 也 有 人把物理层 下 面 的物理传输媒 体 当 作 第 0 层 。

（ 或 0 ) 时 ， 接 收 方 应 当 收到 1

” 1 " 或

在 互联 网 所使 用 的 各种 协 议 中 ， 最 重 要 的 和 最 著 名 的 就 是 TCP 和 IP 两 个 协 议 。 现 在 人
们 经 常 提 到 的 TCP/IP 并 不 一 定 是 单 指 TCP 和 IP 这 两 个 具 体 的 协 议 ， 而 往 往 是 表 示 互 联 网
所 使 用 的 整 个 TCP/IP 协议族(protocol suite)气

图 1 - 1 7 说 明 的 是 应 用 进程 的 数 据 在 各层 之 间 的 传 递 过 程 中 所经 历 的 变化 。 这 里 为 简 单

起 见 ， 假 定 两 台 主 机通 过一 台 路 由 器连接起来 。

主机 2

图 1 - 1 7 数据在各层之 间 的 传 递过程

假 定 主 机 1 的 应 用 进程 AP 1 向 主机 2 的 应 用 进 程 AP2 传送数据 。 AP 1 先将其数据 交给本
主 机 的第 5 层 （ 应用 层 ） 。 第 5 层 加 上 必 要 的 控 制 信 息 儿 就变 成 了 下 一 层 的 数据 单 元 。 第 4
层 （ 运输层 ） 收 到 这 个 数 据 单 元 后 ， 加 上本 层 的 控 制 信 息 H4 , 再 交给第 3 层 （ 网 络 层 ） ， 成
为 第 3 层 的 数 据 单 元 。 依此类推 。 不 过 到 了 第 2 层 （ 数据链路层 ） 后 ， 控 制 信 息 被 分 成 两 部
分 ， 分 别 加 到 本 层 数 据 单元 的 首 部 ( H2 ） 和 尾 部 ( T正 而第 1 层 （ 物 理层 ） 由 千 是 比特流

的 传 送 ， 所 以 不 再 加 上控 制 信 息 。 请注 意 ， 传送 比 特 流 时 应 从 首 部 开 始 传送 。

OSI 参 考 模 型 把 对 等 层 次 之 间 传 送 的 数 据 单 位 称 为 该 层 的协议数据单元 PDU (Protocol

Data Unit) 。 这 个 名 词 现 已 被许 多 非 OSI 标 准 采 用 。

当 这 一 串 的 比 特 流 离 开 主 机 1 经 网 络 的 物 理传 输 媒体 传 送 到 路 由 器 时 ， 就从路 由 器 的

第 1 层 依 次 上 升 到 第 3 层 。 每 一层 都根 据 控制 信 息进 行 必 要 的 操作 ， 然 后 将 控制 信 息 剥 去 ，

句 注 ： 请注意 suite 这 个 词 的 特殊读音／swi :t/ ， 不要 议 错 。

•  3 3  •

将 该 层 剩 下 的 数据 单 元 上 交 给 更 高 的 一 层 。 当 分 组 上 升 到 了 第 3 层 网 络 层 时 ， 就根据 首 部 中
的 目 的 地 址 查 找 路 由 器 中 的 转发 表 ， 找 出 转 发 分 组 的 接 口 ， 然 后 往 下传 送 到 第 2 层 ， 加 上 新
的 首 部 和 尾 部 后 ， 再 到 最 下 面 的 第 1 层 ， 然 后 在 物 理 传 输媒体上把每 一 个 比特 发送 出 去 。

当 这一 串 的 比 特 流 离 开路 由 器 到 达 目 的 站 主 机 2 时 ， 就 从 主机 2 的 第 1 层 按 照 上面 讲
过 的 方式 ， 依 次 上 升 到 第 5 层 。 最 后 ， 把应 用 进程 AP 1 发 送 的 数据 交 给 目 的 站 的 应 用 进 程
AP2 0

可 以 用 一 个 简 单 例 子 来 比 喻 上 述 过 程 。 有 一 封 信 从 最 高 层 向 下 传 。 每 经 过 一 层 就 包 上

一 个新 的 信 封 ， 写 上 必 要 的地址信 息 。 包 有 多 个信 封 的 信 件传送 到 目 的 站 后 ， 从第 1 层 起 ，
每 层 拆 开一 个 信 封 后 就把信 封 中 的 信 交给它 的 上 一 层 。 传 到 最 高 层 后 ， 取 出 发 信 人 所 发 的 信
交给收信 人 。

虽 然应 用 进 程 数 据 要 经 过 如 图 1 - 1 7 所示 的 复 杂 过 程 才 能 送 到 终 点 的 应 用 进 程 ， 但 这 些

复 杂 过程 对 用 户 屏 蔽掉 了 ， 以致应用 进 程 AP 1 觉 得好 像 是 直 接 把 数 据 交 给 了 应 用 进程 AP沪
同 理 ， 任 何两 个 同 样 的 层 次 （ 例 如 在 两 个 系 统 的 第 4 层 ） 之 间 ， 也 好 像 如 同 图 1 - 1 7 中 的 水

平 虚 线 所 示 的 那 样 ， 把数据 （ 即 数据 单元 加 上控 制 信 息 ） 通 过 水 平虚线 直接传递给对方 。 这
” (peer layers)之 间 的 通 信 。 我们 以 前 经 常 提 到 的 各层 协 议 ， 实 际 上 就

就 是所 谓 的

对等层

“

是 在 各 个 对 等层 之 间 传递 数 据 时 的 各项 规 定 。

在 文 献 中 也 还 可 以 见 到 术 语 “ 协议栈 " (protocol stack) 。 这 是 因 为 几 个 层 次 画 在 一 起 很

像 一 个栈(stack) 的 结 构 。

1 . 7.4  实体 、 协议 、 服务和 服务访 问 点

当 研 究 开 放 系 统 中 的 信 息 交换 时 ， 往 往 使 用 实体(entity)这 一 较 为抽 象 的 名 词 表示任何可

发 送 或接收信 息 的 硬件或软件进程 。 在 许 多 情况 下 ， 实 体 就 是 一 个特定 的 软件 模 块 。

协议 是控制 两 个 对 等 实 体 （ 或 多 个 实 体 ） 进行通信 的 规则 的 集 合 。 协 议 的 语 法 方 面 的

规 则 定 义 了 所 交换 的 信 息 的 格 式 ， 而 协 议 的 语义 方 面 的 规 则 就 定 义 了 发送者或接收者所 要 完

成 的 操 作 ， 例 如 ， 在 何 种 条件 下 ， 数据 必 须重传或 丢 弃 。

在协议 的 控制 下 ， 两 个 对等 实 体 间 的 通信 使 得 本 层 能 够 向 上 一层 提 供 服 务 。 要 实 现 本

层协议 ， 还需要使 用 下面 一层 所提供 的 服 务 。

一 定 要 弄清 楚 ， 协 议 和 服 务 在 概 念 上 是 很 不 一 样 的 。
首 先 ， 协 议 的 实 现 保 证 了 能 够 向 上 一 层 提 供 服 务 。 使 用 本 层 服 务 的 实 体 只 能 看 见 服 务

而 无法看见下 面 的 协议 。 也 就 是 说 ， 下 面 的 协议对上 面 的 实体是透 明 的 。

“

＂

＂

水 平 的

， 即 协 议 是 控 制 对 等 实 体 之 间 通 信 的 规 则 。 但 服 务 是

垂 直
其 次 ， 协议 是
， 即 服 务 是 由 下 层 向 上 层 通 过层 间 接 口 提 供 的 。 另 外 ， 并 非 在 一 个 层 内 完 成 的 全 部 功 能
。 上 层 使 用
看得见

的
都 称 为 服 务 。 只 有 那 些 能 够 被 高 一 层 实 体
下 层 所提供 的 服 务 必 须通 过 与 下 层 交 换 一些 命 令 ， 这 些 命 令 在 OSI 中 称 为服 务 原 语 。

的 功 能 才 能 称 之 为

服 务

“

“

”

＂

＂

在 同 一 系 统 中 相 邻 两 层 的 实 体 进 行 交 互 （ 即 交 换 信 息 ） 的 地 方 ， 通 常 称 为 服 务 访 问 点
SAP  (Service  Access  Point) 。 服 务 访 问 点 SAP 是 一 个抽 象 的 概 念 ， 它 实 际上 就 是 一 个逻辑接
口 ， 有 点 像 邮政 信 箱 （ 可 以 把 邮 件 放 入 信 箱 和 从 信 箱 中 取 走 邮 件 ） ， 但 这 种 层 间 接 口 和 两 个
设 备 之 间 的 硬 件接 口 （ 并 行 的 或 串 行 的 ） 并 不 一 样 。 OSI 把层 与 层 之 间 交换 的 数据 的 单 位 称
为服务数据单 元 SDU (Service  Data  Unit) ， 它 可 以 与 PDU 不 一样 。 例 如 ， 可 以 是 多 个 SDU
合 成 为 一 个 PDU , 也 可 以 是 一 个 SDU 划 分 为 几 个 PDU 。

•  34  •

这 样 ， 在 任 何 相 邻 两层 之 间 的 关 系 均 可概括 为 图 1 - 1 8 所 示 的 那 样 。 这 里 要 注 意 的 是 ，

“

第 n 层 的 两 个
之 间 则 通 过 另 外 的 “ 协议(n +  1 ) " 进 行通信 （ 每 一层 都 使用 不 同 的协议 ） 。 第 n 层 向 上面 的

实体(n) " 之 间 通 过 “ 协议(n) " 进 行 通 信 ， 而第 n + l 层 的 两 个 “ 实体(n +  1 ) "

第 n +  1 层所 提供 的 服务 实 际 上 已 包括 了 在 它 以 下 各 层 所 提 供 的 服务 。 第 n 层 的 实体 对 第 n
” ,
+  1 层 的 实体 就 相 当 千 一 个 服 务 提 供 者 。 在 服务 提供 者 的 上 一 层 的 实 体 又 称 为 “

服 务用 户

因 为 它 使 用 下 层 服 务 提 供 者 所 提 供 的 服 务 。

－ － － － － － － － － － － － － － － － － － － － - － － － － － － － － － － － － － － 1

服 务用 户--f I实体(n +1） 卜－－－－

,-

协议(n+ 1 )  ---1实 体(n+1 )I i

－ －－

I

第 n+ 1 层

服 务提供者

－—

-｝［＿实/f(/i)

畸-- - - -－协 议(n)--- - -
l _ ＿ ＿ ＿ ＿ _ ＿ ＿ ＿ ＿ ＿ ＿ ＿ _ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ _. ..:. ＿ ＿ ＿. ..:.吵_ ＿ l

|

心

第 n 层

图 1- 1 8相 邻 两 层 之 间 的 关 系

计 算 机 网 络 的 协 议 还 有 一 个 很 重 要 的 特 点 ， 就 是 协 议 必 须 把 所 有 不 利 的 条 件 事 先 都 估
计 到 ， 而 不 能假定一切都是正 常 的 和 非 常理想 的 。 例 如 ， 两 个朋 友在 电话 中 约 好 ， 下 午 3 时
在 某 公 园 门 口 碰 头 ， 并 且 约 定 “ 不 见不 散
。 这 就 是 一 个 很 不 科 学 的 协 议 ， 因 为 任 何 一 方 临
时 有 急 事 来 不 了 而 又 无 法通 知 对 方 时 （ 如 对 方 的 电话 或 手 机 都 无法接通 ） ， 则 另 一 方 按 照 协
议 就 必 须 永 远 等 待 下 去 。 因 此 ， 看 一 个 计 算机 网 络 协 议 是 否 正 确 ， 不 能 只 看 在 正 常情 况 下 是
否 正 确 ， 还 必 须 非 常 仔 细 地检查协议能否应 付任何一种 出 现概率极 小 的 异 常情况 。

＂

下 面 是一 个 有 关 网 络协议 的 非 常 著 名 的 例 子 。

【 例 1-1 】 占据 东 、 西 两个 山 顶 的 蓝 军 1 和 蓝军 2 与 驻 扎 在 山 谷 的 白 军 作 战 。 其 力 量对

比 是 ： 单 独 的 蓝 军 1 或蓝 军 2 打 不过 臼 军 ， 但 蓝 军 1 和 蓝 军 2 协 同 作 战 则 可 战 胜 白 军 。 现 蓝

军 1 拟 于 次 日 正 午 向 白 军 发起攻击 。 千 是 用 计 算 机 发 送 电 文 给 蓝 军 2 。 但 通 信 线 路 很 不 好 ，
电 文 出 错 或 丢 失 的 可 能 性 较 大 （ 没有 电 话 可 使 用 ） 。 因 此要 求 收 到 电 文 的 友 军 必 须 送 回 一 个
确 认 电 文 。 但 此确 认 电 文 也 可 能 出 错或 丢 失 。 试 问 能 否 设 计 出 一 种协议 使 得 蓝 军 1 和 蓝 军 2
能 够 实 现协 同 作 战 因 而 一 定 （ 即 1 00 ％而 不 是 99.999 … % ） 取得胜利 ？

【 解 】 蓝 军 1 先 发送 ：

“

拟 于 明 日 正 午 向 臼 军 发起 攻 击 。 请协 同 作 战 和 确 认 。

”

假 定 蓝 军 2 收 到 电 文 后 发 回 了 确 认 。

然 而现 在 蓝 军 1 和 蓝 军 2 都 不 敢 下 决 心 进 攻 。 因 为 ， 蓝 军 2 不 知 道此确 认 电 文 对 方 是

否 正确 地 收到 了 。 如 未 正 确 收 到 ， 则 蓝 军 1 必 定 不 敢 贸 然进攻 。 在此情 况 下 ， 自 己 单 方 面 发
起进攻就肯 定 要 失败 。 因 此 ， 必 须 等 待 蓝 军 l 发送 “ 对 确 认 的 确 认 "。

假 定 蓝 军 2 收到 了 蓝 军 l 发来 的 确 认 。 但 蓝 军 l 同 样 关 心 自 已 发 出 的 确 认 是 否 已 被对

方 正 确 地收到 。 因 此还 要 等 待 蓝 军 2 的

“

对 确 认 的 确 认 的 确 认

＂

。

这 样 无 限 循环 下 去 ， 蓝 军 1 和 蓝军 2 都始终无法 确 定 自 己 最 后 发 出 的 电 文 对 方是 否 已
经 收 到 （ 如 图 1 - 1 9 所 示 ） 。 因 此 ， 在 本 例 题给 出 的 条 件 下 ， 没有 一 种协议 可 以 使 蓝 军 1 和 蓝
军 2 能 够 1 00％地 确 保胜 利 。

•  3 5  •

西 边蓝 军

东 边蓝 军

三 明 日 正 午 向 臼 军 发起 攻 卢」

确 认

尸

仁才

对 “确 认 ＂ 的 确 认

因 (

“确 认 ＂ 的 确认） 一的确 认十二＞

图 1 - 1 9 无 限循 环 的 协议

这个例子告诉我们 ， 看似非 常 简 单的协议 ， 设 计起来要考虑的问 题还是 比 较 多的。

1 .7.5 TCP/IP的 体 系 结 构

前面 已经说过 ， TCP/IP 的体系 结 构 比较 简 单 ， 它 只 有 四 层 。 图 1 -20 给出 了 这种 四 层 协

议表示方法的例 子 。

主 机 A

主 机 B

图 1 -20 TCP/IP 四 层 协议 的 表示方法举例

应 当 指 出 ， 技 术的发展 并 不 遵 循 严 格的 OSI 分 层 概 念 。 实 际 上 现 在的互 联 网 使 用 的
TCP/IP 体 系 结 构 有 时 已经演 变成为 图 1 -2 1 所 示的那 样 ， 即 某些应用 程序可 以 直接使用 IP 层 ，
或 直 接 使 用 最 下 面的链 路 层 [PETE 1 2] 。 虽然 TCP/IP 协 议 族 得 到 了 非 常广泛的应 用 ， 但对

TCP/IP 体 系 结 构的批评意见 也有不少 。 例 如 ， 这个体 系 结 构 没有 清 晰地阐 明 区 分 开 服 务 、
接 口 和协 议 之 间的关 系 ， 而链路层 并非真正的一 个层 次 ， 而仅仅是强调 了 IP 层 需 要这样 一
个与 网络的接 口 。 这个体 系 结 构 没有把重要的物理层和链路层的内容包含进来 。

应 用 层

TCP

I  UDP

[P

链路层 （ 网 络接 口 层 ）

图 1 -2 1 TCP/IP 体系 结 构 的 另 一 种表示方法

还 有 另 一种 方法用 来表示 TCP/IP 协议族 （ 如 图 1 -22 所示） ， 它的特 点 是 上 下 两头大 而
中 间 小： 应 用 层和网络接 口 层 都 有 多 种 协 议 ， 而 中 间的 IP 层很小 ， 上 层的各种 协 议 都 向 下

• 3 6  •

汇 聚 到一个 IP 协议 中 。 这种很像沙漏 计 时 器 形状的 TCP/IP 协 议族表 明 ：
种 运 输 层 协 议 （虽然这里 只 画 出 了 最 主 要的两种 ）， 而 不 同的运输层 协 议 上 面又 可 以 有 多 种
应 用 层 协 议 （所谓的 everything over  IP ) ， 同 时 I P 协议也可 以在 多 种 类 型的网络上运 行 （所
谓的 IP over  everything ) 。 正 因 为 如此， 互联网才会发展到今天的这种全球规模 。 从 图 1 -22
不难看出 IP 协 议在 互 联网 中 的核 心 作 用 。

IP 层 可 以 支 持 多

应 用 层

， H I  I .... . …
-－－-－－-壬~--－-－－－－-－-－-----－－－----－－--《

运输层

- －7-－－－-－－会 一 一 一 一 一 一 一＼一 一 一一了一 一 一 一 一 一 一 一 一 一 一 一 一----

I

L

I

L

-----------------------------------------------－ 一一、--－ － －--－－-- 一 一_,_----------------------------

网 际层

- - - - - - - - - - - - - - - - - - - - - - - - -

数 据 链 路 层

�

�

- - - -

- - - - - -

--s=—二

图 1 -22 沙漏计时 器 形 状 的 TCP/IP 协议族示意

实 际 上 ， 图 1 -22 还反映 出 互 联 网的一 个 十 分重要的设计理念， 这就是网络的核 心 部 分

越 简 单越好， 把一切复杂的部 分 让 网络的边缘 部 分 去 实 现 。

【 例 1-2 】 利 用 协 议栈的概念， 说 明在 互联网中常 用的客户 －服务器工作 方 式 。

【 解 】 图 1 -23 中的主机 A 和主机 B 都各 有 自 己的协议栈 。 主机 A 中的应 用 进 程 （即 客

户 进程 ） 的位置在最 高的应用 层 。 这 个客 户 进程 向 主机 B 应 用 层的服务器进程发出请求，

请求建立 连接 （图 中 的O ) 。 然后 ， 主机 B 中 的服务器进程接受 A 的客户 进程发来的请求

（ 图 中 的＠ ）。 所有这 些通 信 ， 实 际上 都 需要 使 用 下 面 各 层 所提供的服 务 。 但若仅 仅 考 虑 客

户 进程和服务器进程的交 互 ， 则 可把 它 们 之 间的交 互看成是 图 1 -23 中的水平虚 线 所 示的那

样 。

-

-

0 发起连接建立请求

－

－

-

-

-

－

－

－

－

－

－

＿

＿

＿

＿

＿

＿

＿

＿

＿

＿

＿

-

-

-

－

－

＿

＿

＿

＿

＿

＿

＿

A

运 输 层

网 络 层

数 据 链 路 层

＠ 接 受连接建立请求

运输层

网 络 层

数 据 链 路 层

图 1 -23 在应用 层 的 客 户 进程和服务器进程 的 交 互

图 1 -24 画 出 了 三 台 主机的协议栈 。 主机 C 的应用 层 中 同 时 有 两个服务器进程在通信 。

服务器 l 在和主机 A 中的客户 l 通信 ， 而服务器 2 在和主机 B 中的客户 2 通信 。 有的服 务

器进程可 以 同 时 向 几 百 个 或 更 多的客 户 进 程提供服务 。

•  37  •

