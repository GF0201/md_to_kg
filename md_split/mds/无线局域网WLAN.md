第 9 章 无线 网络和 移动 网 络

近 几十 年 来， 无线 蜂 窝 电话 通信 技 术 得到了 飞 速发展 。 现在移 动 电话数已经 超 过了 发
展 历 史 达一 百 多 年 的固 定电话 数。 据 I TU 的统计 ， 在 2015 年 ， 全 世 界 移 动 电话的普 及率
已 达到 96 .8% [W- I TU]， 大 大超 过了 当 时固 定电话 14.5％的普 及率。 据工信 部 2020年 上半 年
的统计 ， 我 国 的移 动 电话用户已超 过15 . 9亿 户， 也 大大超 过了固 定电话的用户数 1.88亿 户
（固 定 电话的总 数仍 在逐 年 下 降 ）。

对移 动 通信的 这种需 要也 必 然反 映 到计 算 机 网 络中。 人 们 也 希 望 能够 在移 动 中使 用计

算 机网 络。 如果 说， 互联网 在过去 曾 是 PC 互联网， 那么现在就应 当 是移动互联 网 了。

由于 无线 网络 和移 动 网络的数据链路层与传 统 的有 线 互联网的数据链路层 相差 很大 ，

因此 有 必要单 列一 章 来讨 论 这个问题 。

本 章 先讨论无线 局 域 网 WLAN , 其重点 是无线 局 域 网 MAC 层协 议载波 监 听多点接 入／
碰撞避 免 CSMA /CA 的 原理； 接着对无线 个人 区 域 网 W PAN 和无线城域 网 WMAN 进行简
单的介 绍 ； 最后 简要介绍 一 下蜂 窝 移动 通信 网 。 本 来， 这种蜂 窝 移 动 通信 网属 于 通信领域 的
内容 ， 与计算 机网络并 无关联。 但 是随 着 技 术的 发展 ， 情况 发生 了 根本 的 变化 ： 蜂 窝 移动 通
信网已演 进到全 部 使 用 I P技 术 。 按照计算 机网络对主 机的 定义 ， 现在的智 能手 机已经 变成
了 计 算 机网 络上的主机 。 因此 在本 书 中也 应对无线 蜂 窝 通信 网进行适 当的介 绍 。

本 章 最重 要的内容 是：
( 1) 无 线 局 域 网的 组成 ， 特 别是 分配 系 统 DS(D istribution Sy stem) 和接入点 A P(A ccess

Point)的作 用。

(2) 无线 局 域 网使 用的 CSMA /CA 协 议 （弄清与载波 监 听 多点接 入／碰撞检 测 CSMA/CD

的区 别） 和 无线 局 域 网 MAC 帧 使 用的几种地址 。

(3) 蜂 窝 移动 通信 网的基本概念 以及与 互联网 互 连 的方法。

9. 1  无线局域网 WLAN

在局 域 网刚 刚 问 世 后 的一 段 时间， 无线 局 域 网的 发展 比 较 缓 慢 ， 原 因是价格 贵 、 数据
传 输速率低、 安 全 性较差 ， 以及使用登 记手续复杂 （ 使 用无线 电 频 率 必须得到有关 部 门 的批
准）。 但 自 20 世 纪 80 年代末 以来， 由千 人们 工 作 和生 活节奏 的加快 以及移 动 通信技 术 的飞
速发展 ， 无线 局 域 网也就逐步进入市 场。 无线 局 域 网提供 了 移动接 入的功能 ， 这就 给许多 需
要发送数据但 又 不能坐 在办 公室 的工 作 人 员提供 了方便 。 当一 个工厂跨越 的面积 很大 时， 若
要将 各 个部门 都用电 缆 连接成 网， 其费 用可能 很高； 但 若使 用无线 局 域 网 ， 不 仅节省 了投 资 ，
另外 ， 当大量持 有便携式计算机 的用户 在一 个地方同时要求 上 网
而 且建 网的速度也会较快 。
时（如 在图书 馆或股 票交易 大厅 里）， 若 用电 缆 连 网， 恐 怕 连铺 设电 缆 的位 置 都很难找 到。

而用无线 局 域 网 则比较容 易 。 由千手 机普 及率日 益 增 高 ， 通过无线 局 域 网接 入到互联网已成
为当今 上网 最常 用的方式 。 无线 局 域 网常 简写 为WLAN (Wi reless L ocal  A rea Netw ork) 。

请读者注意， 便携站 (portable station) 和移动站 ( mobile station)表示 的意思 并 不一 样。 便

•  405  •

携 站 当然是便 于 移 动 的， 但便携站 在工 作 时 其位 置 是固 定不 变的。

而 移 动 站 不 仅能 够 移 动 ，

而 且还可以在移动 的 过程 中进行通信 （正 在进行的应 用程序感 觉 不到计算 机位置 的 变化 ， 也
不因计 算 机位置 的移动 而 中断 运行）。 移 动 站 一般 使用电 池 供 电 。

9. 1 . 1   无线 局 域 网 的 组成

无线 局 域 网可分为两 大 类。 第 一 类是有基础设施 的 ， 第 二 类是无 基础设施 的 。 本 章 主

要介 绍 第 一 类无线 局 域 网。

1 .   I EE E  802 . 1 1

对于第 一 类有基础设施 的 无线局域 网， 1997 年 IEEE 制 定 出 无线局域 网协 议802. 11系 列
标 准。 2003年 5 月 ， 我国颁布 了WL AN 的国 家 标 准， 该标 准采用1S0 /IEC 8802-11系 列 国 际
标 准， 并针对WL AN 的安 全 问题， 把国 家对密 码 算 法 和无线 电频 率的要求纳 入了进来。 它
是基 千国 际标 准的符合我国 安 全 规范 的 WL AN 标 准， 是属 于 国 家 强 制执 行的标 准。 该 国 标
在 2004年 6 月 已经 正式执 行， 不符合此标 准的WL AN 产 品 将 不允 许 出现 在国 内市 场上。

802. 11是个 相当复 杂 的标 准。 但 简单地 说， 802.11就是 无线 以太 网的标 准， 它使用星形

拓 扑 。 无线局 域 网的中心叫 作接入点 AP (
A ccess P oint)， 它 是 无线 局 域 网的基础 设施， 也 是
一个链路层 的设备 。 接 入点 AP 也叫 作 无线接入点 WAP (W ireless A ccess P oint)。 所 有 在无线

局 域 网 中的站点， 对网 内或网外的通信， 都必须通过接 入点 AP 。 现 在的无线 局 域 网的接 入
点 AP 往往 具 有 1 00 Mbit/s或 1Gbit/s的端 口 ， 用来 连接到有线 以 太 网。 家庭 使用的无线 局
域 网接 入点 AP , 为了方便 居 民 上网， 就把I P层 的 路由器的功能 也 嵌 入进来。 因此家 用的接
入点 A P往 往 又称为 无线 路由器（直接 用网线 连接到家 中墙 上的 RJ-45 插 孔即可 ）。 但 企业
或 机构 使用的接 入点 AP 还是 和 路由器分开的。

802.11 无线 局 域 网的 M AC 层 使用 CSM A /C A 协 议 （ 在后 面 的 9. 1 .3节讨 论）。 现在
802.11系 列 标 准的 无线 局 域 网 常称为W i-Fi。 曾 经广 为流传 的 “ W i-Fi是 W ireless-Fidelity 的
缩 写 “ 其实是错 误 的（本 书 的前几个版本 也 曾 这样写 过）。 这点 在 W i-Fi的官 网可以查 到[W­
WiFi]。 W i-Fi是非 营利性 国 际 组织 W i-Fi 联盟 (W i-Fi Alliance)的一个标记。 W i-Fi联盟对通过
其互操 作 性 测 试 的产 品 就 发 给这样的注册 商 标 。和 ， 表明 是经 过W i-Fi联盟认证 的。 从

2000 年起到2020 年 ， 全球 有 W i-Fi注册 商 标认证 的产 品 已超过15 0亿个。 W i-Fi的写 法并
无统一 规 定， 如W iFi, W ifi, W i-

fi等 都能 在 文献 中见到。

802.11标 准规 定 无线 局 域 网 的最小构件 是基本服务集 BSS (B asic Serv ice Se t)。 一个基本
服务集 BSS包括一个接 入点 和若干 个移动站 （这里所说的移动站 ， 也可包括 不经 常搬动 的台
式 电脑 。 这种 电脑 的主板 上 都装有W i-Fi适 配器）。 各站 在本 BSS以 内之 间的通信， 或者与外
部站点的通信， 都必须通过本 BSS的接 入点。 当网 络管理员安 装 AP 时，
必须为该 AP 分配
一个 不超过32字节的服务集 标 识符 SSI D (Serv ice Set IDentifier)(j) 和一个通信信道 。 SSID 就
是指使用该 AP 的 无线 局 域 网的名 字 。 SSID 使用字 符串 而 不使用二 进 制数字 的理由就是字

CD 注 ： 例 如 ， 对 千 使 用 Windows J O 的 计 算 机 ， 点 击

“

”

“

“

”

开 始
＂

- " Wi ndows 系 统

一

控 制 面 板

一

网 络 和 Internet "

”

“

”

“

一

网 络 和 共 享 中 心

， 下 面 有 三 个 选 项 ， 点 击

连接 到 网 络

， 就 可 以 看 见 在每 个 无线 局 域 网 的 覆 盖 范 围 内 的 网 络 名 SSID 。

这 些 网 络 名 可 以 由 设 备 AP 的 生 产 厂 家 预先给 出 ， 也可 以 由 局 域 网 的 管 理 员 更 改 为 另 外 的 名 字 。

•  406  •

符 串 便 千记忆 。 一 个基本服务集 B SS 所 覆 盖 的地理范 围 叫 作

一

个基 本 服务区 B SA ( Ba si c

S er vi ce A rea )。 基本服务区 B SA 和(cid:4876)线 移 动通信 的蜂 窝 小 区 相 似 。 (cid:4876) 线 局域网的基本服务区

B SA 的范 围 直 径

一

般 不超 过 1 00米 。 我们知道 ， 在网络通信 中

， 链路层 设备 的唯

一

标志 是

其MAC 地址。 接入点AP在出厂 时就已 有了
正式名 称 是基 本 服务集标识符 B SSID 。 在(cid:4877) 线 局域网 中传送的各种帧 的首部 中

个唯

的4 8位二 进制数字 的MAC 地址， 其

， 都必须有

一

一

节 点的MAC 地址（即B SSID , 但 不是 SSID ) 。 请不要把B SSID 和 SSID 弄 混 。 用户通常 都

知道所 连接的(cid:4877) 线 局域网的名 SSID , 但 可以 不知道 其MAC 地址B SSID 。

现在简单介绍

一

下(cid:4877) 线 局域 网所 用的信道 ( cha n n el )的概念。 (cid:4875) 线 局域网通常 使用的频段

是 2 .4 GHz 和 5 GHz 频段 。 每
如， 在2 .4 GHz 频段 中有大约 85MHz 的带宽可用。 802 .llb 标准定义 了 11 个部 分重叠 的信

个频段又 再 划分为 若干 个信道 ， 供 各(cid:4877) 线 局域网使用。 例

一

道 集 。 相 邻信道 的 中 心频 率相 差 5MHz , 而 每个信道 的带宽约 为 22 MHz 。 因此， 仅 当 两 个

信道 由四 个或更多信道 隔 开 时它们彼 此才(cid:4877) 重叠 。 其 中

， 信道 1 , 6和 11 的集合 是唯

一

的三

个 非重叠信道 的集 合 。 现在已 经广 泛 使用的(cid:4877)线 路由器就是典 型 的接入点设备 ， 并且 在出厂

时就 预 先设置 了 SSID 和使用的信道 （用户也可以 自 行更改 ）。 例如， 当 发现附 近 的接入点

使用的频道对自 己 有干扰 时， 就可以 重 (cid:4843)设置 本服务集接入点的工 作信道 。

一

个基本服务集 可以 是孤 立 的单个 服务集 ， 也可通过接入点 A P连接到
一

一

D S   (Di st rib uti o n   Sy st em )， 然后再 连接到另

个基本服务集 ， 这样就构成了

个扩展 服务集

一

个分配 系 统

E SS  ( Ext end ed  S er vi ce S et )。 E SS 也有 个标识 符 ， 是不超 过 32 字 符 的字 符 串 名 字而 不是地址 ，
叫作扩展 服务集标识符 E SSID （如图 9- 1 所 示）。 分配系统 的作用就是使扩 展的服务集 E SS

对上层 的表现就像

一

个基本服务集 B SS

一

样。 分配 系统 可以 使用以太 网（这是最常 用的）、

点对点链路或其他(cid:4877)线 网络。 扩 展服务集 E SS 还可 为(cid:4876)线 用户提供 到 802 .x 局域网（也就 是
非 802 .11 (cid:4877) 线 局域网） 的接入。 这种接入是通过叫作门户 (p o rtal)的设备 来实现的。 门 户是
一
802. 11定义 的(cid:4843)名 词 ， 其实它的作用就相 当于

个扩 展服务集 内几 个不同 的基

个网桥 。 在

一

本服务集 也可能有相 交的部 分。 图 9-1 中 的移 动 站 A 如果要和另
个基本服务集 中的移 动
站 B 通信 ， 就必须经过两个接入点AP1 和A P2 , 即A-AP] -A P2 - B 。 我们应 当注意到， 在

一

图 9-1 的例子 中

， 从A P1 到AP2 的通信 是使用有线 传输的。

DS

＇，＇＇
,

，

分 配 系 统

，夕－－ － － － － － － －一一一一一一一了三勹__ _l_ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ _ _ ＿ _ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ + － － － － － － － － －
至其他 802.x
局 域 网
扩展服务集
1
，＇，，＇夕，夕，口＿ 一＿ 一 ＿ ＿
·· · ·· · ·

门 户
－
－ － －
－ －
ESS
－
---
，容． ． · • •
名 ： ESSID j
．
..
..
·.....
:
，屯，飞
· ·
＇，，
..
．
;
，
．
＇，
．
｀`  l  ··
· · ?
,
｀、、、、、 基本服务集 BSSi 飞 ;- ))
，
，
、、
臣

－ － －夕 T-Z-－ ～ ～
、、、、、 :
.:··...
拟 袋 ；心 “心 ，＇｝ ｝
i
�I\ .... I! ,,/,'
＇

邕 ．．． ． ．．
`

、、、、巨三贮

心

s2 —

\\

嫣 ＇岱 磁 夥 签

淤 窃 淤 嫉 怨

｀ 甚 ． 生

、、

｀

基`｀`

袅 恣 滋 党

揉
`

—三 -

图 9- 1

IEEE 802. 1 1 的 基 本 服务 集 BSS 和 扩 展 服 务 集 ESS

我们还应注意到， 图 9-1所 示的两个基本服务集 的覆 盖 范 围 有 重合 的地(cid:4851)。 为 了避 免 在

这种重合 的地(cid:4851)出现不同信道 的相 互 干扰 ， 这两个接 入点所 选择 的工 作信道 ， 必须相 隔 5个

或更多的信道 。

图 9-1 画出了移 动 站 A 漫游 的情况。 但移动 站 A 漫游 到图 中 的位置 A 1 时， 就 能够同 时

•  4 07 •

收 到两 个接入点的信 号 。 这时， 移 动 站 A 可以 选择 和信 号 较强的

一

个接入点联系。 当移动

站 漫 游 到位置 A 2 时， 就只能和接入点 AP2 联系了。 移 动 站只要 能够和其 中

一

个接入点联系

一

一

直可保持 与另

上， 就
电磁波 的辐射 范 围 确定的。 在图 9-1 中 用

一

个 移 动 站 B 的通信 。 基本服务集 的服务范 围 是由移 动 站 所发 射 的

个 虚 线椭 圆 来表示基本 服务区 的范 围 。 由千 实际

地形条件 可能是多种多样的，

一

个 服务区 的覆 盖 范 围 可能是很 不规则的几何形 状 。

802 .11 标准并没 有定义如何实现漫 游 ， 但定义了

一

些基本的工 具。 例如， 一 个 移 动 站 若

一

要加入

个基本服务集 B SS, 就必须 先与某个接入点A P建立 关 联 (a sso ciati o n )。 建立 关联就

表示这个 移 动 站 加入了 选 定 的 A P所属 的子网， 并和这个接入点 A P创 建了

一

个虚拟线 路。

只有已关联的 A P才向 这个 移 动 站 发 送 数据帧 ， 而这个移动 站 也只有通 过关联的 AP才能向

其 他站 点发送 数据帧 。 这和手机开 机后必须 和附 近 的某个基站 建立 关联的概念是相 似 的。

移 动 站 与接入点AP建立 关联的(cid:4851)法有两种。 一 种是被动 扫 描 （如图 9-2(a )所示）， 其 过

程 如下：

0 接入点AP周 期性发 出（例如每秒 1 0次） 信标帧 (b ea co n fram e)， 其 中 包含 有若干系

统 参数（如服务集 标识 符 SSID 以及 支 持 的速率等）。 图 9-2(a )表示移动 站 A 收 到了 两个接

入点发 出的信 标帧 。

＠ 移 动 站 A 扫 描 11个信道， 选择愿 意加入接入点 A P2 所在的基本服务集 B SS2 , 千是

向 AP2 发 出关联请求帧 ( A sso ciati o n Req u est fram e)。

＠ 接入点AP2 同 意移 动 站 A 发来的关联请求 ， 向移 动 站 A 发送 关 联 响 应 帧 ( A sso ciati o n

Resp o n se fram e)。

这样， 移 动 站 A 和接入点A P2 的关联就建 立 了 。

1

BSS

、、、、、、 ,， ＇--- - BSS

厂；` 、 `- -- - - - ---­

(a)

、-、 - - ---- -- - -

、

、

`

`

、

`

AP

r,
~

'
,
'
｀

l
＇
,
,
'

，
＇
，

,

＇

,

＇

'

，

,

i

(b)

图9-2

被动扫描 (a)与主动扫描(b)

一

另

种建立 关联的(cid:4851)法是主 动 扫 描 （如 图 9-2(b )所示）， 其步骤如下 ：

0 移 动 站 A 主 动 发 出广 播的探测请求帧 (Prob e Req u est  fram e)， 让 所有能够收 到此帧 的

接入点都能够知道有移 动 站 要求 建立 关联（见 图 9-2(b ) 中 的多个 虚 线 箭 头 ）。

＠ 现在两 个接入点 都回 答探测 响 应 帧(Prob eResp o n se fram e)。
＠ 移动 站 A 向 A P2 发 出关联请求帧 。

0 接入 点A P2 向移 动 站 A 发送 关 联 响 应 帧 ， 与移动 站 A 建立 了关联。
一

个基 本服务集 B SS 能够为更多的移 动 站 提供服务， 往 往 在

为了 使

一

个 B SS 内安 装有

多个接入点 AP。 有时
一

一

A P 中 选择

个 建立 关联。 通 常 可以 选择信 号 最强的

个 AP。 但有时也可能该 A P提供的信

一

个 移 动 站 也可以收 到本服务集 以外 的 AP信号 。 移 动 站 只能在多个

道都已被其 他移 动 站占用了 。 在这种情况下 ， 也只能与信号 强度稍 差些的AP建立 关联。

此后， 这个移 动 站 就和选 定 的 AP 互相 使用 802 .11 关联协议进行对话 。 移动 站 点还要

•  4 08 •

向该 A P鉴 别自身 。 现在的接 入点 A P 在 出厂 时就已经 嵌 入 了DHC P模 块 。 因此 在关联建 立
后 ， 移动站点通过关联的 A P向该 子 网 发送 DHC P 发现报 文就可以获 取 I P地址 。 这 时， 互
联网中的 其他部 分就把这个移 动 站 当作 该 A P子 网中的一 台主机。

若移动 站 使用重建 关 联(reassociation) 服务， 就可 把这种关联转移 到另 一 个接 入点 。 当使

用分离(dissociation) 服务时， 就可终止 这种关联。

一 个移动 站 可 以同 时进行主动 扫 描 和被动 扫 描 ， 这样 可以更加 迅 速地和 A P建 立 关联。
802.11标 准 没有 规 定移 动 站 应选择 哪 一 种扫 描 方式 。 但很多移 动 站 愿 意使用被动 扫 描 ， 这样
可以节省 移 动 站 的 电 源功 率消 耗 。

现在 许多 地方， 如办公室 、 机场、 快 餐 店 、 旅馆 、 购 物 中心 等 都能够 向 公众提 供有偿

或 无偿接 入W i-Fi的服务 。 这样 的地点就叫 作 热点(h ot spot)
起 来的区 域叫 作热区(h otz one)

。 热点 也 就 是公众 无线 入 网点 。

。 由许多热点 和接 入点 A P 连接

由于 无线 局 域 网 已非常 普 及， 因此现在无论 是智 能手 机、 智 能电视 机或计 算 机， 其主
板 上 都已经 有了 内置 的无线局域 网 适配 器， 能够 实现802.11的物 理层 和M AC 层 的功能 。 只

要在无线 局 域 网信号覆盖 的地方， 用户就能够 通过接 入点 A P连接 到互联网 。

无线 局 域 网用户 在 和附近 的接 入点 A P建 立 关联时， 一般 还要键 入用户口 令 。 键 入正确

后 ， 才能和 在该 网络中的 A P建 立 关联。 在无 线 局 域 网 发展 初 期 ， 这种接 入加 密 方案称为
WE P (W ired Eq uiv alent  Pr iv acy , 意思 是“ 有线 等效 的保 密 ”
， 它曾 经 是1999 年 通过的
IEEE 802.11 b标 准中的一部 分。 然而WE P的加 密 方案 有安 全 漏洞 ， 因此现在的无线 局 域 网
普遍 采用了保密性更好 的加 密 方案 WP A ( W iFi  Pr otected  A ccess, 意思 是“ 无线 局 域 网受 保
护 的接 入” ) 或 其第 二 个版本 W PA 2。 现在 W PA 2 是802. 1l n中 强 制 执 行的加 密 方案 ， 微软
的 W indow s10 支持 W PA2。 这表明 只 有 在 电脑屏幕 上弹 出的口 令 窗 口 键 入正确的口 令 后 ，
才能与 其 A P建立 关联。

2. 移动 自 组网络

另 一 类 无线 局 域 网 是无固 定 基础 设 施 的 无线 局 域 网， 它 又叫 作 自 组 网 络 ( ad h oc
netw or k)心 。 这种自 组 网络 没有上述 基本 服务集 中 的接 入点 A P, 而是由一 些处于 平等状态 的
移 动 站 相互 通信 组成 的临 时 网络（如图 9-3 所示） 。 图中还画 出了 当移 动 站 A 和E 通信时，
经 过 A-B, B-C,  C-D 和最 后 D- E 这样 一 连串 的存储转 发过程 。 因此， 在从源节点 A 到
目 的节点 E 的 路径 中， 移 动 站 B, C 和D 都是转 发节点 ， 这些节点 都具 有 路由器的功能 。 由

于 自 组 网络 没 有预先 建 好 的网 络固 定 基础 设施 （基 站 ） ， 因此自 组 网络的服务范 围 通常 是
受 限 的， 而且 自 组 网络一 般 也 不 和外界 的 其他 网络 相 连接 （当然也 不 能接 入到互联网） 。
移 动 自 组 网络 也 就 是移动 分组无 线 网 络 。

自 组 网络 通常 是这样 构 成 的 ： 一 些可移 动 的 设 备 发现 在 它们附 近 还有 其他的可移 动 设
备 ， 并且 要求 和 其他移动 设备 进行通信 。 随着便携式 电脑 和智 能手 机的普 及， 自 组 网络的 组

句
E

T
,
4
、

.

-

.

.

l

.
-
-
.

，

-

)

1

O 注 ： 拉丁语 ad hoc 本 来 的 意 思 是 ＂ 仅为此 目 的(for this  purpose  only) ", 并 且通常还有 “ 临 时 的

含 义 。 译 成 中 文就是
“ 特定的 ＂。 直译 ad hoc  network 就是 “ 特定网络 ＂。 但 由 千 这 种 网 络 的 组成 并 不 需要使用 固 定 的基 础 设 施 ， 因 此 可 意 译 为 “ 自 组
网络 ＂， 表 明 不 需 要 固 定基站而仅依靠移动站 自 身就能组成 网 络 。

＂

•  40 9 •

)
网方式 已受到人们的广 泛 关 注 。 由千在自 组网 络中的每 一 个移 动 站 ， 都要参与 到 网络中 其他
移 动 站 的 路由的 发现和维护 ， 同时由移 动 站 构 成 的 网络拓 扑 有可能随 时间 变化 得很快 ， 因此
在固 定 网络中 行之 有效 的一 些路由选择协议对移动 自 组 网络已 不适 用。 这样， 在自 组网 络中
另 一 个重 要问题 是多播 。 在移动 自 组 网络中往 往 需要将
路由选择协议就 引 起 了特 别的关 注 。
某个重要信息 同时向多 个移 动 站 传 送 。 这种多播 比固 定节点网 络的多播 要复 杂 得多 ， 需要有
实时性 好而 效 率又 高的多播协议 。 在移 动 自 组网 络中， 安 全 问题也 是一 个更为 突出的问题 。

转发节点、

转 发 节 点

(

飞

飞

转发 节点

B`

位
源节 点:- -----

二二

- - - - - - -- - - - - - - - - - - - -- - - -

飞 目 的 节占

；（邕

图9-3 由 处 千平等状态的一些便携机构成的 自 组 网 络

移 动 自 组网 络在军 用和民 用领域 都有很好的应用前景 。 在军 事 领 域 中， 由千战 场上往

往 没有预先建 好的固 定接 入点， 其移动 站 就可以利用临 时建立 的移动 自 组 网络进行通信 。 这

种 组 网方式 也 能够 应用到作 战 的地面车辆群 和坦 克群 ， 以及海 上的舰艇群 、 空中的机群 。 由
于 每 一 个移动 设备 都具 有 路由器转 发分组的功能， 因此分布 式 的移动 自 组 网络的生存性 非常
好 。 在民 用领域 ， 持 有笔 记本 电脑 的 人可以利用这种移动 自 组 网络方便 地交换 信息 ， 而不受

便 携 式 电 脑 附近 没有 电话线插头 的 限制 。 当 出现自 然灾 害 时， 在抢 险救灾 时 利用移 动 自 组 网

络进行 及时通信往 往 也 是 很有效 的， 因为这 时事 先已建 好的 网络基础设施 （基站 ） 可 能都已

经 被破坏了。

近 年 来， 移 动 自 组 网络 中的一 个子 集 一 无 线 传 感 器网 络 WSN (W ireless Sensor

Netw ork) 引起 了人们广 泛 的关 注 。 无线 传感 器 网络 是由大 量传 感 器节点通过无线 通信技 术构
成 的自 组网 络 。 无线传 感 器 网络的应用就 是进行 各 种数据的采集 、 处 理 和传 输， 一 般 并 不需
要很高的带宽， 但 是在大部 分时间 必须保持 低功耗 ， 以节 省 电池 的消 耗 。 由于 无线 传感节点

的存储 容 量受 限， 因此对协议栈 的大小有严格 的 限制 。 此外， 无线传 感 器 网络还对网 络安 全
性 、 节点自 动 配置 、 网 络动 态 重 组等方面 有一 定的要求 。

据统 计 ， 全 球 98％的处 理器并 不 在传统 的计 算 机中， 而是处 在各 种家 电 设备 、 运输工

具 以及工厂 的机器中 。 如果在 这些设备 上能够 嵌 入合适 的传感 器 和 无线 通信功能， 就可能把

数量极 大的节点 连接成 分布 式 的传感 器 无线 网 络， 因而 能够 实现连网计 算 和处 理 。

图 9 -4 是典 型 的传感 器节点 的 组成 ， 它 的主要构件包括 C PU 、 存储 器、 传感 器硬件、

无线 收 发器 和 电池 。

无线 传感 器网 络中的节点基 本 上 是固 定 不 变的， 这点 和移 动 自 组网 络有 很大的区 别 。

无线 传感 器 网络主要的应用领域就 是组成 各 种物联网 I oT (I nternet of  Th ings)
的一 些举 例 ：

。 下面 是物联网

(1) 环 境 监 测与保护 （如洪 水预报 、 动 物 栖 息 的 监 控 ）；

(2) 战 争 中对敌情 的侦 查 和对兵 力 、 装备 、 物 资 等的 监 控 ；

•  410 •

三 三 门4:
三 厂1霍

图 9-4 传 感 器 节 点 的 主 要 构 件

( 3) 医 疗 中 对病 房 的监 测 和对 患 者的 护 理；
(4 ) 在危 险 的 工 业 环 境 （ 如 矿井 、 核 电 站 等）

中 的安 全监 测 ；

( 5 ) 城 市 交通管理、 建筑 内 的温 度／照 明／ 安 全 控 制等 。

关 于 (cid:4873)线 传感 器 网 络 更 详 细 的内 容 可参 阅 [COMM 02 ]。
顺 便指出， 移 动 自 组 网络和移 动 IP 并 不 相 同 。 移动 IP 技 术 使 漫 游 的主 机可以 用多 种(cid:4852)
个子
式连接 到互联网 。 漫 游 的主 机可以直接连接 到或通过 (cid:4876) 线 链 路连接 到固 定网络上的 另
网。 支 持 这种形 式 的主 机 移 动 性 需 要 地址管理和增 加协议 的互操作性 ， 但移动 IP 的 核 心 网
直 在 使 用的各 种路 由 选择 协 议 。 但移 动 自 组 网 络是把移
络功能 仍然是基 于在固 定 互联 网 中

一

一

动性扩 展到 (cid:4874) 线 领域 中 的自 治 系 统 ， 它具有 自 己 特定 的路由 选择 协议， 并 且 可 以 不和互联网

相 连 。 即使 在和互联 网 相 连 时， 移动 自 组 网 络也是 以 末 梢 网 络( st ub n etw o rk )(cid:4854) 式工作的。 所

“

谓

末 梢 网络

”

就是通信 景可 以进 入末 梢 网 络 ， 也可以 从 末 梢 网络发出， 但 不 允 许 外 部 的通

信量穿 越末 梢 网络 。

最 后 需要弄清 在(cid:4825)献 中 经常要遇到的、 与 接 入有 关 的几 个名 词 。
固定接入(fix ed a ccess)  在 作 为网 络 用户期 间， 用户设置 的 地理 位 置 保 持 不变 。
移 动接入(m obility a ccess)  用户 设备能 够以 车辆 速度 （

一

般 取为 120km/h ) 移动 时进

行网络通信 。 当发生 切 换 （即 用户移 动 到不 同 蜂 窝 小区 ） 时， 通信 仍然是连续 的。

便携接入(p o rtabl ea ccess)  在受 限 的网 络覆 盖 面 积 中

， 用户设备能够 在以步 行速 度 移

动 时进行网络通信 ， 提供 有 限 的 切 换 能力。

游牧接入( n oma di ca ccess)  用户 设备 的地理位置 至 少 在进 行网络通信 时保 持 不 变 。 如
果用户设备 移 动 了 位置 （改变 了蜂 窝 小区 ） ， 那么再 次 进 行通 信 时可能 还要寻 找最 佳 的基 站 。
一

也有 的(cid:4831) 献把便 携 接 入和 游 牧 接 入当 作

样的， 定 义为可 以 在通 信 时以步 行速度 移 动 。

这点在阅 读(cid:4825)献 时 应 加以注 意 。

9.1.2 802. 11局 域 网的 物 理 层

802. 11标 准中 物 理层 相 当 复 杂 。 限 于 篇 幅 ， 这里对 (cid:4873)线 局域网 的物 理层 不能展 开 讨 论 。

根据 物 理层 的 不 同 （ 如 工作频 段 、 (cid:4801) 据 率 、 调 制(cid:4855) 法 等） ， 对 应的 标 准也不同 。 最 早 流 行的
(cid:4873)线 局域网是 802. l lb, 802 .l la 和 802. 11 g 。 2009年 以 后 又 公布 了 (cid:4844) 的 标 准 802. 1 l

n,  802. 1 la c

以及 802. llax （见表 9-1) 。 为 了 使 (cid:4873)线 局域网 的适 配 器能 够适 应多 种标 准 ， 很 多适 配 器 都 做
成双 模 的 ( 802. l la/g ) 或多模 的 （ 例如 ， 802 . 1 l a/b/g/n/ac ) 。 顺 便 说
开
始 就有 的。 在 802. 1 1以 后的 (cid:4842)标 准就 在原 来 的 802. 11 后 面 增加

个 英(cid:4825)字 母 。 但 2 6个英(cid:4825)

并 非

别名

下 ，

一

一

一

“

”

字 母 很 快 就用完 了 。 这时就采 用 附 加 两个英(cid:4825)字 母 的 办法 。 在 201 8年 人们普 遍 感 到(cid:4878) 线 局
域网的名 字 太 难记忆 时， W] －伈 联盟 就决 定使 用Wi-F i 4/5/ 6作为 802. 1l n/a c/ax 的 别名 。 随 后
也顺便把Wi-F i

1 / 2/ 3作为最 早 流 行的 三 种 (cid:4879)线 局域网 的别 名 。

•  4 11 •

表 9- 1 几种常用 的 802. 1 1 (cid:4880)线局域网

＇

标准

别名

频段

最高数据率

物 理 层

优缺点

802 1 1  b

Wi-Fi  l

2 4 GH z

1 1  Mbit/s

扩 频

最 高 数 据 率 较 低 ， 价 格 最 低 ， 信 号 传 播距 离 最 远 ， 且 不 易

( 1 999 年 ）

受 阻 碍

802 I l a

W i - F i  2

5  GHz

54 Mbit/s

OFDM

最 高 数 据 年 较 高 ， 支 持 更 多 用 户 同 时 上 网 ， 价 格 最 高 ， 信

( 1 999 年 ）

号 传 播距骁较 短 ， 且 易 受 阻碍

802 I l g

Wi-Fi 3

2 4 G H z

54 Mbit/s

OFDM

最 高 数据 率 较 高 ， 支 持 更 多 用 户 同 时 上 网 ， 信 号 传 播 距 离

( 2003 年 ）

最远 ， 且 不 易 受 阻 碍 ， 价 格 比 802. 1 l b 贵

802 I I n

Wi-Fi 4

2 4 I 5 GHz

600 Mbit/s

M I MO

使 用 多 个 发射 和 接 收 天线达到 更 高 的 数 据 传 输 率 ，

(2009 年 ）

OFDM

当 使 用 双 倍带 宽(40 M Hz ) 时 速率可达 600 Mbit/s

802 I l ac

Wi-Fi 5

5  G H z

7 Gbit/s

MIMO

完 令 边 循 802 1 1  i 安 全 怀 准 的 所 有 内 谷 ， 使 得 兀 线 迕 桉 能

(20 1 4 年 ）

OFDM

够 什 及 个 目 汀 同 达 ：刊 企业 级 川 尸 的 需 水

802 I l ax

W中 6

2 4 1  5  GHz

9 6 Gbit/s

M I MO

侧 重 解 决 密 货 环 境 下 （ 如 火 车 站 、 机 场 ） 提 高 吞 吐 量 密度

(20 1 9 年 ）

OFDM

（ 即 单 位 面积 的 吞 吐豐 ）

表 9- 1

中 802. 1lax 又称为高效率 (cid:4881)线标准 H EW (H igh- Effi cien cy  Wirele s

s) ， 向 下 兼 容

8 02 . 1 1 a/b/g/n/a c。 其侧 重要 解 决 的问题是要在密 集 环 境 下 （ 如 火 车 站 、 飞 机场 等 热 点和人 员

都很 密 集 的场 所）保持 手 机 的畅 通 。 表 9- 1 给 出的关 千 802. 11a c 和 802.llax 的最高数据率

来自 [K HOR1 9]， 但现 在已 有 不少 802. 1lax 的产 品 的最高数 据率达 到 了 更 高的数 值。 目前正

在研 究 的 还有 被称 为极 高 吞 吐量 EHT (Extremely High Thr oughput) 的 802. l l be  ( Wi-F i   7) ， 其

最高数 据率 有望 达 到 3 0Gbit/ s , 它的 另

一

个 特点是要降低延迟 和抖动 （ 迟延 要 降低到 5 ms

以下 ） ， 这对实 时游戏具 有重要 意义 。 802. l l be 的标准可能在 2024 年 完 成。

201 6年 的 802.llah , 工作频 段 在 900MHz , 最高数据率为 1 8Mbit/ s, 这种(cid:4873)线 局域网

的功耗低、 传输距 离 长（最长可达 1km ) ， 很 适 合 于物联网设备之 间的通信 。

(cid:4873)线 局域网最初 还使用过跳频 扩 频 F H SS (F requen cy  H oppi ng  Sp rea d  Spe ctrum )和红 外 技

术 I R(Infra Re d) ， 但现 在已 经很 少 使用 了 。

以 上 几 种标 准 都使用 共同 的媒体接入控制 协议 ， 都可以 用千有固 定基础 设(cid:4870) 的或(cid:4873)固

定基础 设(cid:4871) 的(cid:4873)线 局域网 。 除 I EEE 的 802. 11 委 员 会 外 ， 欧洲 电信标准 协会 E T SI ( E u ropean
s  I n stitute) 的 RESlO 工作组也为欧 洲 制 定 (cid:4873)线 局域网 的标 准， 他

Tele communi cati o n

s  Stan da r d

们把这种局 域 网 取名 为HiperLAN。 E T SI 和IEEE 的标准 是可以 互操作的。

下 面 我们讨 论 802. 1 1 标准 的MA C 层 。

9. 1 .3  802 . 1 1 局 域 网 的 MAC 层 协 议

1 .   CS MA/CA 协议

虽 然 C SMA/CD 协议已 成 功地 应用 于使用有 线 连接的局域网 ， 但(cid:4873)线 局域网 能不 能也

使用C SMA /CD 协议 呢 ？ 下 面 我们从(cid:4873)线 信道本身 的特点 出发 来详细讨 论 这个问题。

＂ 碰 撞 检测

“

一

要求

个 站 点在发 送本站 数据的同 时， 还必须不间(cid:4837)地检 测信道。 一 旦

O 庄 ： 在 物 理层 使用 的 OFDM 是 Orthogonal Frequency  Division  Multiplexing （ 正 交 频 分 复 用 ） 的 缩 写 。 MIMO 是 M ultiple

lnput M ultiple Output （ 多 入 多 出 ） 的 缩 写 ， 即 空 间 分 集 ， 使 用 多 空 间 通 道 ， 即 利 用 物 理 上 完 全 分 离 的 最 多 4 个 发 射 天 线 和 4 个接

收 大 线 ， 对 不 同 数据 进 行 不 同 的 调 制／解 调 ， 因 而提 高 了 数据 的 传输 速 率 。

•  4 12 •

检测到碰撞 ， 就立即 停 止发送。 但由 千 (cid:4876) 线 信道的传输条件 特殊 ， 其 信号 强度的动 态 范 围 非

常 大， 因此在 802 .11 适 配 器上接收 到的信号 强度往 往 会 远 远 小于发送信号 的强度（信号 强

度可能相 差 百 万 倍 ）。 因此(cid:4876) 线 局域网的适 配 器(cid:4874) 法实现碰撞检测。

我们知 道， (cid:4882) 线 电波 能够向 所有的(cid:4851)向 传播， 且 其传播距 离 有限 。 当 电磁 波 在传播过

程 中 遇到障 碍 物 时 ， 其传播距 离 就会 受 到限 制。 如图 9- 5 所示 的例子就是(cid:4874) 线 局域网的隐 蔽

站问题。 我们假 定 每个 移 动 站 的(cid:4876)线 电信号 传播范 围 都是以发 送站 为圆 心 的

一

个 圆 形 面积 。

A 的 作 用 范 围

C 的 作 用 范 围

A 的 作 用 范 围

＼

， 产

＇

＇，

-- - 、
、＼

＼ ＿－ ＿ －

＇，

、
、
、 ，
，

－ － －

－～－－

、
、

I  E二 ｀｀心';`｀
C

A

\B,:

(a)

＼ 飞｀妃

』:｀\~:，I \
！ 飞一八贮
B'

'，｀｀,

A

｀、、

、、

＇，＇

＇，

(b )

图9-5 A 和 C 同 时 向 B 发 送数据 ， 发生碰撞

图 9-5(a)表 示站 点 A 和 C 都想和 B 通信 （这里仅 仅 是讲解隐 蔽站问题的原理， 在通信

的过程 中 省 略 了接入点 AP 。 可以把 B 看 成是接入点 A P) 。 但 A 和 C 相 距 较远 ， 彼 此都检

测不到对(cid:4854) 发送的信号 。 当 A 和 C 检测到信道空闲 时 ， 就都向 B 发送数据， 结果 发生 了碰

撞 ， 并 且 (cid:4882) 法检测出这种碰撞 。 这就是隐蔽站问 题(hi d

d en

stati o n  pr obl em) 。 所谓 隐 蔽 站 ， 就

是它发 送的信号检测不到， 但 却 能产 生 碰撞 。 这里C 是A 的隐蔽 站 ， A 也是C 的隐蔽 站 。

当 移 动 站之 间有障碍物 时也有可能出现上述问题。 例如， 图 9- 5(b) 的三 个站 点 A , B 和

C 彼 此距 离 都差 不多。 从 距 离上看 ， 彼 此都应当能够检测 到对(cid:4851)发送的信号 。 但 A 和 C 之

间有高楼或高 山 ， 因此A 和 C 都互 相 成 为对(cid:4851)的隐 蔽 站 。 若A 和C 同时向 B 发送数据 就会

发生碰撞 ， 使 B (cid:4876) 法正常接收 。 此时 也(cid:4876) 法检测出碰撞 。

综 上 所述， 在制定(cid:4879) 线 局域网 的协 议时， 必须考虑 以下特点：

( 1) (cid:4883) 线 局域网 的适 配 器(cid:4876)法 实现碰撞 检测；

( 2) 检测到信道空闲 ， 其 实信道可能并 不空闲 ；

(3 ) 即 使我们能够在硬 件 上 实现(cid:4876) 线 局域网的碰 撞检测功能， 也(cid:4876) 法检测 出隐 蔽 站问题

带来的碰撞 。

我们知道， C SMA /CD 有两个 要点。

一

是发送前先检测信 道， 信 道忙 就不发 送。 二 是边

发送边检测信 道 ， 一 发现碰 撞 就立 即 停 止发送， 并 执 行退 避 算 法进行重 传。 因此偶 尔 发生 的
碰 撞 并 不会使局域网 的运 行效 率 降 低 很 多。 (cid:4876) 线 局域网显 然可以 使用C SMA , 但 (cid:4876) 法使用
碰 撞检测（由 上述 (cid:4879) 线 局域网 特 点( 1 )和( 3)决 定 的），
定把(cid:4821) 个 帧 发

旦 开始 发送数据， 就

一

一

送完 毕 ；

一

旦 发 生 碰撞 ， (cid:4821) 个信道资源 的浪 费 就比较严 重 。

(D
为此， 802. 11局域网使用C SMA /CA 协议

。 CA 表示C olli si o n Av oi

da nc e, 是碰撞避免

的意 思 ， 或者说， 协议的设计是要尽量减少碰撞 发 生 的概率 。 这点和使用有线 连接的以 太网

有很 大的区别。 以 太网当 然不希 望 发生 碰 撞 ， 但 并 不怕 发生 碰 撞 ， 因为碰 撞 的影 响并 不大。

CD 注 ： 有 的 资 料称这种协议为具有碰撞避免 的 多 点接入 MACA (Multiple Access with Collision Avoidance) 。

•  4 13  •

802. 1 1 局域网 在使 用 C SMA /CA 的 同 时， 还使用停 止等待协议 。 这是因 为(cid:4876)线信道的 通
帧 后， 要等到收 到对 (cid:4851)

信 质 量远 不 如 有 线 信道的， 因 此(cid:4884) 线 站 点每通过(cid:4873)线 局域网发送完

一

的 确 认帧 后 才 能继续 发送 下

一

帧 。 这就是链路层确认 。 链 路层 确认 也是 解决碰撞 后重 传的 手

段 。

我们在 进

一

步 讨 论 C SMA /CA 协议之前， 先要 介绍 802. 11 的 MA C 层 。

802. 1 1 标准设计 了 独特的 MAC 层 （ 如 图9-6 所 示）。 它通过协 调功能 ( C oor di nati o n F u n cti o n)

来 确 定 在 基 本 服 务 集 B SS 中 的 移 动 站 ， 在什 么 时间能发送数 据或接收 数 据。 802. 11 的 MA C

层 在 物 理层 的 上 面 ， 它包 括 两 个子层 。

』

九 争 用 服 务 （ 选 用 ）

争用 服务 （ 必 须 实 现 ）

M

A

C

层

点 协 调 功 能 PCF
(Point Coordination Function)

雪

分 布 协 调 功 能 DCF
(Distributed Coordination Function)
(CS M A/CA)

物理层

图 9-6

802 . 1 1 的 MAC 层

(l) 分布 协 调功能 DCF (D i

stribut ed C oor di nati o n  Fun cti on) 。 D CF 不采 用任何 中 心控 制，

而 是 在 每

一

个 节 点 使 用 C SMA 机 制的分布 式接入算 法 ， 让 各 个站 通过争 用信道来获 取发 送

权 。 囚 此DCF 向 上提供争 用 服 务 。 802. 1 1 标 准 规 定 ， 所有的 实现 都必须有 D CF 功能。 为此，

定 义 了 两 个非 常 重 要 的 时间 间隔， 即 短帧间间隔 SIF S ( Sh ort I nt er

-F ram e Spa ci n g) 和分布 协 调
功能帧间间隔 D IF S (D CF I F S) 。 关 于 这 两 个时间间隔后 面 还要讲 到。 802 .11 标准还定义了其

他几 种时间 间 隔 ， 这 里从略 。

( 2) 点 协 调功能 PCF (Poi nt  C oor di nati o n   F u n cti o n) 。 PCF 是选项 ， 是用接入点AP集 中

控 制 (cid:4821) 个 B SS 内的 活动 ， 因 此自 组 网络 就没 有PCF 子层 。 PCF 使用集 中 控 制的接入算 法 ，

用 类 似 千探询 的(cid:4856)法 把 发送 数 据权 轮流 交给各 个站 ， 从而 避 免 了碰撞 的产生 。 对 千时间敏感

的 业 务 ， 如 分 组话音 ， 就 应使用提 供(cid:4885) 争 用服务 的点协调 功能PCF 。

我们目前大 量 使 用 的 (cid:4886) 线 局 域 网 都是使用上述 的 分布 协 调 功能 DCF 。
C SMA /CA 协议 比较复 杂 。 IEE E的 802. 1 1- 2007标准 (cid:4826) 档共有 123 2页之 多。 这里介绍

C SM A /CA 协议 的 要 点 如 下：

( 1 ) 站 点 若 想 发送 数 据必 须 先监 听 信道。 若信道在时间 间隔 DIF S 内均为空闲 ， 则发送

(cid:4822) 个数据 帧 。 否 则 ， 进行( 2) 。

( 2) 站 点 选择

一

随 机 数 ， 设置 退 避 计 时器。 计时器的 运 行规则是： 若信道忙 ， 则冻 结退

避 计 时 器 ， 继 续 等待 ， 直 至信道变 为空 闲 （这叫作推 迟接入）； 若信道空闲 ， 并在时间间隔
D I F S 内均 为 空 闲 ， 则开 始 争 用 信道， 进 行 倒 计时。 当退 避 计 时 器 的 时间减 到零 时（显 然这
只 能 发 生 在 信道空 闲 时）， 站 点就发送 (cid:4802) 据帧 ， 把

(cid:4821) 帧 发完 。

一

( 3) 站 点若 收 到接收 (cid:4851)发来 的 确认帧 ， 且还有 后续 帧 要 发送， 就转 到( 2) 。 若在设定时间

内 未 收 到 确认 ， 则 准 备 重传 ， 并转 到( 2) ， 但会 在更大的 范 围 内选择

一

随 机 数 。

下 面 详 细 解 释 上 述 协议 中 的 内容 。

•  41 4 •

2. 时间间隔 D I FS 的重要性

在图 9-7 中

， 站 点A 要向站 点B 发送数据。 A 监 听信道。 若信道在 时间间 隔 DI F S 内

一

直都是空 闲 的（理由 下面 就要讲到） ， A 就可以 在 to 时间发送数据帧 DA TA 。 B 收 到后立 即

发回 确认 ACK 。 B 开始 发送确认 的时刻 ， 实际 上必然略滞 后千 B 收 完 DA TA 的时间， 滞 后

的时间是 SIF S 。 这是因为B 收 到数据帧 后， 必须进行 CRC 检验 。 若检验 (cid:4887) 差错， 再 从接收

状 态 转 为发送状态 ， 这些动 作不可能在瞬 间完 成。 SI F S 值在 802. 1 1标准 中 均有 规定。 因此，
从A 发送数据帧 D A TA 开始 ， 到收 到确认 ACK 为止的这段 时间(DA TA +  SI F S  +  ACK) ， 必
须 不允 许任何其他站 发送数据， 这样才不会发生碰撞 。 为此， 802. 11标准规 定 了每 个站必须

同时使用以下 的两 个(cid:4851)法。

A
 B

t'

。

D怍S

DIFS

DATA

SIFS
t
t'

尸 一三三
H
三
，
: 丿AV
:·
；．

CW一

信道忙

f2

;+-

•

—

I

:

其 他站在此期 间 不得 发送

图9-7 A 向 B 发送数据 ， B 发 回 确 认

一
第

个(cid:4851)法是用软 件 实现的虚拟载波监听 ( VirtualCarri er  S ens e) 的机制。 这就是让 源
站 A 把要占用信道的时间（即DA TA +  SI F S  +  A CK ) ， 以微秒 为单位 ， 写 入其 数据帧 D ATA

的首部（在后 面 的 9. 1.4 节还 要介绍 首部的各字 段 ）。 所有处 在站 点 A 的广 播范 围 内的各 站 ，
信息， 并创 建自 己 的网络分配 向量 NAY (Netw o rk  Allo cati o n   Vect or) 。 NA V

都能够收 到这

一

指出了信道忙 的持续 时间， 意思 是：

“

“
A 和B 以外 的站 点都不能在这段 时 间 发 送数据

。

第二 个(cid:4852)法是 在物 理层 用硬 件 实现载波监 听 。 每 个站 检查收 到的信号 强度 是否 超 过

一

定的门 限 数值， 用此判 (cid:4837)是否 有其他移 动 站 在信道上发 送数据。 任 何 站 要发 送数据之前 ， 必

须监 听信道。 只 要监 听 到信道忙 ， 就不能发送数据。

从图 9-7可以看 出， t1 至 t2 这段 时间 SI F S, 信道是空闲 的。 为了保证在 这小 段 空 闲 时间

不让 其他站 点发送数据， 802. 1 1标准定义了比 SIF S 更长的时间间 隔DI F S (DC F  I

F S) ， 并且

规 定， 凡 在空 闲 时间想发送数 据的站 点， 必须等 待时间 DI FS 后才 能 发 送。 这就 保证 了确认
帧 ACK 得以 优先发送。 这个重 要措 (cid:4870) 使得在这段 时间(DATA + SIF S  + A C K ) ， (cid:4823) 个信道好 像

是A 和B 专 用的， 因为 其他站 点暂 时都不能发送数据。

3. 争用 信道的过程

现假定在站 点 A 和 B 通信 的过程中 ， 站 点C 和 D 也要发送数据 （ 如 图 9- 8所 示 ）。 但

C 和D 检测到信道忙 ， 因此必须推迟接入 ( d efer a ccess) ， 以免 发生碰撞 。 很 明 显 ， 如 果有 两

个或更多的站 ， 在等待信道进入空 闲 状 态 后， 大家 都经过规定的时间间隔DI

F S 再 同 时发送

数据， 那么必然产 生碰撞 。 因此， 协议C SMA /CA 规 定， 所 有推迟接入的站 ， 都必须 在争用

期执 行统

一

的退避 算 法开始公 平地争用 信道 。

•  4 15 •

信 道 忙

A DATA:：：ACK]

尸

信 道

A

c

D

t

＿

信 道 忙

三气们�cw一
t
门
|
－ 推迟接 入 - - － － ....： 退避 冻 结
矿／

： 退避 占 用 信 道

DATA + SIFS + ACK

信 道 忙

二三］

空 ；
＿ ＿ ＿ ＿ ＿ ＿
闲 ： 沪壁 占 用 信道

尸 l

＿ ＿

＿ ＿ ＿

＿

＿ ＿ ＿ ＿
－

1
| - － － － － － － － 推迟接 入

－ － － － － － －

三 ｀

＿ － － － － 推迟接入 － － － － － 一 一 一 一

1_

图9-8 在争用期根据 退避算法公平竞 争

图9-8 中 的争用 期 也叫作争用 窗 口 CW (Co nt enti o n  Wi ndow) 。 争 用窗 口 由 许多时隙 (tim e

slot )组 成。 例如， 争 用窗 口 cw = 1 5表示窗 口 大小 是 15个 时隙 。 时隙 长度是这样 确定的：
在下

一
个时隙 开始 时， 每 个站 点都能检测出在前

个时隙 开始 时信道是否 忙 （这样 就可采 取

一

适 当对 策）。 时隙 的长短在不同 802 .1 1 标准 中 可以 有不同数值。 例如， 802. 1 lg 规 定

一

个时

隙 时 间为 9µ s,  SI F S  =  1 0  µ s, 而 DI F S 应比 SI F S 的长度多 两个 时隙 ， 因此DIF S =  28 µ s。

退 避 算 法规定， 站 点在进入争 用 期时， 应在 0~  cw 个时隙 中 随 机生 成

一

个 退 避 时隙 数，

并设置退避计时器 (ba ckoff time r)。 当几 个站 同时争 用信道时， 计 时器最先降 为 零 的站 ， 就

首先接入媒体 ， 发送数据帧 。 这时信道转 为忙 ， 而其他正 在 退 避 的站则冻 结其计 时器， 保 留

计 时器的数值不变 ， 推 迟 到在下次争 用信道时接着 倒 计 时。 这样的规 定对所 有的站 是 公平的。

例如， 图9- 8 中 的站 点C 的退避 时隙 数为 3, 而站 点D 的退 避 时隙 数为 9。 当经过 3 个

退 避 时隙 后， 站 点C 获 得了发送权 ， 立即发送数据帧 ， 信道转 为忙状态 。 站 点 D 随 即冻 结

其剩 余 的 6个时隙 ， 推 迟 到下

一

个争 用信道时间的到来。 如 果 此后没 有 其 他站 要发送数据，

那么经过 剩 余 的 6个退避 时隙 ， 站 点D 就可以 发送数据 了。
“

“

请注 意

“
推 迟接入

和

退 避(ba ckoft) " 的区 别。 推 迟 接 入发生 在信道处 千忙 的状 态 ，

为的是 等待 争 用期的到来， 以便执 行退 避 算 法 来争 用信道。 这时退 避 计 时器处 千冻 结状态 。

而 退 避 是 争 用 期各站 点执 行的算 法， 退 避 计 时器进行 倒 计 时。 这时信道是 空 闲 的， 并且 总是

出现在时间间 隔DI F S 的后 面（如图9- 8所 示）。

802. 1 1 标准 并未 规 定争 用窗 口 CW 的初始 值， 但 建议 CW 最 小 值 可 取为 15, 最大值为

1 023。

为了减 少 碰撞 的机会， 协议 C SMA/CA 规 定 ， 如果 未 收 到确认帧 （可能 是 发 生 碰 撞 ，
一

或数据帧 传 输 出差错）， 则必须重 传。 但 每重传
例如， 假定选择 初始争 用窗 口 cw =  2

次 ， 争 用 窗 口 的数值 就近 似 加 倍 增大 。
- 1  =  1 5' 那么首次 争 用信道时， 随 机退 避 时隙

4

数应在 0~  1 5之 间生 成。 在进行重传 时， 第l次 重传 的争 用窗 口 cw = 2

4

+ i  - 1。

第1次 重传 时， 随 机退 避 的时隙 数应在 0~  31 之间 生 成。
第2次 重传 时， 随 机退 避 的时隙 数应在 0~  63之 间生 成。
第 3 次 重传 时， 随 机退 避 的时隙 数应在 0~  1 27之 间生 成。
第4 次 重 传时， 随 机退 避 的时隙 数应在 0~  511之 间生 成。
第 5次以及 5次以上重传 时， 随 机退 避 的时隙 数应在 0~  1 023之 间生 成， 争 用 窗 口 CW

•  4 1 6 •

不再 增大了。

采 用上 面 这些 措 (cid:4870) ， 发生 几 个站 同 时发送数据的 概 率可以 大 大减 小 。

归 纳 以 上的 讨 论 可以 得出如 下结论 ： 当 站 点 想发送数据， 并检测信 道 连 续 空闲 时间超

过DIF S 时， 即可立即 发 送数据， 而不必经过争用 期 。

在以 下几 种情况下 ， 发送数据必须经过争 用期 的 公平竞 争 ：

( 1) 要发送 数据时检测到信道忙 。

( 2) 已 发出的 数据 帧 未 收 到确认 ， 重 传数 据帧 。

( 3 ) 接着 发送后续 的 数据帧 。

上述的 ( 3 )是为 了防 止

一

个站 长期 垄 (cid:4837)发送权。 若

一

站 点 要连 续 发送若干 数 据帧 ， 则 不

管有(cid:4875) 其他站 争 用信道 ， 都必须进入争 用期 （ 如 图 9- 9所示 ）。

DIFS
送i

要 发
A

t 勹五诃五］ 尸皿『

数据 不 争用
信道

争 用
信道

主 cw

—

皇 cw
正面五厂勹 『开飞而五口 t
t

｀

图9-9 只 有 A 站 连 续 发送 数据

即使有了上述措 (cid:4870) ， 碰 撞 仍 有可能发生 。 例如 ， B 站 正 好在图 9- 9 中 A 占用信道时要发

送数据。 B 检测到信道忙 ， 于是推 迟 到争 用信道 时与A

一

起 争 用信道 。 但正 巧 A 和 B 又生

成了同 样大小 的 随 机退 避 时隙 数。 结果就发生 了碰撞 ， A 和 B 都必须再 重 传。 这就浪 费 了

宝 贵 的信道 资源。 因 此， 要进

一

步减 少碰撞 的 机会 ， 还需要再 采 用

一

些 措 (cid:4870) 。 这就是下 面 要

介绍的信道 预约 。

4 . 对信道进行预约

为 了更好地解决 隐蔽站 带来的 碰撞问题， 802 .11允 许 要发送数 据的 站 对信道 进行预约 。

我们假定在图 9-10 中 的 A 站 要和 B 站 通信 。 显 然， A 站 与 B 站 的 通信 都必须通过接入点

A P的 转 发。在前面 图9- 7和图9-8 中 讲解原理时， 我们都把接入点 A P省 略 了。 下面我们要

画出A 站 和AP之 间交换 的 信 息， 但 为简单起见 ， 图 中 省 略 了 A P和B 站之 间交换 的信息。

我们再 假定， A 站或 B 站 向接入点 A P发 送数据时， 远 处 的 C 站接收 不到这些信号 ，

而C 站 向 AP发送 的 信号 也传播不到远 处 的 A 站或B 站 。

在 A 站 向 AP发送数 据帧 DATA 之前， 先 发送

一

个很 短 的 控制帧 ， 叫作 请 求 发 送 RT S

(Req ue st  T o   Se n

d) ， 目 的 是告 诉 所有 能够收 到 RT S 帧 的 站 ：

“

我 将 要占用信道

一

段 时 间：

”
[SIF S + CT S +  SIFS + DATA  +  SIF S +  A CK ]

。 这段 时间写在控制帧 RT S 的 首部 中

。 A 站 发

送的 RT S 帧 ， B 站 能够收 到 ， 但远 处 的 C 站 收 不到。

接入点 AP若正 确收 到 RT S 帧 ， 经过最短 的 时间间隔SIFS 后 ， 就向 A 站 发 送

一

允许发 送 CT S (Clear

T o  S en d ) 的 控 制帧 ， 目 的 不 仅 是告 诉 A 站 ：

“

你 可以 发送数据了

个叫作
＂

， 而

且也 是告 诉 所有能够收 到 CT S 帧 的 站 ： “ A 站 和我通信 ， 要占用信道

一

段 时间：

［ SIF S  +

”
D A TA +  SIF S + ACK ]

。 这段 时间是写 在控制帧 C T S 的 首部 中

。 AP发送 的 C T S 帧 ， A 站 和

B 站 以及C 站 都能够收 到。

在随 后A 站 发 送的 DA TA 帧 的 首部 中

， 也写 入了时间[DATA + SIF S  +  ACK ]。 如 果有的

站 没 有收 到 RT S 和C T S 帧 ， 那 么 收 到DATA 帧 后， 也能设置 其NA V。

以 上措 (cid:4870)就使 得 A 站 和接入点 AP（ 以及 A 站 和 B 站 ） 的 通信 过程 中

， 发生碰撞 的概

•  4 17 •

率 大 大 降 低 ， 特别是减 少 了 隐蔽站 的干扰问题。

`- AP

心/ - － － － - － － － － － － － - － － - － - － － 一书立 （ 隐蔽站 ）
l荨
�：：了五勹二1 古：三：：：气：芒三昙？H |司

A  气心三 t

开 始争用

DA

:

T

T

:

:

：

A
P
A

收 到 R

f

t
勹l

图 9- 1 0 发 送 RTS 帧 和 CTS 帧 对 信 道进行 预 约

显 然， 增 加使 用 RT S 帧 和 CT S 帧 会使 (cid:4824) 个 网 络的 通信 效 率 有 所下降 ， 要多 浪 费 信 道 的
时间[RT S +  SIF S  +  CT S +  SIF S ]。 但 由 于 这 两 种 控 制帧 都 很 短， 其 长度分别为 2 0字节 和 14
字 节 ， 与 数据 帧 （ 最 长 可达 2 34 6字节 ） 相 比开 销 不算 大 。 相 反 ， 若不使 用 这种 控 制帧 ， 则

一 旦 发 生 碰撞 而 导致数 据帧 重发 ， 浪 费 的时 间就 更 多 了 。

从图 9- 1 0可 以 看 出， 即 使我们使 用 RT S 和 C T S 对 信 道 进行了预约 ， 但碰撞 也有可 能发

生 。 例 如 ， 有 的站 可能在时间 t1 或 t2 就发送 了数 据 （ 这些站 可能是没 有收 到 RT S 帧或CT S
帧 或 NAY ) ， 结果必定与 RT S 帧 或 CT S 帧 发生 碰 撞 。 A 站 若收 不 到 CT S 帧 ， 就不能发送数
据 帧 ， 而必须 重 传 RT S 帧 。 A 站只有 正 确收 到 CT S 帧 后 才 能发 送数 据帧 。 但 我们可 以 看 出，
在 使 用信道预 约 的情况 下， 即 使 发生 了碰撞 ， 信 道 资 源 的浪 费 是 很 小的。

信道 预 约 不 是 强制 性 规 定 。 各 站 可 以 自 己 决 定使 用 或 不 使 用 信 道预约 。 看 来， 只 有当

数 据帧 的长度超 过 某

一

数 值 时， 使 用 RT S 帧 和C TS 帧 才 比较有利 。

因为 (cid:4885)线信道 的误码率 比 有线 信 道 的 高 得 多 ， 所以 ， (cid:4888)线局域网的 MAC 帧 长

一

般 应当

短些， 以 便 在 出错 重 传 时减 小开 销 。 这 样， 有 时就 必 须 将太 长的 帧 进行 分片 。

一

最后， 我们要提

下 关 千(cid:4885)线 局域 网 的 (cid:4803)据 发 送速率 问题。 在 第 2 章 的2 . 3. 2节 的图2- 1 3
， 已 经 指 出 (cid:4889) 线 信 道 中 的误码率 与 信 噪 比 （ 信道状况 ）以 及 所 选择 的调制技 术 （ 包括数据
率 ）有 关 。 802. 1 1标准 并 没 有 对 (cid:4890) 线 局域网 (cid:4803) 据率的 自 适 应 算 法 有 具 体 的 标 准或规 定 。 但生
产 (cid:4891) 线 局 域 网 适 配 器 的厂 商 ， 一 般都 使 自 己 的产 品 能 够 自 适 应 地 改变 (cid:4801) 据 率 ， 以便 更 好地适
应 信 道 特 性 的 变 化 。 例 如 ， 可 以 采 用这 样的算法 ： 如 果
连 发送 两 个 数据 帧 但 都 没 有收 到确
一
认 ， 就 认 为 信 道 的 质 量 较差 ， 这时 就 把 数据 率 调慢
挡 。 反 之 ， 如 果此后又 能够连 续 收 到
1 0 个数 据帧 的确 认 ， 那么就 可 以 认 为 信道质量 改 善 了 ， 因 而 可 以把数据 率 调 快
协议 TCP

中 的拥 塞 控 制的处 理思 路 是 相 似 的 。

挡 。 这与

一

一

9. 1 .4  802 . 1 1 局 域 网 的 MAC 帧

－
为 了 更 好 地 了 解 802 . 1 1 局 域 网 的

步 了 解 802. 1 1局域网 的MA C
帧 的结 构 。 8 02. 1 1 帧 共 有 三 种类 型 ， 即 控制 帧 ＼ 数据 帧 和 管理 帧 。 通 过 图 9- 11 所示 的
802 . l l 局域网 的(cid:4804)据 帧 和 三 种 控 制帧 的 主 要 字段 ， 可以 进
步 了 解 802. 11 局域网的MAC 帧
的特点 。

［ 作 原理， 我们应 当 进

一

一

•  4 18 •

中
从图 9-ll(a )可以看 出， 802. 11 数据帧 由以下三 大部分组成：

2

6

M AC 首 部
6

6

2

6

字 节

2

帧控制 1 持续 期 I 地址 I
4

2

I 地址 2 I 地址 3 I 序 号 控 制 I 地址 4 I  帧 主体

I  FC S

M AC
尾 部
4

0 - 23 1 2

类型

子类型

来 自 更 多
去往
AP(j)  AP  分 片

1

1

功 率 更 多

重 试 管理 数据 | WEP I 顺序

(a) 数 据 帧 格 式 （ 帧 控 制 字 段 中 的 子类 型 为0000 )

！ I／卢网＿1，沪尸归卢竺归卫1 ， cs

4

6

6

2

字节
1

2

帧～尸

(b)  RTS 帧 格 式 （ 帧控 制 字段 中 的子类型 为 I O 1 1 )

字节

2

l
2
I 帧控同』』 扛续回』曰欠地址

6

4
FCS

j

(c)  CTS 和 ACK 帧 格 式 （ 帧控 制 字段 中 的 了类型 分 别 为 1 1 00和 l l O l )

阳 9- 1 1
( 1) MAC 首部， 共 3 0字 节 。 帧 的 复杂性都在帧 的MAC 首部。
( 2) 帧 主 体 ， 也就是帧 的数据部分， 不超 过 2312 字 节 。 这 个数值比以 太 网 的最大长度

802. 1 1 局 域 网 的 帧 格 式

长很 多。 不过 802. 11帧 的长度通常 都小 千 1500字 节 。
( 3) 帧检验序 列 FC S 是MAC 尾部， 共4 字 节 。

1 ． 关 于 802 .1 1 数据帧的地址

802. 1 1数据帧 最特殊 的地(cid:4851)就是有四 个 地址 字 段 。 这 几 个地址 与帧控 制字段 中 的

去 往
来自 AP" （ 从接入 点发 往 移 动 站 ）这两个子 字 段 的数值 有

“

AP" （ 移动 站 发送到接入 点）和

”

关 。

地址l永 远 是接收 地址 （即 直接接收 数据帧 的节 点地址 ）。
地址 2永 远 是发送 地址 （即 实际 发 送数据帧 的节 点地 址 ）。
地址 3和地址 4 取决 于数据帧 中 的

来自 AP" 和

”

“

去 往 AP" 这 两 个字 段 的数值 。

这里要再 强调

一

下， 上述地址 都是 MAC 地址 ， 即 硬 件 地址 （ 在 数据 链路层 不可能使 用

IP 地址 ）， 而 AP的 MA C 地 址 就 是在 9. 1. 1 节 介绍的B SSID 。 表9- 2给 出了 802. 1 1帧 的地址

字 段 最常 用的 两种情况（在有基 础 设(cid:4871) 的 网络中
移动 网络 中 使用 的地址4 ) 。

一

般只使 用 前 三 种地址 ， 很 少 使 用仅 在自 组

去住 AP

。

I

来 自 AP
；

I

表 9-2

802 . 1 1 帧 的 地址字段 最 常 用 的 两 种 情 况

:：三丿;i：址I：三勹勹1 :1:：  地址 4

CD 注 ： 802. 1 1 标 准 上 使用 的 名 词 是 分配 系 统 DS , 但 在 解释 中 ， 指 出 这里 的 DS 也 包 含桵 入

点 AP 。 因 此找 们 在 这 里使 用 接

，

入 点 AP 代 替 D S 。

•  4 1 9 •

--

现 假 定 在

一

个基本服务集 中 的站 点 A 向 站 点 B 发 送数据帧 。 在 站 点 A 发 往接入点 AP

的数据帧 的帧 控 制字 段 中 ， “ 去 往 A P= 1" 而

“

来自 AP= O

”

。

A -AP的数据帧 首部：

地址 1: 接收 地址（不 是目 的地址） 是 AP的地 址B SSID 。
地址 2: 发送地 址， 即源地址， 也就 是站 点A 的地址MAC氏

地址 3: 目 的地址（不 是接收 地址） 是站 点B 的地址 MAC贮

接入点A P收 到数据帧 后， 转 发给站 点 B , 但在数据 帧 的帧 控 制字 段 中

， “ 去往 AP=  O "

”

”
来自 A P=l

。

而

A P- B 的数据帧 首部：
地 址l： 接 收 地址就 是目 的地址MAC B 。

地址 2: 发 送地址（不是源地 址） 是接入点AP的地址B SSID 。

地址 3: 源地址（不 是发 送地 址） 是站 点A 的地址MAC氏

下 面 讨 论另

一

种稍 复杂些的情况 ， 即站 点 A 向站 点 B 发 送数据帧 （如 图 9- 12 所示）。

现 在 A 和 B 分别处 在不 同 的两 个子 网 凡 和 N2

， 因 此在 网络层 看 ， 是地址为I凡 的站 点

A , 把IP数据报 从子 网 凡 经 过路 由器 R转 发 到子 网 N 2 。 在网络层 看 不见 链路层 的接入点

AP1 和 AP2 。 IP(cid:4802) 据报 必 须 装 入链路层 的帧 才 能 在链路层 发 送。 但链 路层 不认识 IP 地址，

只认识 MAC 地址 ， 即硬 件 地址 。 站 点A 使用 协议A RP获 得了默认 路由器R的接口 1的地

址 MAC R- 1

为 802 .3 帧 ， 发送到 路由 器 R 的接 口 1。 站 点 A 发送的 802 . 11帧 的帧控 制字 段 中

。 这样， 站 点 A 先把 802 .l l数 据帧 发 到接 入点 A P1 , 然后AP1 把 802 .11帧 转 换
， “ 去往

A P=  I " 而

“

来自 A P= O

”

。

A -A P1 的 802 . 11数据 帧 首部：

地 址 I : 接收 地址 （不 是目 的地址 ） 是AP1 的地址B SSID 1

。

地址 2: 发 送地址 ， 即源地址， 也就是 站 点 A 的地址MAC氏

地址 3: 目 的 地址（不 是接 收 地 址） 是本子 网 中 路 由器 R接 口 1的 地址MAC知 。

,？

Z  IP,B 心802
她址 M ACR —｀＇

｀三 AP 1
l
- R
卫－'•

- － － － － － － - － － － － － －

1`

地址 BSSIDI

地址 BSSID，

802.1 1 帧 l (- IPA 、、
,，毛 1 ) - － － - ； _ ＿ ＿ ＿ ＿ ＿ ＿ ＿4- － ，也
-i

、、、、、、

、',
地址 MACA ,：

炙｀：2SS2

:-/：'

BSS l  ＼邕

I

N

图 9- 1 2 链路上的 802. 1 1 帧和 802.3 帧

当接入点 A P1 收 到 802 . 11数据帧 后， 就转换成 802 .3 帧 ( 802 .3 帧 只有两个地址）， 其

目 的 地址是MACR- 1 • 而源地 址是MACA （而 不 是接入点 AP1 的地址 B SSID 1 ) 。

路由器 R收 到 802 .3 帧 后 ， 剥 去 首部和尾部， 上交给 网络 层 。 网络层根据IP数据报 首

部 中 的目 的地 址 I 腥 查 找转 发表 ， 知道应 从接口 2 转 发给 地址 为 IPB 的设备 。 再 使用协议

A RP， 获 得此设备 的硬件地 址是MAC B ， 这个地 址就 是 802 .3 帧 的目 的地 址， 路由器R接口

2 的地址 MAC R-2 是这 个 802 .3 帧 的 源地址。

接入点AP2 收 到 802 .3 帧 ， 将其转 换 为 802 .1 1帧 ， 其帧控 制字 段 中

， “ 去往 AP=  O " 而

”

”
来自 A P= 1

。

•  4 20 •

中
A P2 一B 的 802 .1 1帧 首部 ：
地址 1: 接收 地址 （即目 的地址 ） 是站 点B 的地址 MAC贮
地址2 : 发送地址是AP2 的地址 B SSID 沪

地址 3: 源地址 （不是发送地址 ） 是路由 器R 接口 2 的地址 MACR-2 。

2. 序 号控制字段 、 持续期 字段和帧控制字段

下 面再 介绍 802 .11 数据帧 中 其他 的
( 1) 序号控制字段占 1 6位 ， 其 中 序号子字段占 12 位（从 0开始 ， 每发送

个(cid:4843)帧 就加
1, 到4 095后再 回到 0) ， 分片 子 字段占4 位（不分 片则保持 为 0。 如分 片 ， 则帧 的序号 子字
段 保持 不变 ， 而分片 子字 段 从 0开始 ， 每 个分 片 加 1, 最多到 1 5) 。 重传 的帧 的序号和分片

些字段 。

一

一

子 字 段 的值都不变 。 序号 控制的作用 是使接收(cid:4852)能够区分 开 是(cid:4843)传 送的帧 还是因出现差错而

重传 的帧 。 这和运 输层 讨 论 的序号 的概 念 是 相 似 的。

( 2) 持 续 期 字 段占 1 6位 。 在 9. 1 .3 小节 第4 部 分

“

对信 道进 行预约

”

中 已 经讲过

C SMA/CA 协 议允 许发送数据 的站 点 预约信道

一

段 时间（见前面的图9-1 0的例 子 ） ， 并把 这

个时间写 入 到持 续 期字 段 中
。 这个字 段 有多种用 途 （这里不对这些用 途 进 行详细的说明），
1 5
只有最高位 为 0时才表示持续 期。 这样， 持 续 期不 能超 过 2

— 1=  3 2767, 单 位 是微 秒 。

(3) 帧控制字段 共分为1 1 个子 字 段 。 下 面介绍其 中 较为重 要的几 个。
协议版 本字段 现在是 0。

类型字段和子 类 型 字段 用来区分 帧 的功能 。 上 面 已 经讲过， 802 .11帧 共有三 种类型 ： 控

制帧 、 数据帧 和管理帧 ， 而每
ACK 等几 种不同 的子类型 。 控 制帧 的几 种常 用的帧格式如图9- l l (b)和(c) 所示。

种帧 又 分 为若 干种 子类型 。 例 如， 控制帧 有 R T S, C T S 和

一

一

一

更 多分片 字段置 为 1 时表 明这个帧 属 于

。 我们知道， (cid:4873)线 信道
--4
的通信 质量是较 差 的。 因此(cid:4873)线 局 域 网的 数据帧 不宜 太长 。 当 帧 长 为n而误 比 特率p =  1 0

个帧 的多 个分 片 之

”
。 若 n =  1 21 44 bit （相 当千 1 5 18字 节 长 的以 太网帧），
时， 正 确收 到这个帧 的概率 P = (l- p )
则算 出这时P =  0.2969, 即 正 确收 到这样的帧 的概 率还不到 3 0% 。 因此， 为了提高传 输效 率，
次使用
一

个较 长 的 帧 划分为许多较短 的分片 。 这时可以在

在信 道质量较差 时， 需要把

RT S 和C T S 帧 预约信道后连 续 发送这些 分 片 。 当 然这仍然要使用 停止 等待协议， 即发 送

一

一

个分 片 ， 等收 到确认 后再 发送下

一

个分片 ， 不 过后面 的分 片 都不需要用 R T S 和C T S 帧 重 (cid:4843)

预约 信道（如图 9-1 3 所示） 。

s}FS - —
酰 三言丁

1

长 的 帧 划 分 为 许 多 分 片

言气 三言］
工

卢

产

NAY (RTS)

NAY (CTS)

N AY （分片 0)
NAY (ACKO)

NAV （分 片 1 )
NAY (ACKI )

源站

目 的 站
其他站

图 9- 1 3

分 片 的发送

功率管理字段只有 1 位 ， 用来指示移 动 站 的功率管理模 式 。 我们知道， 移 动 站 的功 率

是其非 常 宝 贵 的资源。 移 动 站在活跃状态 时（即发送或接收 信息） 需要消 耗 功率， 而在关 机

•  4 21 •

状 态 虽 然 不 消 耗 功 率 ， 但 却 可 能漏 掉 重 要 信 息 的接收 。 因 此我们需要 有 第三种状态 ， 这就是

待机状态 ， 或 省 电状态。 这 时移 动 站 不进行 任何实质性操 作， 屏 幕 也处 千(cid:4837)电状 态 ， 但 并未

(cid:4838) 开 与 AP的 关 联 ， 因此 这种 状 态 非 常 省 电 。 若

一

个移 动 站在发送给接入点 AP的 MAC 帧

中 的功率 管理字 段置 为 O , 就表示这个移 动 站 是处 千活跃状态 。 但 若把功率 管理字段置 为 1,

则 表 示在成功 发送完 这

一

帧 后， 即 进入待机状态 。 由于接入点 A P总是处 在活跃状 态 ， 因此

AP发送 的MAC 帧 的功 率 管 理字段 总是置 为 0。

接入点 A P保存 有 处 在 待 机状 态 的移动 站 的名 单 。 所有 要 发送给待机状 态 的移 动 站 的帧 ，

A P 都暂 时不 发送， 而 是保存在自 己 的缓存中 。 由 千 AP要 周 期性地向周 围 的移 动 站 发送信

标 帧 （ 通常 是 每 隔1 00m s发 送

一

次 ） ， 因 此 每个要 转 为待机 状 态 的移 动 站 都必须设置

一

个计

时器， 为的是在 AP 即将 发送信标 帧 时， 把处 在待机状态 的移 动 站 唤醒 ， 以便接收 AP发来

的信 标帧 。 唤 醒 时间很 短 ， 仅 0.2 5 m s。 AP发送的信 标帧 中 有 帧 被缓存在AP 中 的节 点列表。

若 移 动 站 从收 到的信 标帧 中 发现 有 发给自 己 的帧 ， 就向 A P发送请求把缓存的帧 发过来。 反

之 ， 若 发现没 有 发给 自 己 的帧 ， 就再返 回 到 待机状 态 。 这样， 若移 动 站 既 不发送也不接收 数
据帧 ， 就可以 有 99％ 的 时间处在待 机状 态 ， 因 而大 大地减 少了 电池 功率的消 耗 。

WEP字段占 1 位 。 若 WEP=  I , 就 表 明对 MAC 帧 的帧 主 体 字 段 采 用了 加密 算 法 。 我
们已 经在 9.1. l 节 指 出 ， WEP加 密 算 法 有 安 全 漏洞 。 因此， IEEE 802. 11 i 就努力解决(cid:4877) 线
局域网 的安 全 问 题 。 2002年 Wi-F i 联盟 制定 了符 合 802 .11i 功 能的加密 (cid:4857) 式WPA 。 2004 年

制定 的 WPA 2增加了支 持 A ES 加 密 算 法 ， 并 完 全 符 合 IEEE 802 .11 i

-2004 的安 全 功能。 现在

的Wi -F ] 产 品 几乎 都支持 WPA 2。 但 在MAC 帧 首部的帧 控制字 段 中

， W EP字 段 的名 称仍 继

续 使用 （ 已 发现 有 的(cid:4828) 献把WEP字 段 改为被保护帧(Prot ect ed F ram e)字 段 ， 但字 段 的作用不

变 ） 。 WPA 2的 加密 算 法相 当复 杂 [KU R0 17 ]， 限 于篇 幅 ， 这 里从略 。

9 . 2   无线个人 区域网 WPAN

(cid:4892)线个人 区域网 W PA N (Wi rel ess Per sonal  A rea  N etw o rk )就是在 个人 工 作的地(cid:4857)把属 千

个 人 使用的电子 设备 （如 便 携 式电脑 、 平板 电脑 、 便携 式打 印 机以及蜂 窝 电话 等） 用(cid:4877)线 技
一

术 连接起 来自 组 网 络 ， 不 需 要 使用接 入点A P, (cid:4821) 个网络 的范 围 约 为 1 0m 。 WPA N 可以 是

个人 使用， 也可以 是若 干 人 共 同 使 用 （ 例如 ，
用 的

个外 科 手术 小 组的几 位 医 生把几米范 围 内使
个 (cid:4875) 线 个 人 区 域 网 ） 。 这些电 子 设 备 可以很 (cid:4857) 便 地进行通信 ， 就像

些电 子设 备 组 成

一

一

一

样。 请注 意 ， (cid:4893)线 个人 区域网 WPA N 和 个人 区域网 PAN (Per sonal A rea

一

用普通 电 缆 连接
N etw o rk ) 并 不完 全 等 同 ， 因 为PA N 不

一

定 都是使 用(cid:4894) 线 连 接 的。
一

WPA N 和 (cid:4877)线 局域网 WLA N 并 不

样。 WPA N 是以 个人 为中 心 来使用的(cid:4877)线 个人 区域

网 ， 它 实 际上 就是

一

个 低 功 率 、 小 范 围 、 低 速率 和 低 价 格 的电 缆替代技 术 。

WPAN 的 IEEE 标 准 起 初 都由 I E EE 的 802. 1 5工 作组制 定 ， 这个标准也包括 MAC 层 和

物理层 这两层 的标准[W-I E EE 802. 1 5] 。 后 来也有 其他 组织 参 加了标准 的制定。 WPA N 都工 作

在 2.4 GHz 的 I SM 颜 段 。 顺 便 指 出 ， 欧 洲 的 ET SI 标 准则把(cid:4875) 线 个人 区域 网 取名 为
Hip erPAN 。

1 . 蓝牙 系统

最 早 使 用 的 WPA N 是 1994 年 爱 立信 公司 推 出 的蓝牙(Blu et ooth )系 统 。 IEEE 的 802 . 15

•  4 22 •

