### 关键词提取 - 分块 1
路由器凡时，路由器R1先收下它，接着把TTL的值减1
把P1丢弃，并向源主机发送一个ICMP时间超过差错报告报文。
。由千TTL等千零了，因此凡就源主机接着发送第二个数据报P2,并把TTL设置为2。贮先到达路由器R1,R1收下后把TTL减l再转发给路由器R2。民收到P2时TTL为1,但减l后TTL变为零了。民就丢
弃P2,并向源主机发送一个ICMP时间超过差错报告报文。这样一直继续下去。当最后一
个数据报刚刚到达目的主机时，数据报的TTL是1。主机不转发数据报，也不把TTL值减l。但因IP数据报中封装的是无法交付的运输层的UDP用户数据报，因此目的主机要向源主机发送ICMP终点不可达差错报告报文（见5.2.2(cid:7188)）。
这样，源主机达到了(cid:7151)己的目的，因为这些路由器和最后目的主机发来的ICMP报文正
好给出了源主机想知道的路由信息一一到达目的主机所经过的路由器的IP地址，以及到达
其中的每一个路由器的往返时间。图4-31是从南京的一个PC向新浪网的邮件服务器

**关键词**: 路由器 ICMP时间超过差错报告报文 TTL 目的主机 ICMP终点不可达差错报告报文 IP数据报 UDP用户数据报 往返时间


### 关键词提取 - 分块 2
其中的每一个路由器的往返时间。图4-31是从南京的一个PC向新浪网的邮件服务器
ina.com.cn发出tracert命令后所获得的结果。图中每一行有三个时间出现，是因为对mail.s
应于每一个TTL值，源主机要发送三次同样的IP数据报。
我们还应注意到，从原则上讲，IP数据报经过的路由器越多，所花费的时间也会越长。
但从图4-31可看出，有时正好相反。这是因为互(cid:7110)网的拥塞程度随时都在变化，也很难预料到。因此，完全有这样的可(cid:7127)：经过更多的路由器反而花费更短的时间。
C:寸ocuAentsandSettings\Xl.:R)t1•ace:rtflldil.sina.co111.enTracing.ro,,tetof!la.il.sina.co111.cn[202.108.43.2301
ovet·aSti.axi111ufltof30hops:124”$24”$23ns222.95.1?2.1
223AS24lllS22ns221.231.204.129
323!TIS22IIIS23AS221.231.2部．9

**关键词**: 计算机网络 路由器 往返时间 tracert命令 TTL值 IP数据报 拥塞程度


### 关键词提取 - 分块 3
323!TIS22IIIS23AS221.231.2部．9
424AS23lllS24ns202.9?.2?.3?
522FlS23fllS24ns202.97.41.226
628MS28m$28ns202.9?.35.2550l'IIS58m$S1AS202.9?.36噜86？
8308ns311n$310AS219.158.32.1
938?ms305”$385ns219.158.13.1?
10164FIS164IIIS165ns202.96.12.154
11322ms320111::2988ns61.135.148.50

**关键词**: 计算机网络 部 ns ms FIS IIIS m$ AS FlS S202.9? S219.158. S202.96.


### 关键词提取 - 分块 4
11322ms320111::2988ns61.135.148.50
12321lllS322"'s320nsfl•eenail43-230.sind.con[202.108.43.2301T.racecomplete.图4-31用trace1i命令获得目的主机的路由信息4.51Pv6协议IP是互(cid:7110)网的核心协议。现在使用的协议IP（即1Pv4)是在20世纪70年代末期设计的。互(cid:7110)网经过几十年的飞速发展，在2011年2月3日，IANA开始停止向地区互(cid:7111)网注册机构RIR分配1Pv4地址，因为1Pv4地址已经全部(cid:7106)尽了。不久，各地区互(cid:7110)网地址
分配机构也相继宣布地址(cid:7106)尽。我国在2014年(cid:7168)2015年也逐步停止了向新用户和应用分配1Pv4地址，同时全面开始商用部署1Pv6。
解决IP地址(cid:7107)尽的根本措施就是采用具有更大地址空间的新版本的IP,即1Pv6。经过多年的研究和试验，2017年7月终于发布了1Pv6的正式标准[RFC8200,STD86]。

**关键词**: 计算机网络 IP协议 IPv4 IPv6 地址空间 RFC8200标准


### 关键词提取 - 分块 5
•149•4.5.11Pv6的基本首部1Pv6仍支持无连接的传送，但将协议数据单元PDU称为分组(packet)，而不是1Pv4的
数据报(datagram)。为方便起见，本书仍采用数据报这一名词([KUR017]和[TANEll]也是
这样做的）。实际上，在本书中一直把分组和数据报看成是同义词。
1Pv6所引进的主要变化如下：
(1)更大的地址空间。1Pv6把地址从1Pv4的32位增大到4倍，即增大到128位，使地址空间增大了296倍。这样大的地址空间在可预见的将来是不会用完的。
(2)扩展的地址层次结构。1Pv6由千地址空间很大，因此可以划分为更多的层次。
(3)灵活的首部格式。1Pv6数据报的首部和1Pv4的并不兼容。1Pv6定义了许多可选的扩展首部，不仅可提供比1Pv4更多的功能，而且还可提高路由器的处理效率，这是因为路由器对扩展首部不进行处理（除逐跳扩展首部外）。
(4)改进的选项。1Pv6允许数据报包含有选项的控制信息，因而可以包含一些新的选项。
但1Pv6的首部长度是固定的，其选项放在有效载荷中。我们知道，1Pv4所规定的选项是固定不变的，其选项放在首部的可变部分。

**关键词**: 无连接的传送 分组 数据报 地址空间 层次结构 首部格式 路由器 处理效率 选项


### 关键词提取 - 分块 6
(5)允许协议继续扩充。这一点很重要，因为技术总是在不断地发展的（如网络硬件的更新），而新的应用也还会出现。但我们知道，1Pv4的功能是固定不变的。
(6)支持即插即用（即自动配置）。因此1Pv6不需要使用DHCP。
(7)支持资源的预分配。1Pv6支持实时视像等要求保证一定的带宽和时延的应用。
(8)1Pv6首部改为8字节对齐（即首部长度必须是8字节的整数倍）。原来的1Pv4首部是4字节对齐。
1Pv6数据报由两大部分组成，即基本首部(baseheader)和后面的有效载荷(payload)。有
效载荷也称为净负荷。有效载荷允许有零个或多个扩展首部(extensionheader)，再后面是数
据部分（如图4-32所示）。但请注意，所有的扩展首部并不属千1Pv6数据报的基本首部。
IPv6数据报发送在前'－三有
矗气I…IJ``140字节l◄I
，选项，效载荷不超过65535字节数据部分，俨＇，
＇
，图4-32具有多个可选扩展首部的1Pv6数据报的一般形式与1Pv4相比，1Pv6对首部中的某些字段进行了如下的更改：
•取消了首部长度字段，因为它的首部长度是固定的(40字节）。

**关键词**: 计算机网络 协议扩充 技术发展 网络硬件更新 新应用 DHCP 资源预分配 实时视像 带宽保证 时延应用 IPv4首部 IPv4固定功能 IPv6首部 8字节对齐 IPv6数据报 基本首部 扩展首部 有效载荷 IPv4对比 IPv6首部更改


### 关键词提取 - 分块 7
•取消了首部长度字段，因为它的首部长度是固定的(40字节）。
•取消了服务类型字段，因为优先级和流标号字段实现了服务类型字段的功能。
•取消了总长度字段，改用有效载荷长度字段。
•取消了标识、标志和片偏移字段，因为这些功能已包含在分片扩展首部中。
•把TTL字段改称为跳数限制字段，但作用是一样的（名称与作用更加一致）。
•取消了协议字段，改用下一个首部字段。
•取消了检验和字段，这样就加快了路由器处理数据报的速度。我们知道，在数据链•150•路层对检测出有差错的帧就丢弃。在运输层，当使用UDP时，若检测出有差错的用户数据报就丢弃。当使用TCP时，对检测出有差错的报文段就重传，直到正确传送到目的进程为止。因此在网络层的差错检测可以精简掉。
•取消了选项字段，而用扩展首部来实现选项功能。
由于把首部中不必要的功能取消了，使得1Pv6首部的字段数减少到只有8个（虽然首部长度增大了一倍）。
下面解释1Pv6基本首部中各字段的作用（参见图4-33)。
412162431位0
—1版本1通信量类流标号有效载荷长度跳数限制1Pv6的
基本首部

**关键词**: 取消了首部长度字段 取消了服务类型字段 取消了总长度字段 改用有效载荷长度字段 取消了标识, 标志和片偏移字段 因为这些功能已包含在分片扩展首部中 把TTL字段改称为跳数限制字段 但作用是一样的（名称与作用更加一致） 取消了协议字段 改用下一个首部字段 取消了检验和字段 而用扩展首部来实现选项功能 首部长度增大了一倍 1Pv6基本首部


### 关键词提取 - 分块 8
412162431位0
—1版本1通信量类流标号有效载荷长度跳数限制1Pv6的
基本首部
(40B)目的地址(128位）首部长度首部长度扩展首部l扩展首部2图4-33
(1)版本(version)
(2)通信量类(trafficclass)1Pv6基本首部和有效载荷（这里画出了两个扩展首部作为例子）占4位。它指明了协议的版本，对1Pv6该字段是6。
占8位。这是为了区分不同的1Pv6数据报的类别或优先级，和1Pv4的区分服务字段的作用相似。目前正在进行不同的通信量类性能的实验。
占20位。
(3)流标号(flowlabel)1Pv6的一个新的机制是支持资源预分配，并且允
许路由器把每一个数据报与一个给定的资源分配相联系。
1Pv6提出流(flow)的抽象概念。所
谓“流”就是互联网络上从特定源点到特定终点（单播或多播）的一系列数据报（如实时音
频或视频传输），而在这个“流”所经过的路径上的路由器都保证指明的服务质量。所有属
千同一个流的数据报都具有同样的流标号。因此，流标号对实时音频／视频数据的传送特别
有用。对千传统的电子邮件或非实时数据，流标号则没有用处，把它置为0即可。关千流标

**关键词**: 计算机网络 通信量类 流标号 有效载荷长度 跳数限制 IPv6 基本首部 目的地址 首部长度 扩展首部 版本 通信量类 流 资源预分配 路由器 数据报 服务质量 实时音频 视频传输 电子邮件


### 关键词提取 - 分块 9
有用。对千传统的电子邮件或非实时数据，流标号则没有用处，把它置为0即可。关千流标
号的规约可参考建议标准[RFC6437]。
(4)有效载荷长度(payloadlength)占16位。它指明1Pv6数据报除基本首部以外的字节数（所有扩展首部都算在有效载荷之内）。这个字段的最大值是64KB(65535字节）。
(5)下一个首部(nextheader)
•当1Pv6数据报没有扩展首部时，下一个首部字段的作用和1Pv4的协议字段一样，占8位。它相当千1Pv4的协议字段或可选字段。
它的值指出了基本首部后面的数据应交付IP层上面的哪一个高层协议（例如：6
或17分别表示应交付运输层TCP或UDP)。
•当出现扩展首部时，下一个首部字段的值就标识后面第一个扩展首部的类型。
•151•(6)跳数限制(hoplimit)占8位。用来防止数据报在网络中无限期地存在。和IPv4
的生存时间字段相似。源点在每个数据报发出时即设定某个跳数限制（最大为255跳）。每个路由器在转发数据报时，要先把跳数限制字段中的值减l。当跳数限制的值为零时，就要把这个数据报丢弃。

**关键词**: 计算机网络 IPv6 扩展首部 有效载荷长度 下一个首部 跳数限制 RFC6437 TCP UDP


### 关键词提取 - 分块 10
(7)源地址占128位。是数据报的发送端的IP地址。
占128位。是数据报的接收端的IP地址。
(8)目的地址
下面我们简单介绍一下IPv6的扩展首部。
在RFC8200中定义了以下六种扩展首部：（1
（6)目的站选项。
鉴别；（5)封装安全有效载荷；)逐跳选项；（2)路由选择；（3)分片；（4)每一个扩展首部都由若干个字段组成，它们的长度也各不同。但所有扩展首部的第一
字段。此字段的值指出了在该扩展首部后面的扩展首部是个字段都是8位的“
什么。当使用多个扩展首部时，应按以上的先后顺序出现。高层首部总是放在最后面。
”
下一个首部大家知道，IPv4的数据报若在其首部中使用了选项，则在数据报转发路径中的每一个
路由器，都必须检查首部中的所有选项，看是否与本路由器相关。这必然要花费相当的时间。
IPv6把原来IPv4首部中选项的功(cid:7128)都放在扩展首部中。
其基本首部的“
”
下一个首部
所有扩展首部的第一个字段都是“
使得路由器(cid:7126)够迅速判断待转发的IPv6数据报有无需要本路由器处理的选项。
字段会指出，在“
“

**关键词**: 源地址 目的地址 IPv6 扩展首部 逐跳选项 路由选择 分片 封装安全有效载荷 IPv4 路由器 基本首部


### 关键词提取 - 分块 11
字段会指出，在“
“
下一个首部有效载荷IPv6数据报若使用了扩展首部，则
”字段中使用了何种扩展首部。而，用来指出在后面还有何种扩展首部。这就扫一扫4.5.21Pv6的地址一(cid:7183)来讲，一个IPv6数据报的目的地址可以是以下三种基本类型地址之一：(1)单播(unicast)
(2)多播(multicast)多播是一点对多点的通信，数据报发送到一组计算机中的每一个。
单播就是传统的点对点通信。
视频讲解IPv6没有采用广播的术语，而是将广播看作多播的一个特例。
(3)任播(anycast)这是IPv6增加的一种类型。任播的终点是一组计算机，但数据报只交付其中的一个，通常是按照路由算法得出的距离最近的一个。
IPv6把实现1Pv6的主机和路由器均称为(cid:7195)点。由千一个(cid:7188)点可(cid:7126)会使用多条链路与其
他的一些(cid:7188)点相连，因此一个(cid:7188)点可(cid:7126)有多个与链路相连的接口。这样，IPv6给(cid:7188)点的每

**关键词**: 计算机网络 扩展首部 IPv6数据报 单播 多播 任播 广播 主机 路由器 链路 接口


### 关键词提取 - 分块 12
一个接口（请注意，不是给某个(cid:7195)点）指派一个IPv6地址。一个具有多个接口的(cid:7188)点可以
有多个单播地址，而其中任何一个地址都可当作到达该(cid:7188)点的目的地址。不过有时为了方便，
若不会引起误解，也常说某个(cid:7188)点的IPv6地址，而把某个接口省略掉。
在IPv6中，每个地址占128位，地址空间大于3.4xl038。如果整个地球表面（包括陆
个IP地址。如果地址分配地和水面）都覆盖着计算机，那么IPv6允许每平方米拥有7x1023
速率是每微秒分配100万个地址，则需要10年的时间才(cid:7126)将所有可(cid:7126)的地址分配完毕。
19可见在想象到的将来，IPv6的地址空间是不可(cid:7126)用完的。
为了体会一下IPv6的地址有多大，可以看一下目前已经分配出去的最大的地址块。法
国电信FranceTelecom和德国电信DeutscheTelekom各分配到一个/19地址块，相当千各有
35X1012个地址，远远大于全部的IPv4地址(IPv4地址还不到4.3X109个）。

**关键词**: 计算机网络 接口 IPv6地址 单播地址 CIDR点 地址空间 IP地址 微秒 地址分配 地址块


### 关键词提取 - 分块 13
35X1012个地址，远远大于全部的IPv4地址(IPv4地址还不到4.3X109个）。
巨大的地址范围还必须使维护互(cid:7110)网的人易于阅读和操纵这些地址。IPv4所用的点分十进制记法现在也不够方便了。例如，一个用点分十进制记法的128位的地址为：•152•104.230.140.100.255.255.255.255.0.0.17.128.150.10.255.255为了使地址再稍简洁些，IPv6使用冒号十六进制记法(colonhexadecimalnotation,简写
为colonhex)，它把每个16位的值用十六进制值表示，各值之间用冒号分隔。例如，如果前面所给的点分十进制数记法的值改为冒号十六进制记法，就变成了：68E6:8C64:FFFF:FFFF:0:1180:960A:FFFF在十六进制记法中，允许把数字前面的0省略。上面就把0000中的前三个0省略了。

**关键词**: 计算机网络 IPv4地址 互网 点分十进制记法 冒号十六进制记法 colonhex IPv6


### 关键词提取 - 分块 14
冒号十六进制记法还包含两个技术使它尤其有用。首先，冒号十六进制记法可以允许零压缩(zerocompression)，即一连串连续的零可以为一对冒号所取代，例如：可压缩为：FFOS:0:0:0:0:0:0:B3FFOS::B3为了保证零压缩有一个不含混的解释，规定在任一地址中只(cid:7126)使用一次零压缩。该技术对已建议的分配策略特别有用，因为会有许多地址包含较长连续的零串。
其次，冒号十六进制记法可结合使用点分十进制记法的后缀。我们下面会看到这种结合在1Pv4向1Pv6的转换阶段特别有用。例如，下面的串是一个合法的冒号十六进制记法：0:0:0:0:0:0:128.10.2.1请注意，在这种记法中，冒号所分隔的每个值是两个字(cid:7188)(16位）的值，但点分十进制每个部分的值是一个字(cid:7196)(8位）的值。再使用零压缩即可得出：::128.10.2.1下面再给出几个使用零压缩的例子。

**关键词**: 计算机网络 零压缩 冒号十六进制记法 点分十进制记法 地址分配策略 转换阶段


### 关键词提取 - 分块 15
1080:0:0:0:8:800:200C:417A记为1080::8:800:200C:417AFFOl:0:0:0:0:0:0:101（多播地址）记为FFOl::1010:0:0:0:0:0:0:1（环回地址）
0:0:0:0:0:0:0:0（未指明地址）记为：：1
记为．．CIDR的斜线表示法仍然可用。例如，60位的前缀12ABOOOOOOOOCD3（十六进制表示的15个字符，每个字符代表4位二进制数字）可记为：12AB:0000:0000:CD30:0000:0000:0000:0000/60或12AB:
或12AB:0:0:CD30::CD30:0:0:0:0/60:/60但不允许记为：12AB:0:0:CD3/60（不(cid:7126)把16位地址CD30块中的最后的0省略）或12AB::CD30/60（这表示12AB:0:0:0:0:0:0:CD30/60)
或12AB::CD3/60（这表示12AB:0:0:0:0:0:0:0CD3/60)但是，1Pv6取消了子网掩码。

**关键词**: 计算机网络 多播地址 环回地址 未指明地址 CIDR 斜线表示法 前缀 十六进制 二进制 地址块 子网掩码


### 关键词提取 - 分块 16
斜线的意思和1Pv4的情况相似。例如，•153•CIDR记法的2001:0DB8:0:CD30:123:4567:89AB:CDEF/60,表示1Pv6的地址是：2001:0DB8:0:CD30:123:4567:89AB:CDEF
而其子网号是：2001:0DB8:0:CD30:
1Pv6的地址分类如表4-7所示[RFC4291]。
:/60表4-71Pv6的常用地址分类地址类型未指明地址环回地址多播地址本地站点单播地址本地链路单播地址全球单播地址地址块前缀
00..·0(128位）00···1(128位）11111111lIIIlIIOII1111111010见图4-34前缀的CIDR记法./1281/128FFOO/8FECO/10FE80/10对表4-7所列举的几种常用地址简单解释如下。
未指明地址：＂。这个地址不能用
这是16字节的全0地址，可缩写为两个冒号”:
作目的地址，而只能将某台主机当作源地址使用，条件是这台主机还没有配置到一个标准的
IP地址。这类地址仅此一个。

**关键词**: 计算机网络 CIDR记法 IPv6 地址分类 RFC4291 CIDR记法 前缀 未指明地址 环回地址 多播地址 本地站点单播地址 全球单播地址 地址块前缀


### 关键词提取 - 分块 17
IP地址。这类地址仅此一个。
环回地址1Pv6的环回地址是0:0:0:0:0:0:0:1,可缩写为：：1。它的作用和1Pv4的环回地址一样。这类地址也是仅此一个。
多播地址
本地站点单播地址(cite-localunicastaddress)功能和1Pv4的一样。这类地址占1Pv6地址总数的1/256。
有些单位的内部网络使用TCP/IP协议，但并没有连接到互联网上。连接在这样的内部网络上的主机都可以使用这种本地站点地址进
行通信，但不能和互联网上的其他主机通信。这类地址占1Pv6地址总数的1/1024,其用途
和和1Pv4的专用地址是一样的。
本地链路单播地址(link-localunicastaddress)这种地址是在单一链路上使用的。当一
个节点启用1Pv6时就自动生成本地链路地址（请注意，这个节点现在并没有连接在某个网
络上）。当需要把分组发往单一链路的设备而不希望该分组被转发到此链路范围以外的地方
时，就可以使用这种特殊地址。这类地址占1Pv6地址总数的1/1024。
全球单播地址1Pv6的这一类单播地址是使用得最多的一类。曾提出过多种方案来进

**关键词**: IP地址 环回地址 IPv6环回地址 多播地址 本地站点单播地址 IPv6本地站点单播地址 内部网络 TCP/IP协议 互联网 主机 通信 本地链路单播地址 IPv6本地链路单播地址 全球单播地址 IPv6全球单播地址


### 关键词提取 - 分块 18
全球单播地址1Pv6的这一类单播地址是使用得最多的一类。曾提出过多种方案来进
一步划分这128位的单播地址。根据2006年发布的草案标准RFC4291的建议，1Pv6单播
地址的划分方法非常灵活，可以是如图4-34所示的任何一种。这就是说，可把整个的128
位都作为一个节点的地址。也可用n位作为子网前缀，用剩下的(128—n)位作为接口标识符
（相当于1Pv4的主机号）。当然也可以划分为三级，用n位作为全球路由选择前缀，用m位作为子网前缀，而用剩下的(128-n-m)位作为接口标识符。
节点地址(128bit)子网前缀(nbit)接口标识符(I28-n)全球路由选择前缀(11bit)I子网标识符Cmbit)I接口标识符图4-341Pv6的单播地址的几种划分方法•154•扫一扫｀翌
詈Q卧
背耘
睬视频讲解4.5.3IPv4向IPv6从过渡由千现在整个互(cid:7110)网的规模太大，因此，”规定一个日期，从这一天起
所有的路由器一律都改用IPv6"，显然是不可行的。这样，向IPv6过渡只

**关键词**: 计算机网络 单播地址 iPv6 子网前缀 接口标识符 全球路由选择前缀


### 关键词提取 - 分块 19
所有的路由器一律都改用IPv6"，显然是不可行的。这样，向IPv6过渡只
(cid:7129)采用逐步演进的办法，同时，还必须使新安装的IPv6系统(cid:7126)够向后兼容。
这就是说，1Pv6系统必须(cid:7126)够接收和转发IPv4分组，并且(cid:7126)够为IPv4分组选择路由。
下面介绍两种向1Pv6过渡的策略，即使用双协议栈和使用隧道技术[RFC2473,2529,3056,4038,4213]。
1.双协议栈双协议栈(dualstack)是指在完全过渡到1Pv6之前，使一部分主机（或路由器）同时装
有1Pv4和1Pv6这两种协议栈。因此双协议栈主机（或路由器）既(cid:7126)够和IPv6的系统通信，
又(cid:7126)够和IPv4的系统通信。双协议栈的主机（或路由器）记为IPv6/IPv4,表明它同时具有
IPv6地址和1Pv4地址（如图4-35所示）。
应用层运输层．“..．．`链路层和以下
·矗.-一丘＾～－

**关键词**: 路由器 IPv6 逐步演进 向后兼容 IPv4分组 路由 双协议栈 隧道技术 RFC2473 RFC2529 RFC3056 RFC4038 RFC4213


### 关键词提取 - 分块 20
应用层运输层．“..．．`链路层和以下
·矗.-一丘＾～－
I.到IPv4系统J到IPv6系统图4-35使用双协议栈进行从IPv4到1Pv6的过渡双协议栈的主机在和1Pv6主机通信时采用1Pv6地址，而和1Pv4主机通信时则采用
1Pv4地址。但双协议栈主机怎样知道目的主机是采用哪一种地址呢？它是使用域名系统
DNS来查询的。若DNS返回的是1Pv4地址，则双协议栈的源主机就使用1Pv4地址。但当
DNS返回的是1Pv6地址，源主机就使用1Pv6地址。
双协议栈需要付出的代价太大，因为要安装上两套协议。因此在过渡时期，最好采用下面的隧道技术。
2.隧道技术向1Pv6过渡的另一种方法是隧道技术(tunneling)。图4-36给出了隧道技术的工作原理。
这种方法的要点就是在1Pv6数据报要进入1Pv4网络时，把1Pv6数据报封装成为1Pv4数据
报。现在整个的IPv6数据报变成了IPv4数据报的数据部分。这样的IPv4数据报从路由器
B经过路由器C和D,传送到E,而原来的1Pv6数据报就好像在1Pv4网络的隧道中传输，

**关键词**: 计算机网络 链路层 IPv4系统 IPv6系统 双协议栈 DNS tunneling 1Pv4数据报 1Pv6数据报 路由器


### 关键词提取 - 分块 21
B经过路由器C和D,传送到E,而原来的1Pv6数据报就好像在1Pv4网络的隧道中传输，
什么都没有变化。当1Pv4数据报离开1Pv4网络中的隧道时，再把数据部分（即原来的1Pv6
数据报）交给主机的1Pv6协议栈。图中的一条粗线表示在1Pv4网络中好像有一个从B到E
”，路由器B是隧道的入口而E是出口。请注意，在隧道中传送的数据报的源
的“1Pv6隧道地址是B而目的地址是E。
•155•A[Pv6_流标号：X源地址：A
目的地址：F双协议栈LPv4网络双协议栈IPv6F一千流标号：X
源地址：A
目的地址：F）＇,l数据部分,/:IPv4数据报IPv4数据报数据部分TPv6数据报f-----1Pv4网络IPv6数据报要使双协议栈的主机知道IPv4数据报里面封装的数据是一个IPv6数据报，就必须把图4-36使用隧道技术进行从IPv4到IPv6的过渡IPv4首部的协议字段的值设置为41(41表示数据报的数据部分是1Pv6数据报）。
4.5.4ICMPv6和IPv4一样，1Pv6也不保证数据报的可靠交付，因为互(cid:7110)网中的路由器可(cid:7126)会丢弃数

**关键词**: IPv6 IPv4 数据报 路由器 隧道 双协议栈 ICMPv6


### 关键词提取 - 分块 22
据报。因此IPv6也需要使用ICMP来反馈一些差错信息。新的版本称为ICMPv6,它比ICMPv4要复杂得多。地址解析协议ARP和网际组管理协议IGMP的功(cid:7126)都已被合并到ICM氏6中（如图4-37所示）。
ICMP!GMPICMPv61Pv41Pv6ARP版本4中的网络层版本6中的网络层图4-37新旧版本中的网络层的比较ICMPv6是面向报文的协议，它利用报文来报告差错，获取信息，探测邻站或管理多播通信。ICMPv6还增加了几个定义报文功(cid:7126)及含义的其他协议。在对ICMPv6报文进行归类
时，不同的文献和RFC文档使用了不同的策略，有的把其中的一些报文定义为ICMPv6报
文，而把另一些报文定义为邻站发现ND(Neighbor-Discovery)报文或多播听众交付MLD

**关键词**: IPv6 ICMP ICMPv6 ARP IGMP 地址解析协议ARP 网际组管理协议IGMP ICMPv6报文 邻站发现ND 多播听众交付MLD


### 关键词提取 - 分块 23
(MulticastListenerDelivery)报文。其实所有这些报文都应当是ICMPv6报文，只是功(cid:7126)和作用不同而已。因此我们把这些报文都列入ICMPv6的不同类别。使用这种分类方法的原因是所有这些报文都具有相同的格式，并且所有报文类型都由ICMPv6协议处理。其实，像ND和MLD这样的协议都是运行在ICMPv6协议之下的。基于这样的考虑，可把ICMPv6报文分类，如图4-38所示。请注意，邻站发现报文和组成员关系报文分别是在ND协议和MLD协议的控制下进行发送和接收的。
•156•组成员关系报文|___＿__MLD协议~'」、l4」.-.LLlND协议关千ICMPv6的进一步讨论可参阅[FOROIO]，这里从略。
图4-38ICMPv6报文的分类4.6互联网的路由选择协议本(cid:7188)将讨论几种常用的路由选择协议，也就是要讨论转发表中的路由是怎样得出的。

**关键词**: 计算机网络 ICMPv6 ND MLD 组成员关系报文 邻站发现报文


### 关键词提取 - 分块 24
按照4.1.2(cid:7188)所述的观点，路由选择协议属于网络层控制层面的内容。不过本(cid:7188)仍然按传统的思路进行讨论，也就是说，路由选择协议规定了互(cid:7110)网中有关的路由器应如何相互交换信息并生成出路由表。
4.6.1有关路由选择协议的几个基本概念1.理想的路由算法路由选择协议的核心就是路由算法，即需要何种算法来获得路由表中的各项目。一个理想的路由算法应具有如下的一些特点[BELL86]:(1)算法必须是正确的和完整的。这里，“正确＂的含义是：沿着各路由表所指引的路由，分组一定(cid:7126)够最终到达目的网络和目的主机。
(2)算法在计算上应简单。路由选择的计算不应使网络通信量增加太多的额外开销。

**关键词**: 路由选择协议 路由表 路由器 互连网 路由算法


### 关键词提取 - 分块 25
(2)算法在计算上应简单。路由选择的计算不应使网络通信量增加太多的额外开销。
(3)算法应(cid:7129)适应通信量和网络拓扑的变化，这就是说，要有(cid:7152)适应性。当网络中的通信量发生变化时，算法(cid:7126)(cid:7149)适应地改变路由以均衡各链路的负载。当某个或某些(cid:7188)点、链路发生故障不(cid:7126)工作，或者修理好了再投入运行时，算法也(cid:7126)及时地改变路由。有时称这种(cid:7149)
适应性为＂稳健性”(robustnes)。3(4)算法应具有稳定性。在网络通信量和网络拓扑相对稳定的情况下，路由算法应收敛于一个可以接受的解，而不应使得出的路由不停地变化。
(5)算法应是公平的。路由选择算法应对所有用户（除对少数优先级高的用户）都是平
等的。例如，若仅仅使某一对用户的端到端时延为最小，但却不考虑其他的广大用户，这就
明显地不符合公平性的要求。
而网络的吞吐量最大。虽然我们希望得到(6)算法应是最佳的。路由选择算法应当(cid:7126)够找出最好的路由，使得分组平均时延最小

**关键词**: 计算机网络 路由选择 通信量 网络拓扑 适应性 稳健性 稳定性 公平性 最佳路由 端到端时延 吞吐量


### 关键词提取 - 分块 26
最佳＂的算法，但这并不总是最重要的。对于某
些网络，网络的可靠性有时要比最小的分组平均时延或最大吞吐量更加重要。因此，所谓“““最佳只(cid:7129)是相对于某一种特定要求下得出的较为合理的选择而已。
一个实际的路由选择算法，应尽可(cid:7126)接近于理想的算法。在不同的应用条件下，对以CD注：robustness一词在自动控制界的标准译名是“鲁棒性”，但在[MlNGCI94]则译为＂稳健性”。
•157•s

**关键词**: 计算机网络 可靠性 最小的分组平均时延 最大吞吐量 路由选择算法 理想的算法 鲁棒性 稳健性

